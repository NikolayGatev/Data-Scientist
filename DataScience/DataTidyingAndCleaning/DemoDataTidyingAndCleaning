{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "b11d5abf-4142-4bb0-a90f-740ab31f3153",
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "adcde6c4-5b6a-4eba-8adf-7841bbdf5529",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "491e4dda-af95-4095-a6a1-15e24c4d531e",
   "metadata": {},
   "source": [
    "# Demo Data Tidying and Cleaning"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "653494ec-32cf-4283-8469-93f5562ebd89",
   "metadata": {},
   "outputs": [],
   "source": [
    "pew = pd.read_csv('pew.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "5d0a1c3f-535f-45a9-8d8f-b90b7c1c83b2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>religion</th>\n",
       "      <th>&lt;$10k</th>\n",
       "      <th>$10-20k</th>\n",
       "      <th>$20-30k</th>\n",
       "      <th>$30-40k</th>\n",
       "      <th>$40-50k</th>\n",
       "      <th>$50-75k</th>\n",
       "      <th>$75-100k</th>\n",
       "      <th>$100-150k</th>\n",
       "      <th>&gt;150k</th>\n",
       "      <th>Don't know/refused</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Agnostic</td>\n",
       "      <td>27</td>\n",
       "      <td>34</td>\n",
       "      <td>60</td>\n",
       "      <td>81</td>\n",
       "      <td>76</td>\n",
       "      <td>137</td>\n",
       "      <td>122</td>\n",
       "      <td>109</td>\n",
       "      <td>84</td>\n",
       "      <td>96</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Atheist</td>\n",
       "      <td>12</td>\n",
       "      <td>27</td>\n",
       "      <td>37</td>\n",
       "      <td>52</td>\n",
       "      <td>35</td>\n",
       "      <td>70</td>\n",
       "      <td>73</td>\n",
       "      <td>59</td>\n",
       "      <td>74</td>\n",
       "      <td>76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Buddhist</td>\n",
       "      <td>27</td>\n",
       "      <td>21</td>\n",
       "      <td>30</td>\n",
       "      <td>34</td>\n",
       "      <td>33</td>\n",
       "      <td>58</td>\n",
       "      <td>62</td>\n",
       "      <td>39</td>\n",
       "      <td>53</td>\n",
       "      <td>54</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Catholic</td>\n",
       "      <td>418</td>\n",
       "      <td>617</td>\n",
       "      <td>732</td>\n",
       "      <td>670</td>\n",
       "      <td>638</td>\n",
       "      <td>1116</td>\n",
       "      <td>949</td>\n",
       "      <td>792</td>\n",
       "      <td>633</td>\n",
       "      <td>1489</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Don’t know/refused</td>\n",
       "      <td>15</td>\n",
       "      <td>14</td>\n",
       "      <td>15</td>\n",
       "      <td>11</td>\n",
       "      <td>10</td>\n",
       "      <td>35</td>\n",
       "      <td>21</td>\n",
       "      <td>17</td>\n",
       "      <td>18</td>\n",
       "      <td>116</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Evangelical Prot</td>\n",
       "      <td>575</td>\n",
       "      <td>869</td>\n",
       "      <td>1064</td>\n",
       "      <td>982</td>\n",
       "      <td>881</td>\n",
       "      <td>1486</td>\n",
       "      <td>949</td>\n",
       "      <td>723</td>\n",
       "      <td>414</td>\n",
       "      <td>1529</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Hindu</td>\n",
       "      <td>1</td>\n",
       "      <td>9</td>\n",
       "      <td>7</td>\n",
       "      <td>9</td>\n",
       "      <td>11</td>\n",
       "      <td>34</td>\n",
       "      <td>47</td>\n",
       "      <td>48</td>\n",
       "      <td>54</td>\n",
       "      <td>37</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Historically Black Prot</td>\n",
       "      <td>228</td>\n",
       "      <td>244</td>\n",
       "      <td>236</td>\n",
       "      <td>238</td>\n",
       "      <td>197</td>\n",
       "      <td>223</td>\n",
       "      <td>131</td>\n",
       "      <td>81</td>\n",
       "      <td>78</td>\n",
       "      <td>339</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Jehovah's Witness</td>\n",
       "      <td>20</td>\n",
       "      <td>27</td>\n",
       "      <td>24</td>\n",
       "      <td>24</td>\n",
       "      <td>21</td>\n",
       "      <td>30</td>\n",
       "      <td>15</td>\n",
       "      <td>11</td>\n",
       "      <td>6</td>\n",
       "      <td>37</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Jewish</td>\n",
       "      <td>19</td>\n",
       "      <td>19</td>\n",
       "      <td>25</td>\n",
       "      <td>25</td>\n",
       "      <td>30</td>\n",
       "      <td>95</td>\n",
       "      <td>69</td>\n",
       "      <td>87</td>\n",
       "      <td>151</td>\n",
       "      <td>162</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Mainline Prot</td>\n",
       "      <td>289</td>\n",
       "      <td>495</td>\n",
       "      <td>619</td>\n",
       "      <td>655</td>\n",
       "      <td>651</td>\n",
       "      <td>1107</td>\n",
       "      <td>939</td>\n",
       "      <td>753</td>\n",
       "      <td>634</td>\n",
       "      <td>1328</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Mormon</td>\n",
       "      <td>29</td>\n",
       "      <td>40</td>\n",
       "      <td>48</td>\n",
       "      <td>51</td>\n",
       "      <td>56</td>\n",
       "      <td>112</td>\n",
       "      <td>85</td>\n",
       "      <td>49</td>\n",
       "      <td>42</td>\n",
       "      <td>69</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Muslim</td>\n",
       "      <td>6</td>\n",
       "      <td>7</td>\n",
       "      <td>9</td>\n",
       "      <td>10</td>\n",
       "      <td>9</td>\n",
       "      <td>23</td>\n",
       "      <td>16</td>\n",
       "      <td>8</td>\n",
       "      <td>6</td>\n",
       "      <td>22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Orthodox</td>\n",
       "      <td>13</td>\n",
       "      <td>17</td>\n",
       "      <td>23</td>\n",
       "      <td>32</td>\n",
       "      <td>32</td>\n",
       "      <td>47</td>\n",
       "      <td>38</td>\n",
       "      <td>42</td>\n",
       "      <td>46</td>\n",
       "      <td>73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Other Christian</td>\n",
       "      <td>9</td>\n",
       "      <td>7</td>\n",
       "      <td>11</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>14</td>\n",
       "      <td>18</td>\n",
       "      <td>14</td>\n",
       "      <td>12</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Other Faiths</td>\n",
       "      <td>20</td>\n",
       "      <td>33</td>\n",
       "      <td>40</td>\n",
       "      <td>46</td>\n",
       "      <td>49</td>\n",
       "      <td>63</td>\n",
       "      <td>46</td>\n",
       "      <td>40</td>\n",
       "      <td>41</td>\n",
       "      <td>71</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Other World Religions</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Unaffiliated</td>\n",
       "      <td>217</td>\n",
       "      <td>299</td>\n",
       "      <td>374</td>\n",
       "      <td>365</td>\n",
       "      <td>341</td>\n",
       "      <td>528</td>\n",
       "      <td>407</td>\n",
       "      <td>321</td>\n",
       "      <td>258</td>\n",
       "      <td>597</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                   religion  <$10k  $10-20k  $20-30k  $30-40k  $40-50k  \\\n",
       "0                  Agnostic     27       34       60       81       76   \n",
       "1                   Atheist     12       27       37       52       35   \n",
       "2                  Buddhist     27       21       30       34       33   \n",
       "3                  Catholic    418      617      732      670      638   \n",
       "4        Don’t know/refused     15       14       15       11       10   \n",
       "5          Evangelical Prot    575      869     1064      982      881   \n",
       "6                     Hindu      1        9        7        9       11   \n",
       "7   Historically Black Prot    228      244      236      238      197   \n",
       "8         Jehovah's Witness     20       27       24       24       21   \n",
       "9                    Jewish     19       19       25       25       30   \n",
       "10            Mainline Prot    289      495      619      655      651   \n",
       "11                   Mormon     29       40       48       51       56   \n",
       "12                   Muslim      6        7        9       10        9   \n",
       "13                 Orthodox     13       17       23       32       32   \n",
       "14          Other Christian      9        7       11       13       13   \n",
       "15             Other Faiths     20       33       40       46       49   \n",
       "16    Other World Religions      5        2        3        4        2   \n",
       "17             Unaffiliated    217      299      374      365      341   \n",
       "\n",
       "    $50-75k  $75-100k  $100-150k  >150k  Don't know/refused  \n",
       "0       137       122        109     84                  96  \n",
       "1        70        73         59     74                  76  \n",
       "2        58        62         39     53                  54  \n",
       "3      1116       949        792    633                1489  \n",
       "4        35        21         17     18                 116  \n",
       "5      1486       949        723    414                1529  \n",
       "6        34        47         48     54                  37  \n",
       "7       223       131         81     78                 339  \n",
       "8        30        15         11      6                  37  \n",
       "9        95        69         87    151                 162  \n",
       "10     1107       939        753    634                1328  \n",
       "11      112        85         49     42                  69  \n",
       "12       23        16          8      6                  22  \n",
       "13       47        38         42     46                  73  \n",
       "14       14        18         14     12                  18  \n",
       "15       63        46         40     41                  71  \n",
       "16        7         3          4      4                   8  \n",
       "17      528       407        321    258                 597  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pew"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "4724ef59-0f69-4bdb-8196-2f98620540ec",
   "metadata": {},
   "outputs": [],
   "source": [
    "pew_tidy = pew.melt(id_vars=['religion'], var_name='income', value_name='frequency')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "a0e2f9e0-fdef-419c-b8db-bf977450fb8b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(Index(['religion', '<$10k', '$10-20k', '$20-30k', '$30-40k', '$40-50k',\n",
       "        '$50-75k', '$75-100k', '$100-150k', '>150k', 'Don't know/refused'],\n",
       "       dtype='object'),\n",
       " Index(['religion', 'income', 'frequency'], dtype='object'))"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pew.columns, pew_tidy.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "3eb5650a-6cd3-40d1-ba42-466f410032ae",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "religion     object\n",
       "income       object\n",
       "frequency     int64\n",
       "dtype: object"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pew_tidy.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "7e88c459-01ad-4992-98ce-22267652f53e",
   "metadata": {},
   "outputs": [],
   "source": [
    "pew_tidy.religion = pew_tidy.religion.astype('category')\n",
    "pew_tidy.income = pew_tidy.income.astype('category')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "3d9e31d7-5e60-4300-898c-708098ab09c4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "religion     category\n",
       "income       category\n",
       "frequency       int64\n",
       "dtype: object"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pew_tidy.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "82eaa8a9-ed55-4052-8866-cc0dce2efa48",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>religion</th>\n",
       "      <th>income</th>\n",
       "      <th>frequency</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Agnostic</td>\n",
       "      <td>&lt;$10k</td>\n",
       "      <td>27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Atheist</td>\n",
       "      <td>&lt;$10k</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Buddhist</td>\n",
       "      <td>&lt;$10k</td>\n",
       "      <td>27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Catholic</td>\n",
       "      <td>&lt;$10k</td>\n",
       "      <td>418</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Don’t know/refused</td>\n",
       "      <td>&lt;$10k</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>175</th>\n",
       "      <td>Orthodox</td>\n",
       "      <td>Don't know/refused</td>\n",
       "      <td>73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>176</th>\n",
       "      <td>Other Christian</td>\n",
       "      <td>Don't know/refused</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>177</th>\n",
       "      <td>Other Faiths</td>\n",
       "      <td>Don't know/refused</td>\n",
       "      <td>71</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>178</th>\n",
       "      <td>Other World Religions</td>\n",
       "      <td>Don't know/refused</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>179</th>\n",
       "      <td>Unaffiliated</td>\n",
       "      <td>Don't know/refused</td>\n",
       "      <td>597</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>180 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                  religion              income  frequency\n",
       "0                 Agnostic               <$10k         27\n",
       "1                  Atheist               <$10k         12\n",
       "2                 Buddhist               <$10k         27\n",
       "3                 Catholic               <$10k        418\n",
       "4       Don’t know/refused               <$10k         15\n",
       "..                     ...                 ...        ...\n",
       "175               Orthodox  Don't know/refused         73\n",
       "176        Other Christian  Don't know/refused         18\n",
       "177           Other Faiths  Don't know/refused         71\n",
       "178  Other World Religions  Don't know/refused          8\n",
       "179           Unaffiliated  Don't know/refused        597\n",
       "\n",
       "[180 rows x 3 columns]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pew_tidy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "3d24410d-ce1d-4a1d-a2c7-d18493552482",
   "metadata": {},
   "outputs": [],
   "source": [
    "tb = pd.read_csv('tb.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "8037dd3f-bca7-40df-a74f-4ba5022c49d5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>iso2</th>\n",
       "      <th>year</th>\n",
       "      <th>m04</th>\n",
       "      <th>m514</th>\n",
       "      <th>m014</th>\n",
       "      <th>m1524</th>\n",
       "      <th>m2534</th>\n",
       "      <th>m3544</th>\n",
       "      <th>m4554</th>\n",
       "      <th>m5564</th>\n",
       "      <th>...</th>\n",
       "      <th>f04</th>\n",
       "      <th>f514</th>\n",
       "      <th>f014</th>\n",
       "      <th>f1524</th>\n",
       "      <th>f2534</th>\n",
       "      <th>f3544</th>\n",
       "      <th>f4554</th>\n",
       "      <th>f5564</th>\n",
       "      <th>f65</th>\n",
       "      <th>fu</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AD</td>\n",
       "      <td>1989</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AD</td>\n",
       "      <td>1990</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AD</td>\n",
       "      <td>1991</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AD</td>\n",
       "      <td>1992</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AD</td>\n",
       "      <td>1993</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5764</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2004</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>187.0</td>\n",
       "      <td>833.0</td>\n",
       "      <td>2908.0</td>\n",
       "      <td>2298.0</td>\n",
       "      <td>1056.0</td>\n",
       "      <td>366.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>225.0</td>\n",
       "      <td>1140.0</td>\n",
       "      <td>2858.0</td>\n",
       "      <td>1565.0</td>\n",
       "      <td>622.0</td>\n",
       "      <td>214.0</td>\n",
       "      <td>111.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5765</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2005</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>210.0</td>\n",
       "      <td>837.0</td>\n",
       "      <td>2264.0</td>\n",
       "      <td>1855.0</td>\n",
       "      <td>762.0</td>\n",
       "      <td>295.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>269.0</td>\n",
       "      <td>1136.0</td>\n",
       "      <td>2242.0</td>\n",
       "      <td>1255.0</td>\n",
       "      <td>578.0</td>\n",
       "      <td>193.0</td>\n",
       "      <td>603.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5766</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2006</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>215.0</td>\n",
       "      <td>736.0</td>\n",
       "      <td>2391.0</td>\n",
       "      <td>1939.0</td>\n",
       "      <td>896.0</td>\n",
       "      <td>348.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>237.0</td>\n",
       "      <td>1020.0</td>\n",
       "      <td>2424.0</td>\n",
       "      <td>1355.0</td>\n",
       "      <td>632.0</td>\n",
       "      <td>230.0</td>\n",
       "      <td>96.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5767</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2007</td>\n",
       "      <td>6.0</td>\n",
       "      <td>132.0</td>\n",
       "      <td>138.0</td>\n",
       "      <td>500.0</td>\n",
       "      <td>3693.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>716.0</td>\n",
       "      <td>292.0</td>\n",
       "      <td>...</td>\n",
       "      <td>7.0</td>\n",
       "      <td>178.0</td>\n",
       "      <td>185.0</td>\n",
       "      <td>739.0</td>\n",
       "      <td>3311.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>553.0</td>\n",
       "      <td>213.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5768</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2008</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>127.0</td>\n",
       "      <td>614.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3316.0</td>\n",
       "      <td>704.0</td>\n",
       "      <td>263.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>145.0</td>\n",
       "      <td>840.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2890.0</td>\n",
       "      <td>467.0</td>\n",
       "      <td>174.0</td>\n",
       "      <td>105.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5769 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     iso2  year  m04   m514   m014  m1524   m2534   m3544   m4554  m5564  ...  \\\n",
       "0      AD  1989  NaN    NaN    NaN    NaN     NaN     NaN     NaN    NaN  ...   \n",
       "1      AD  1990  NaN    NaN    NaN    NaN     NaN     NaN     NaN    NaN  ...   \n",
       "2      AD  1991  NaN    NaN    NaN    NaN     NaN     NaN     NaN    NaN  ...   \n",
       "3      AD  1992  NaN    NaN    NaN    NaN     NaN     NaN     NaN    NaN  ...   \n",
       "4      AD  1993  NaN    NaN    NaN    NaN     NaN     NaN     NaN    NaN  ...   \n",
       "...   ...   ...  ...    ...    ...    ...     ...     ...     ...    ...  ...   \n",
       "5764   ZW  2004  NaN    NaN  187.0  833.0  2908.0  2298.0  1056.0  366.0  ...   \n",
       "5765   ZW  2005  NaN    NaN  210.0  837.0  2264.0  1855.0   762.0  295.0  ...   \n",
       "5766   ZW  2006  NaN    NaN  215.0  736.0  2391.0  1939.0   896.0  348.0  ...   \n",
       "5767   ZW  2007  6.0  132.0  138.0  500.0  3693.0     0.0   716.0  292.0  ...   \n",
       "5768   ZW  2008  NaN    NaN  127.0  614.0     0.0  3316.0   704.0  263.0  ...   \n",
       "\n",
       "      f04   f514   f014   f1524   f2534   f3544  f4554  f5564    f65   fu  \n",
       "0     NaN    NaN    NaN     NaN     NaN     NaN    NaN    NaN    NaN  NaN  \n",
       "1     NaN    NaN    NaN     NaN     NaN     NaN    NaN    NaN    NaN  NaN  \n",
       "2     NaN    NaN    NaN     NaN     NaN     NaN    NaN    NaN    NaN  NaN  \n",
       "3     NaN    NaN    NaN     NaN     NaN     NaN    NaN    NaN    NaN  NaN  \n",
       "4     NaN    NaN    NaN     NaN     NaN     NaN    NaN    NaN    NaN  NaN  \n",
       "...   ...    ...    ...     ...     ...     ...    ...    ...    ...  ...  \n",
       "5764  NaN    NaN  225.0  1140.0  2858.0  1565.0  622.0  214.0  111.0  NaN  \n",
       "5765  NaN    NaN  269.0  1136.0  2242.0  1255.0  578.0  193.0  603.0  NaN  \n",
       "5766  NaN    NaN  237.0  1020.0  2424.0  1355.0  632.0  230.0   96.0  NaN  \n",
       "5767  7.0  178.0  185.0   739.0  3311.0     0.0  553.0  213.0   90.0  NaN  \n",
       "5768  NaN    NaN  145.0   840.0     0.0  2890.0  467.0  174.0  105.0  0.0  \n",
       "\n",
       "[5769 rows x 22 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "7a92be19-c956-4303-b5e7-277d8dcce9f2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(5769, 22)"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "05d0809a-dced-4520-a25b-78b6cee64612",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "iso2      object\n",
       "year       int64\n",
       "m04      float64\n",
       "m514     float64\n",
       "m014     float64\n",
       "m1524    float64\n",
       "m2534    float64\n",
       "m3544    float64\n",
       "m4554    float64\n",
       "m5564    float64\n",
       "m65      float64\n",
       "mu       float64\n",
       "f04      float64\n",
       "f514     float64\n",
       "f014     float64\n",
       "f1524    float64\n",
       "f2534    float64\n",
       "f3544    float64\n",
       "f4554    float64\n",
       "f5564    float64\n",
       "f65      float64\n",
       "fu       float64\n",
       "dtype: object"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "17624b01-2e98-4ea7-b9ed-f070ba2963bd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>std</th>\n",
       "      <th>min</th>\n",
       "      <th>25%</th>\n",
       "      <th>50%</th>\n",
       "      <th>75%</th>\n",
       "      <th>max</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>year</th>\n",
       "      <td>5769.0</td>\n",
       "      <td>1994.229329</td>\n",
       "      <td>8.423265</td>\n",
       "      <td>1980.0</td>\n",
       "      <td>1987.0</td>\n",
       "      <td>1994.0</td>\n",
       "      <td>2002.00</td>\n",
       "      <td>2008.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m04</th>\n",
       "      <td>392.0</td>\n",
       "      <td>8.806122</td>\n",
       "      <td>46.094789</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.00</td>\n",
       "      <td>655.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m514</th>\n",
       "      <td>401.0</td>\n",
       "      <td>28.975062</td>\n",
       "      <td>127.881505</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>8.00</td>\n",
       "      <td>1519.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m014</th>\n",
       "      <td>2381.0</td>\n",
       "      <td>79.438051</td>\n",
       "      <td>280.489536</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>36.00</td>\n",
       "      <td>4648.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m1524</th>\n",
       "      <td>2407.0</td>\n",
       "      <td>922.364769</td>\n",
       "      <td>4278.638975</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>92.0</td>\n",
       "      <td>511.50</td>\n",
       "      <td>77121.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m2534</th>\n",
       "      <td>2408.0</td>\n",
       "      <td>1301.894518</td>\n",
       "      <td>5253.398971</td>\n",
       "      <td>0.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>151.5</td>\n",
       "      <td>728.00</td>\n",
       "      <td>83850.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m3544</th>\n",
       "      <td>2415.0</td>\n",
       "      <td>1205.566046</td>\n",
       "      <td>5409.064589</td>\n",
       "      <td>0.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>134.0</td>\n",
       "      <td>591.50</td>\n",
       "      <td>90498.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m4554</th>\n",
       "      <td>2421.0</td>\n",
       "      <td>983.515489</td>\n",
       "      <td>4780.782748</td>\n",
       "      <td>0.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>98.0</td>\n",
       "      <td>434.00</td>\n",
       "      <td>78815.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m5564</th>\n",
       "      <td>2414.0</td>\n",
       "      <td>696.171914</td>\n",
       "      <td>3771.934518</td>\n",
       "      <td>0.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>62.0</td>\n",
       "      <td>273.75</td>\n",
       "      <td>57492.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m65</th>\n",
       "      <td>2408.0</td>\n",
       "      <td>609.440615</td>\n",
       "      <td>3660.224592</td>\n",
       "      <td>0.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>53.0</td>\n",
       "      <td>227.25</td>\n",
       "      <td>70376.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mu</th>\n",
       "      <td>273.0</td>\n",
       "      <td>5.710623</td>\n",
       "      <td>85.713531</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1416.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f04</th>\n",
       "      <td>393.0</td>\n",
       "      <td>6.417303</td>\n",
       "      <td>39.630100</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.00</td>\n",
       "      <td>620.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f514</th>\n",
       "      <td>404.0</td>\n",
       "      <td>39.185644</td>\n",
       "      <td>170.491532</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>13.25</td>\n",
       "      <td>2062.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f014</th>\n",
       "      <td>2378.0</td>\n",
       "      <td>106.341043</td>\n",
       "      <td>435.889885</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>50.00</td>\n",
       "      <td>8319.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f1524</th>\n",
       "      <td>2394.0</td>\n",
       "      <td>758.737260</td>\n",
       "      <td>3153.018686</td>\n",
       "      <td>0.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>68.0</td>\n",
       "      <td>427.00</td>\n",
       "      <td>51485.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f2534</th>\n",
       "      <td>2400.0</td>\n",
       "      <td>856.087500</td>\n",
       "      <td>3295.220001</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>86.0</td>\n",
       "      <td>477.50</td>\n",
       "      <td>49887.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f3544</th>\n",
       "      <td>2398.0</td>\n",
       "      <td>586.597998</td>\n",
       "      <td>2293.956123</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>309.00</td>\n",
       "      <td>33664.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f4554</th>\n",
       "      <td>2401.0</td>\n",
       "      <td>400.376510</td>\n",
       "      <td>1589.955543</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>216.00</td>\n",
       "      <td>21486.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f5564</th>\n",
       "      <td>2394.0</td>\n",
       "      <td>276.178363</td>\n",
       "      <td>1191.728829</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>144.75</td>\n",
       "      <td>18203.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f65</th>\n",
       "      <td>2396.0</td>\n",
       "      <td>255.307596</td>\n",
       "      <td>1138.763846</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>124.00</td>\n",
       "      <td>21339.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fu</th>\n",
       "      <td>272.0</td>\n",
       "      <td>2.540441</td>\n",
       "      <td>38.261653</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>631.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        count         mean          std     min     25%     50%      75%  \\\n",
       "year   5769.0  1994.229329     8.423265  1980.0  1987.0  1994.0  2002.00   \n",
       "m04     392.0     8.806122    46.094789     0.0     0.0     0.0     2.00   \n",
       "m514    401.0    28.975062   127.881505     0.0     0.0     1.0     8.00   \n",
       "m014   2381.0    79.438051   280.489536     0.0     0.0     6.0    36.00   \n",
       "m1524  2407.0   922.364769  4278.638975     0.0    10.0    92.0   511.50   \n",
       "m2534  2408.0  1301.894518  5253.398971     0.0    15.0   151.5   728.00   \n",
       "m3544  2415.0  1205.566046  5409.064589     0.0    16.0   134.0   591.50   \n",
       "m4554  2421.0   983.515489  4780.782748     0.0    13.0    98.0   434.00   \n",
       "m5564  2414.0   696.171914  3771.934518     0.0     9.0    62.0   273.75   \n",
       "m65    2408.0   609.440615  3660.224592     0.0     8.0    53.0   227.25   \n",
       "mu      273.0     5.710623    85.713531     0.0     0.0     0.0     0.00   \n",
       "f04     393.0     6.417303    39.630100     0.0     0.0     0.0     1.00   \n",
       "f514    404.0    39.185644   170.491532     0.0     0.0     2.0    13.25   \n",
       "f014   2378.0   106.341043   435.889885     0.0     1.0     7.0    50.00   \n",
       "f1524  2394.0   758.737260  3153.018686     0.0     8.0    68.0   427.00   \n",
       "f2534  2400.0   856.087500  3295.220001     0.0    10.0    86.0   477.50   \n",
       "f3544  2398.0   586.597998  2293.956123     0.0     7.0    59.0   309.00   \n",
       "f4554  2401.0   400.376510  1589.955543     0.0     5.0    38.0   216.00   \n",
       "f5564  2394.0   276.178363  1191.728829     0.0     4.0    25.0   144.75   \n",
       "f65    2396.0   255.307596  1138.763846     0.0     5.0    29.0   124.00   \n",
       "fu      272.0     2.540441    38.261653     0.0     0.0     0.0     0.00   \n",
       "\n",
       "           max  \n",
       "year    2008.0  \n",
       "m04      655.0  \n",
       "m514    1519.0  \n",
       "m014    4648.0  \n",
       "m1524  77121.0  \n",
       "m2534  83850.0  \n",
       "m3544  90498.0  \n",
       "m4554  78815.0  \n",
       "m5564  57492.0  \n",
       "m65    70376.0  \n",
       "mu      1416.0  \n",
       "f04      620.0  \n",
       "f514    2062.0  \n",
       "f014    8319.0  \n",
       "f1524  51485.0  \n",
       "f2534  49887.0  \n",
       "f3544  33664.0  \n",
       "f4554  21486.0  \n",
       "f5564  18203.0  \n",
       "f65    21339.0  \n",
       "fu       631.0  "
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb.describe().T"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "98614bf4-0093-45d1-99b1-9c8613d5f4da",
   "metadata": {},
   "outputs": [],
   "source": [
    "tb_tidy = tb.melt(id_vars = ['iso2', 'year'], var_name='sex_and_age', value_name='cases')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "c4dbdf43-15d3-41be-9ff0-56226bdb7600",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(115380, 4)"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb_tidy.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "bcd247d5-ace8-4259-85c1-7de7f72ee893",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>iso2</th>\n",
       "      <th>year</th>\n",
       "      <th>sex_and_age</th>\n",
       "      <th>cases</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AD</td>\n",
       "      <td>1989</td>\n",
       "      <td>m04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AD</td>\n",
       "      <td>1990</td>\n",
       "      <td>m04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AD</td>\n",
       "      <td>1991</td>\n",
       "      <td>m04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AD</td>\n",
       "      <td>1992</td>\n",
       "      <td>m04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AD</td>\n",
       "      <td>1993</td>\n",
       "      <td>m04</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  iso2  year sex_and_age  cases\n",
       "0   AD  1989         m04    NaN\n",
       "1   AD  1990         m04    NaN\n",
       "2   AD  1991         m04    NaN\n",
       "3   AD  1992         m04    NaN\n",
       "4   AD  1993         m04    NaN"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    " tb_tidy.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "855668c6-9640-48e7-8679-ade82d4a04a8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0         m\n",
       "1         m\n",
       "2         m\n",
       "3         m\n",
       "4         m\n",
       "         ..\n",
       "115375    f\n",
       "115376    f\n",
       "115377    f\n",
       "115378    f\n",
       "115379    f\n",
       "Name: sex_and_age, Length: 115380, dtype: object"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb_tidy.sex_and_age.str.slice(0, 1) # str give option to do operation with string"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "8c8f6a88-dfb9-45e3-a9e5-d612c1c68d84",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0         04\n",
       "1         04\n",
       "2         04\n",
       "3         04\n",
       "4         04\n",
       "          ..\n",
       "115375     u\n",
       "115376     u\n",
       "115377     u\n",
       "115378     u\n",
       "115379     u\n",
       "Name: sex_and_age, Length: 115380, dtype: object"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb_tidy.sex_and_age.str.slice(1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "a2959e2c-3708-467e-9eae-c1ee92b4fad1",
   "metadata": {},
   "outputs": [],
   "source": [
    "tb_tidy['gender'] = tb_tidy.sex_and_age.str.slice(0, 1) # create new column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "f10ef94a-7c5e-4920-8436-eca233b2817c",
   "metadata": {},
   "outputs": [],
   "source": [
    "tb_tidy['age_group'] = tb_tidy.sex_and_age.str.slice(1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "d3b00596-b7cf-43ad-bc05-e1c741343628",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>iso2</th>\n",
       "      <th>year</th>\n",
       "      <th>sex_and_age</th>\n",
       "      <th>cases</th>\n",
       "      <th>gender</th>\n",
       "      <th>age_group</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AD</td>\n",
       "      <td>1989</td>\n",
       "      <td>m04</td>\n",
       "      <td>NaN</td>\n",
       "      <td>m</td>\n",
       "      <td>04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AD</td>\n",
       "      <td>1990</td>\n",
       "      <td>m04</td>\n",
       "      <td>NaN</td>\n",
       "      <td>m</td>\n",
       "      <td>04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AD</td>\n",
       "      <td>1991</td>\n",
       "      <td>m04</td>\n",
       "      <td>NaN</td>\n",
       "      <td>m</td>\n",
       "      <td>04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AD</td>\n",
       "      <td>1992</td>\n",
       "      <td>m04</td>\n",
       "      <td>NaN</td>\n",
       "      <td>m</td>\n",
       "      <td>04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AD</td>\n",
       "      <td>1993</td>\n",
       "      <td>m04</td>\n",
       "      <td>NaN</td>\n",
       "      <td>m</td>\n",
       "      <td>04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115375</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2004</td>\n",
       "      <td>fu</td>\n",
       "      <td>NaN</td>\n",
       "      <td>f</td>\n",
       "      <td>u</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115376</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2005</td>\n",
       "      <td>fu</td>\n",
       "      <td>NaN</td>\n",
       "      <td>f</td>\n",
       "      <td>u</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115377</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2006</td>\n",
       "      <td>fu</td>\n",
       "      <td>NaN</td>\n",
       "      <td>f</td>\n",
       "      <td>u</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115378</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2007</td>\n",
       "      <td>fu</td>\n",
       "      <td>NaN</td>\n",
       "      <td>f</td>\n",
       "      <td>u</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115379</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2008</td>\n",
       "      <td>fu</td>\n",
       "      <td>0.0</td>\n",
       "      <td>f</td>\n",
       "      <td>u</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>115380 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       iso2  year sex_and_age  cases gender age_group\n",
       "0        AD  1989         m04    NaN      m        04\n",
       "1        AD  1990         m04    NaN      m        04\n",
       "2        AD  1991         m04    NaN      m        04\n",
       "3        AD  1992         m04    NaN      m        04\n",
       "4        AD  1993         m04    NaN      m        04\n",
       "...     ...   ...         ...    ...    ...       ...\n",
       "115375   ZW  2004          fu    NaN      f         u\n",
       "115376   ZW  2005          fu    NaN      f         u\n",
       "115377   ZW  2006          fu    NaN      f         u\n",
       "115378   ZW  2007          fu    NaN      f         u\n",
       "115379   ZW  2008          fu    0.0      f         u\n",
       "\n",
       "[115380 rows x 6 columns]"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb_tidy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "a7265438-d417-449c-b0d4-cddffa57bd0a",
   "metadata": {},
   "outputs": [],
   "source": [
    "tb_tidy = tb_tidy.drop(columns=['sex_and_age']) # delete column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "429d5e12-ce74-4aa0-92c5-d3536e6da65d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>std</th>\n",
       "      <th>min</th>\n",
       "      <th>25%</th>\n",
       "      <th>50%</th>\n",
       "      <th>75%</th>\n",
       "      <th>max</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>year</th>\n",
       "      <td>115380.0</td>\n",
       "      <td>1994.229329</td>\n",
       "      <td>8.422571</td>\n",
       "      <td>1980.0</td>\n",
       "      <td>1987.0</td>\n",
       "      <td>1994.0</td>\n",
       "      <td>2002.0</td>\n",
       "      <td>2008.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>cases</th>\n",
       "      <td>35750.0</td>\n",
       "      <td>609.378881</td>\n",
       "      <td>3278.187960</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>245.0</td>\n",
       "      <td>90498.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          count         mean          std     min     25%     50%     75%  \\\n",
       "year   115380.0  1994.229329     8.422571  1980.0  1987.0  1994.0  2002.0   \n",
       "cases   35750.0   609.378881  3278.187960     0.0     4.0    36.0   245.0   \n",
       "\n",
       "           max  \n",
       "year    2008.0  \n",
       "cases  90498.0  "
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb_tidy.describe().T"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "df514cb3-0b49-4eca-be43-d34188fd6de7",
   "metadata": {},
   "source": [
    "При describe count показава само броя на съответните клиетки по колоната със стойност, т.е. в случая се вижда, че year има много повече стойностти от cases, т.е. в cases има много NaN"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "f1c4808f-5803-43ad-9d79-c772d99bd152",
   "metadata": {},
   "outputs": [],
   "source": [
    "tb_tidy_no_missing = tb_tidy.dropna() # delete everyone row, where has NaN. Have option to choose ot which columns to check."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "59c8290b-a092-4694-8c7b-e9b32219ace0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>iso2</th>\n",
       "      <th>year</th>\n",
       "      <th>cases</th>\n",
       "      <th>gender</th>\n",
       "      <th>age_group</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>AD</td>\n",
       "      <td>2005</td>\n",
       "      <td>0.0</td>\n",
       "      <td>m</td>\n",
       "      <td>04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>AD</td>\n",
       "      <td>2006</td>\n",
       "      <td>0.0</td>\n",
       "      <td>m</td>\n",
       "      <td>04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>AD</td>\n",
       "      <td>2008</td>\n",
       "      <td>0.0</td>\n",
       "      <td>m</td>\n",
       "      <td>04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42</th>\n",
       "      <td>AE</td>\n",
       "      <td>2006</td>\n",
       "      <td>0.0</td>\n",
       "      <td>m</td>\n",
       "      <td>04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43</th>\n",
       "      <td>AE</td>\n",
       "      <td>2007</td>\n",
       "      <td>0.0</td>\n",
       "      <td>m</td>\n",
       "      <td>04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115195</th>\n",
       "      <td>VU</td>\n",
       "      <td>2008</td>\n",
       "      <td>0.0</td>\n",
       "      <td>f</td>\n",
       "      <td>u</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115269</th>\n",
       "      <td>YE</td>\n",
       "      <td>2008</td>\n",
       "      <td>0.0</td>\n",
       "      <td>f</td>\n",
       "      <td>u</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115323</th>\n",
       "      <td>ZA</td>\n",
       "      <td>2008</td>\n",
       "      <td>0.0</td>\n",
       "      <td>f</td>\n",
       "      <td>u</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115350</th>\n",
       "      <td>ZM</td>\n",
       "      <td>2008</td>\n",
       "      <td>0.0</td>\n",
       "      <td>f</td>\n",
       "      <td>u</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115379</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2008</td>\n",
       "      <td>0.0</td>\n",
       "      <td>f</td>\n",
       "      <td>u</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>35552 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       iso2  year  cases gender age_group\n",
       "15       AD  2005    0.0      m        04\n",
       "16       AD  2006    0.0      m        04\n",
       "18       AD  2008    0.0      m        04\n",
       "42       AE  2006    0.0      m        04\n",
       "43       AE  2007    0.0      m        04\n",
       "...     ...   ...    ...    ...       ...\n",
       "115195   VU  2008    0.0      f         u\n",
       "115269   YE  2008    0.0      f         u\n",
       "115323   ZA  2008    0.0      f         u\n",
       "115350   ZM  2008    0.0      f         u\n",
       "115379   ZW  2008    0.0      f         u\n",
       "\n",
       "[35552 rows x 5 columns]"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb_tidy_no_missing"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "078ce12b-6541-4012-a1d5-21c4cec33877",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "611.1249437443745"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb_tidy_no_missing.cases.mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "ece7c408-ff7e-4ab5-9e92-f90a02101fd9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "58.46478873239437"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb_tidy_no_missing[tb_tidy_no_missing.iso2 == 'BG'].cases.mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "73cba6ea-fc26-4e65-a6fe-b2cdab323c9d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "age_group\n",
       "4    23912\n",
       "2     5561\n",
       "3     5536\n",
       "1      543\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb_tidy_no_missing.age_group.str.len().value_counts() # grouping by len on string in sells at give column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "e892cd3d-b063-44fa-9d4d-54278cd34bb4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "15        04\n",
       "16        04\n",
       "18        04\n",
       "42        04\n",
       "43        04\n",
       "          ..\n",
       "115195     u\n",
       "115269     u\n",
       "115323     u\n",
       "115350     u\n",
       "115379     u\n",
       "Name: age_group, Length: 35552, dtype: object"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb_tidy_no_missing.age_group.str.slice(0, 2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "b5ba740f-fc3d-4285-a772-4955e18f23b7",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Nikolay\\AppData\\Local\\Temp\\ipykernel_3932\\3477796470.py:8: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  tb_tidy_no_missing.age_group = tb_tidy_no_missing.age_group.apply(process_age_group) # apply is metotd for giving function, that will be apply on everyone cell\n"
     ]
    }
   ],
   "source": [
    "def process_age_group(age_group): # create function which change age_group\n",
    "    ages = {'04': '0-4', '65': '65+', 'u': 'unknown'}\n",
    "    if age_group in ages:\n",
    "        return ages[age_group]\n",
    "    # put a dash before the last two digits\n",
    "    return f'{age_group[: -2]}-{age_group[-2:]}'\n",
    "\n",
    "tb_tidy_no_missing.age_group = tb_tidy_no_missing.age_group.apply(process_age_group) # apply is metotd for giving function, that will be apply on everyone cell"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "a8039f4f-90b2-4025-90b5-0b6da0e98458",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['0-4', '5-14', '0-14', '15-24', '25-34', '35-44', '45-54', '55-64',\n",
       "       '65+', 'unknown'], dtype=object)"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb_tidy_no_missing.age_group.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "21f728fc-62f0-4928-991b-aee96717cd84",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42</th>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43</th>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115195</th>\n",
       "      <td>unknown</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115269</th>\n",
       "      <td>unknown</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115323</th>\n",
       "      <td>unknown</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115350</th>\n",
       "      <td>unknown</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>115379</th>\n",
       "      <td>unknown</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>35552 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              0     1\n",
       "15            0     4\n",
       "16            0     4\n",
       "18            0     4\n",
       "42            0     4\n",
       "43            0     4\n",
       "...         ...   ...\n",
       "115195  unknown  None\n",
       "115269  unknown  None\n",
       "115323  unknown  None\n",
       "115350  unknown  None\n",
       "115379  unknown  None\n",
       "\n",
       "[35552 rows x 2 columns]"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb_tidy_no_missing.age_group.str.split('-', expand=True) # separete by string"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "eacd776e-47c3-4357-b120-168985f9b361",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\Nikolay\\AppData\\Local\\Temp\\ipykernel_3932\\2806554250.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  tb_tidy_no_missing.age_group = tb_tidy_no_missing.age_group.astype('category')\n",
      "C:\\Users\\Nikolay\\AppData\\Local\\Temp\\ipykernel_3932\\2806554250.py:2: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  tb_tidy_no_missing.gender = tb_tidy_no_missing.gender.astype('category')\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "iso2           object\n",
       "year            int64\n",
       "cases         float64\n",
       "gender       category\n",
       "age_group    category\n",
       "dtype: object"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb_tidy_no_missing.age_group = tb_tidy_no_missing.age_group.astype('category')\n",
    "tb_tidy_no_missing.gender = tb_tidy_no_missing.gender.astype('category')\n",
    "tb_tidy_no_missing.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "608c2a31-d80a-4fb0-b564-8c7da51b7beb",
   "metadata": {},
   "outputs": [],
   "source": [
    "tb_tidy_no_missing = tb_tidy_no_missing[['iso2', 'year', 'gender', 'age_group', 'cases']] # reorder on columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "3e878e0a-5da2-4017-be4e-3024ba5aa40e",
   "metadata": {},
   "outputs": [],
   "source": [
    "tb_tidy_no_missing = tb_tidy_no_missing.sort_values(['iso2', 'year']) # sort doing sequensly first iso2 next year"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "da06e725-f278-4e69-af23-1f3f66bbfae1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>iso2</th>\n",
       "      <th>year</th>\n",
       "      <th>gender</th>\n",
       "      <th>age_group</th>\n",
       "      <th>cases</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AD</td>\n",
       "      <td>1996</td>\n",
       "      <td>m</td>\n",
       "      <td>0-14</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AD</td>\n",
       "      <td>1996</td>\n",
       "      <td>m</td>\n",
       "      <td>15-24</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AD</td>\n",
       "      <td>1996</td>\n",
       "      <td>m</td>\n",
       "      <td>25-34</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AD</td>\n",
       "      <td>1996</td>\n",
       "      <td>m</td>\n",
       "      <td>35-44</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AD</td>\n",
       "      <td>1996</td>\n",
       "      <td>m</td>\n",
       "      <td>45-54</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35547</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2008</td>\n",
       "      <td>f</td>\n",
       "      <td>35-44</td>\n",
       "      <td>2890.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35548</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2008</td>\n",
       "      <td>f</td>\n",
       "      <td>45-54</td>\n",
       "      <td>467.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35549</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2008</td>\n",
       "      <td>f</td>\n",
       "      <td>55-64</td>\n",
       "      <td>174.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35550</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2008</td>\n",
       "      <td>f</td>\n",
       "      <td>65+</td>\n",
       "      <td>105.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35551</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2008</td>\n",
       "      <td>f</td>\n",
       "      <td>unknown</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>35552 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      iso2  year gender age_group   cases\n",
       "0       AD  1996      m      0-14     0.0\n",
       "1       AD  1996      m     15-24     0.0\n",
       "2       AD  1996      m     25-34     0.0\n",
       "3       AD  1996      m     35-44     4.0\n",
       "4       AD  1996      m     45-54     1.0\n",
       "...    ...   ...    ...       ...     ...\n",
       "35547   ZW  2008      f     35-44  2890.0\n",
       "35548   ZW  2008      f     45-54   467.0\n",
       "35549   ZW  2008      f     55-64   174.0\n",
       "35550   ZW  2008      f       65+   105.0\n",
       "35551   ZW  2008      f   unknown     0.0\n",
       "\n",
       "[35552 rows x 5 columns]"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb_tidy_no_missing.reset_index(drop=True) # reset on column Index, drop = True deletes old Index"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "90b2c51b-b68b-40c1-bcd0-bfee9844d1fa",
   "metadata": {},
   "outputs": [],
   "source": [
    "tb_tidy_no_missing.cases = tb_tidy_no_missing.cases.astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "id": "b4090cdc-b961-4f98-a360-08f61951bfee",
   "metadata": {},
   "outputs": [],
   "source": [
    "weather_data = pd.read_csv('weather.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "id": "be27aab6-5a0f-4c48-854a-5d7172e112fe",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>year</th>\n",
       "      <th>month</th>\n",
       "      <th>element</th>\n",
       "      <th>d1</th>\n",
       "      <th>d2</th>\n",
       "      <th>d3</th>\n",
       "      <th>d4</th>\n",
       "      <th>d5</th>\n",
       "      <th>d6</th>\n",
       "      <th>...</th>\n",
       "      <th>d22</th>\n",
       "      <th>d23</th>\n",
       "      <th>d24</th>\n",
       "      <th>d25</th>\n",
       "      <th>d26</th>\n",
       "      <th>d27</th>\n",
       "      <th>d28</th>\n",
       "      <th>d29</th>\n",
       "      <th>d30</th>\n",
       "      <th>d31</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>1</td>\n",
       "      <td>tmax</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>27.8</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>1</td>\n",
       "      <td>tmin</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.5</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>2</td>\n",
       "      <td>tmax</td>\n",
       "      <td>NaN</td>\n",
       "      <td>27.3</td>\n",
       "      <td>24.1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>29.9</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>2</td>\n",
       "      <td>tmin</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.4</td>\n",
       "      <td>14.4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>10.7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>3</td>\n",
       "      <td>tmax</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>32.1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>3</td>\n",
       "      <td>tmin</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>4</td>\n",
       "      <td>tmax</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>36.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>4</td>\n",
       "      <td>tmin</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>16.7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>5</td>\n",
       "      <td>tmax</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>33.2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>5</td>\n",
       "      <td>tmin</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18.2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>6</td>\n",
       "      <td>tmax</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>30.1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>6</td>\n",
       "      <td>tmin</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>7</td>\n",
       "      <td>tmax</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>28.6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>7</td>\n",
       "      <td>tmin</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>17.5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>8</td>\n",
       "      <td>tmax</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>29.6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>26.4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>29.7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>28.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>25.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>8</td>\n",
       "      <td>tmin</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15.8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15.6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>10</td>\n",
       "      <td>tmax</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>27.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>31.2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>10</td>\n",
       "      <td>tmin</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>11</td>\n",
       "      <td>tmax</td>\n",
       "      <td>NaN</td>\n",
       "      <td>31.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>27.2</td>\n",
       "      <td>26.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>28.1</td>\n",
       "      <td>27.7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>11</td>\n",
       "      <td>tmin</td>\n",
       "      <td>NaN</td>\n",
       "      <td>16.3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.0</td>\n",
       "      <td>7.9</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.1</td>\n",
       "      <td>14.2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>12</td>\n",
       "      <td>tmax</td>\n",
       "      <td>29.9</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>27.8</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>12</td>\n",
       "      <td>tmin</td>\n",
       "      <td>13.8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>10.5</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>22 rows × 35 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         id  year  month element    d1    d2    d3    d4    d5    d6  ...  \\\n",
       "0   MX17004  2010      1    tmax   NaN   NaN   NaN   NaN   NaN   NaN  ...   \n",
       "1   MX17004  2010      1    tmin   NaN   NaN   NaN   NaN   NaN   NaN  ...   \n",
       "2   MX17004  2010      2    tmax   NaN  27.3  24.1   NaN   NaN   NaN  ...   \n",
       "3   MX17004  2010      2    tmin   NaN  14.4  14.4   NaN   NaN   NaN  ...   \n",
       "4   MX17004  2010      3    tmax   NaN   NaN   NaN   NaN  32.1   NaN  ...   \n",
       "5   MX17004  2010      3    tmin   NaN   NaN   NaN   NaN  14.2   NaN  ...   \n",
       "6   MX17004  2010      4    tmax   NaN   NaN   NaN   NaN   NaN   NaN  ...   \n",
       "7   MX17004  2010      4    tmin   NaN   NaN   NaN   NaN   NaN   NaN  ...   \n",
       "8   MX17004  2010      5    tmax   NaN   NaN   NaN   NaN   NaN   NaN  ...   \n",
       "9   MX17004  2010      5    tmin   NaN   NaN   NaN   NaN   NaN   NaN  ...   \n",
       "10  MX17004  2010      6    tmax   NaN   NaN   NaN   NaN   NaN   NaN  ...   \n",
       "11  MX17004  2010      6    tmin   NaN   NaN   NaN   NaN   NaN   NaN  ...   \n",
       "12  MX17004  2010      7    tmax   NaN   NaN  28.6   NaN   NaN   NaN  ...   \n",
       "13  MX17004  2010      7    tmin   NaN   NaN  17.5   NaN   NaN   NaN  ...   \n",
       "14  MX17004  2010      8    tmax   NaN   NaN   NaN   NaN  29.6   NaN  ...   \n",
       "15  MX17004  2010      8    tmin   NaN   NaN   NaN   NaN  15.8   NaN  ...   \n",
       "16  MX17004  2010     10    tmax   NaN   NaN   NaN   NaN  27.0   NaN  ...   \n",
       "17  MX17004  2010     10    tmin   NaN   NaN   NaN   NaN  14.0   NaN  ...   \n",
       "18  MX17004  2010     11    tmax   NaN  31.3   NaN  27.2  26.3   NaN  ...   \n",
       "19  MX17004  2010     11    tmin   NaN  16.3   NaN  12.0   7.9   NaN  ...   \n",
       "20  MX17004  2010     12    tmax  29.9   NaN   NaN   NaN   NaN  27.8  ...   \n",
       "21  MX17004  2010     12    tmin  13.8   NaN   NaN   NaN   NaN  10.5  ...   \n",
       "\n",
       "    d22   d23  d24   d25   d26   d27   d28   d29   d30   d31  \n",
       "0   NaN   NaN  NaN   NaN   NaN   NaN   NaN   NaN  27.8   NaN  \n",
       "1   NaN   NaN  NaN   NaN   NaN   NaN   NaN   NaN  14.5   NaN  \n",
       "2   NaN  29.9  NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN  \n",
       "3   NaN  10.7  NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN  \n",
       "4   NaN   NaN  NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN  \n",
       "5   NaN   NaN  NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN  \n",
       "6   NaN   NaN  NaN   NaN   NaN  36.3   NaN   NaN   NaN   NaN  \n",
       "7   NaN   NaN  NaN   NaN   NaN  16.7   NaN   NaN   NaN   NaN  \n",
       "8   NaN   NaN  NaN   NaN   NaN  33.2   NaN   NaN   NaN   NaN  \n",
       "9   NaN   NaN  NaN   NaN   NaN  18.2   NaN   NaN   NaN   NaN  \n",
       "10  NaN   NaN  NaN   NaN   NaN   NaN   NaN  30.1   NaN   NaN  \n",
       "11  NaN   NaN  NaN   NaN   NaN   NaN   NaN  18.0   NaN   NaN  \n",
       "12  NaN   NaN  NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN  \n",
       "13  NaN   NaN  NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN  \n",
       "14  NaN  26.4  NaN  29.7   NaN   NaN   NaN  28.0   NaN  25.4  \n",
       "15  NaN  15.0  NaN  15.6   NaN   NaN   NaN  15.3   NaN  15.4  \n",
       "16  NaN   NaN  NaN   NaN   NaN   NaN  31.2   NaN   NaN   NaN  \n",
       "17  NaN   NaN  NaN   NaN   NaN   NaN  15.0   NaN   NaN   NaN  \n",
       "18  NaN   NaN  NaN   NaN  28.1  27.7   NaN   NaN   NaN   NaN  \n",
       "19  NaN   NaN  NaN   NaN  12.1  14.2   NaN   NaN   NaN   NaN  \n",
       "20  NaN   NaN  NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN  \n",
       "21  NaN   NaN  NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN  \n",
       "\n",
       "[22 rows x 35 columns]"
      ]
     },
     "execution_count": 138,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "weather_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 143,
   "id": "34f4551e-cb91-49e4-bf75-33361baefa50",
   "metadata": {},
   "outputs": [],
   "source": [
    "weather_data.loc[2, 'd31'] = 23 # edit of data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 144,
   "id": "fc4a47ff-ce58-4118-a964-6839806e780c",
   "metadata": {},
   "outputs": [],
   "source": [
    "weather_data_tidy = weather_data.melt(id_vars=['id', 'year', 'month', 'element'], var_name='day')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 145,
   "id": "9b06016d-5f31-4492-bc1b-4de924de59f8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>year</th>\n",
       "      <th>month</th>\n",
       "      <th>element</th>\n",
       "      <th>day</th>\n",
       "      <th>value</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>1</td>\n",
       "      <td>tmax</td>\n",
       "      <td>d1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>1</td>\n",
       "      <td>tmin</td>\n",
       "      <td>d1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>2</td>\n",
       "      <td>tmax</td>\n",
       "      <td>d1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>2</td>\n",
       "      <td>tmin</td>\n",
       "      <td>d1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>3</td>\n",
       "      <td>tmax</td>\n",
       "      <td>d1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>677</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>10</td>\n",
       "      <td>tmin</td>\n",
       "      <td>d31</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>678</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>11</td>\n",
       "      <td>tmax</td>\n",
       "      <td>d31</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>679</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>11</td>\n",
       "      <td>tmin</td>\n",
       "      <td>d31</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>680</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>12</td>\n",
       "      <td>tmax</td>\n",
       "      <td>d31</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>681</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>12</td>\n",
       "      <td>tmin</td>\n",
       "      <td>d31</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>682 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          id  year  month element  day  value\n",
       "0    MX17004  2010      1    tmax   d1    NaN\n",
       "1    MX17004  2010      1    tmin   d1    NaN\n",
       "2    MX17004  2010      2    tmax   d1    NaN\n",
       "3    MX17004  2010      2    tmin   d1    NaN\n",
       "4    MX17004  2010      3    tmax   d1    NaN\n",
       "..       ...   ...    ...     ...  ...    ...\n",
       "677  MX17004  2010     10    tmin  d31    NaN\n",
       "678  MX17004  2010     11    tmax  d31    NaN\n",
       "679  MX17004  2010     11    tmin  d31    NaN\n",
       "680  MX17004  2010     12    tmax  d31    NaN\n",
       "681  MX17004  2010     12    tmin  d31    NaN\n",
       "\n",
       "[682 rows x 6 columns]"
      ]
     },
     "execution_count": 145,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "weather_data_tidy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 146,
   "id": "7af0ab37-7941-4ca7-9a1c-9b6c3e6f0b91",
   "metadata": {},
   "outputs": [],
   "source": [
    "weather_data_tidy.day = weather_data_tidy.day.str.slice(1).astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 147,
   "id": "42e546b0-3da5-4724-bc9a-ced32675fe5a",
   "metadata": {},
   "outputs": [],
   "source": [
    "weather_data_tidy = weather_data_tidy.dropna()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 148,
   "id": "6d8ffa34-6efd-4df5-9768-40f0d141532a",
   "metadata": {},
   "outputs": [],
   "source": [
    "weather_data_tidy = weather_data_tidy.pivot_table(index=['id', 'year', 'month', 'day'], columns='element', values='value') # move data in rows on columns values on Element became colums with values Value"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 149,
   "id": "70b297c1-b588-4032-a9b5-7700f4d72cd6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>element</th>\n",
       "      <th>tmax</th>\n",
       "      <th>tmin</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>id</th>\n",
       "      <th>year</th>\n",
       "      <th>month</th>\n",
       "      <th>day</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"34\" valign=\"top\">MX17004</th>\n",
       "      <th rowspan=\"34\" valign=\"top\">2010</th>\n",
       "      <th>1</th>\n",
       "      <th>30</th>\n",
       "      <td>27.8</td>\n",
       "      <td>14.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">2</th>\n",
       "      <th>2</th>\n",
       "      <td>27.3</td>\n",
       "      <td>14.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>24.1</td>\n",
       "      <td>14.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>29.7</td>\n",
       "      <td>13.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>29.9</td>\n",
       "      <td>10.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>23.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"3\" valign=\"top\">3</th>\n",
       "      <th>5</th>\n",
       "      <td>32.1</td>\n",
       "      <td>14.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>34.5</td>\n",
       "      <td>16.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>31.1</td>\n",
       "      <td>17.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <th>27</th>\n",
       "      <td>36.3</td>\n",
       "      <td>16.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <th>27</th>\n",
       "      <td>33.2</td>\n",
       "      <td>18.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">6</th>\n",
       "      <th>17</th>\n",
       "      <td>28.0</td>\n",
       "      <td>17.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>30.1</td>\n",
       "      <td>18.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">7</th>\n",
       "      <th>3</th>\n",
       "      <td>28.6</td>\n",
       "      <td>17.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>29.9</td>\n",
       "      <td>16.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"7\" valign=\"top\">8</th>\n",
       "      <th>5</th>\n",
       "      <td>29.6</td>\n",
       "      <td>15.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>29.0</td>\n",
       "      <td>17.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>29.8</td>\n",
       "      <td>16.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>26.4</td>\n",
       "      <td>15.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>29.7</td>\n",
       "      <td>15.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>28.0</td>\n",
       "      <td>15.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>25.4</td>\n",
       "      <td>15.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">10</th>\n",
       "      <th>5</th>\n",
       "      <td>27.0</td>\n",
       "      <td>14.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>28.1</td>\n",
       "      <td>12.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>29.5</td>\n",
       "      <td>13.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>28.7</td>\n",
       "      <td>10.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>31.2</td>\n",
       "      <td>15.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"5\" valign=\"top\">11</th>\n",
       "      <th>2</th>\n",
       "      <td>31.3</td>\n",
       "      <td>16.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>27.2</td>\n",
       "      <td>12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>26.3</td>\n",
       "      <td>7.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>28.1</td>\n",
       "      <td>12.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>27.7</td>\n",
       "      <td>14.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"2\" valign=\"top\">12</th>\n",
       "      <th>1</th>\n",
       "      <td>29.9</td>\n",
       "      <td>13.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>27.8</td>\n",
       "      <td>10.5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "element                 tmax  tmin\n",
       "id      year month day            \n",
       "MX17004 2010 1     30   27.8  14.5\n",
       "             2     2    27.3  14.4\n",
       "                   3    24.1  14.4\n",
       "                   11   29.7  13.4\n",
       "                   23   29.9  10.7\n",
       "                   31   23.0   NaN\n",
       "             3     5    32.1  14.2\n",
       "                   10   34.5  16.8\n",
       "                   16   31.1  17.6\n",
       "             4     27   36.3  16.7\n",
       "             5     27   33.2  18.2\n",
       "             6     17   28.0  17.5\n",
       "                   29   30.1  18.0\n",
       "             7     3    28.6  17.5\n",
       "                   14   29.9  16.5\n",
       "             8     5    29.6  15.8\n",
       "                   8    29.0  17.3\n",
       "                   13   29.8  16.5\n",
       "                   23   26.4  15.0\n",
       "                   25   29.7  15.6\n",
       "                   29   28.0  15.3\n",
       "                   31   25.4  15.4\n",
       "             10    5    27.0  14.0\n",
       "                   7    28.1  12.9\n",
       "                   14   29.5  13.0\n",
       "                   15   28.7  10.5\n",
       "                   28   31.2  15.0\n",
       "             11    2    31.3  16.3\n",
       "                   4    27.2  12.0\n",
       "                   5    26.3   7.9\n",
       "                   26   28.1  12.1\n",
       "                   27   27.7  14.2\n",
       "             12    1    29.9  13.8\n",
       "                   6    27.8  10.5"
      ]
     },
     "execution_count": 149,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "weather_data_tidy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 150,
   "id": "a090ecd2-465f-4177-92ac-10db532034bd",
   "metadata": {},
   "outputs": [],
   "source": [
    "weather_data_tidy = weather_data_tidy.reset_index()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 151,
   "id": "dfe8042d-4343-4e71-b3c2-54aa0c667e03",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>element</th>\n",
       "      <th>id</th>\n",
       "      <th>year</th>\n",
       "      <th>month</th>\n",
       "      <th>day</th>\n",
       "      <th>tmax</th>\n",
       "      <th>tmin</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>1</td>\n",
       "      <td>30</td>\n",
       "      <td>27.8</td>\n",
       "      <td>14.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>27.3</td>\n",
       "      <td>14.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>24.1</td>\n",
       "      <td>14.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>2</td>\n",
       "      <td>11</td>\n",
       "      <td>29.7</td>\n",
       "      <td>13.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>2</td>\n",
       "      <td>23</td>\n",
       "      <td>29.9</td>\n",
       "      <td>10.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>2</td>\n",
       "      <td>31</td>\n",
       "      <td>23.0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "      <td>32.1</td>\n",
       "      <td>14.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>3</td>\n",
       "      <td>10</td>\n",
       "      <td>34.5</td>\n",
       "      <td>16.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>3</td>\n",
       "      <td>16</td>\n",
       "      <td>31.1</td>\n",
       "      <td>17.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>4</td>\n",
       "      <td>27</td>\n",
       "      <td>36.3</td>\n",
       "      <td>16.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>5</td>\n",
       "      <td>27</td>\n",
       "      <td>33.2</td>\n",
       "      <td>18.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>6</td>\n",
       "      <td>17</td>\n",
       "      <td>28.0</td>\n",
       "      <td>17.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>6</td>\n",
       "      <td>29</td>\n",
       "      <td>30.1</td>\n",
       "      <td>18.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>28.6</td>\n",
       "      <td>17.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>7</td>\n",
       "      <td>14</td>\n",
       "      <td>29.9</td>\n",
       "      <td>16.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>8</td>\n",
       "      <td>5</td>\n",
       "      <td>29.6</td>\n",
       "      <td>15.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>29.0</td>\n",
       "      <td>17.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>8</td>\n",
       "      <td>13</td>\n",
       "      <td>29.8</td>\n",
       "      <td>16.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>8</td>\n",
       "      <td>23</td>\n",
       "      <td>26.4</td>\n",
       "      <td>15.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>8</td>\n",
       "      <td>25</td>\n",
       "      <td>29.7</td>\n",
       "      <td>15.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>8</td>\n",
       "      <td>29</td>\n",
       "      <td>28.0</td>\n",
       "      <td>15.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>8</td>\n",
       "      <td>31</td>\n",
       "      <td>25.4</td>\n",
       "      <td>15.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>10</td>\n",
       "      <td>5</td>\n",
       "      <td>27.0</td>\n",
       "      <td>14.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>10</td>\n",
       "      <td>7</td>\n",
       "      <td>28.1</td>\n",
       "      <td>12.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>10</td>\n",
       "      <td>14</td>\n",
       "      <td>29.5</td>\n",
       "      <td>13.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>10</td>\n",
       "      <td>15</td>\n",
       "      <td>28.7</td>\n",
       "      <td>10.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>10</td>\n",
       "      <td>28</td>\n",
       "      <td>31.2</td>\n",
       "      <td>15.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>11</td>\n",
       "      <td>2</td>\n",
       "      <td>31.3</td>\n",
       "      <td>16.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>11</td>\n",
       "      <td>4</td>\n",
       "      <td>27.2</td>\n",
       "      <td>12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>11</td>\n",
       "      <td>5</td>\n",
       "      <td>26.3</td>\n",
       "      <td>7.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>11</td>\n",
       "      <td>26</td>\n",
       "      <td>28.1</td>\n",
       "      <td>12.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>11</td>\n",
       "      <td>27</td>\n",
       "      <td>27.7</td>\n",
       "      <td>14.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>12</td>\n",
       "      <td>1</td>\n",
       "      <td>29.9</td>\n",
       "      <td>13.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>MX17004</td>\n",
       "      <td>2010</td>\n",
       "      <td>12</td>\n",
       "      <td>6</td>\n",
       "      <td>27.8</td>\n",
       "      <td>10.5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "element       id  year  month  day  tmax  tmin\n",
       "0        MX17004  2010      1   30  27.8  14.5\n",
       "1        MX17004  2010      2    2  27.3  14.4\n",
       "2        MX17004  2010      2    3  24.1  14.4\n",
       "3        MX17004  2010      2   11  29.7  13.4\n",
       "4        MX17004  2010      2   23  29.9  10.7\n",
       "5        MX17004  2010      2   31  23.0   NaN\n",
       "6        MX17004  2010      3    5  32.1  14.2\n",
       "7        MX17004  2010      3   10  34.5  16.8\n",
       "8        MX17004  2010      3   16  31.1  17.6\n",
       "9        MX17004  2010      4   27  36.3  16.7\n",
       "10       MX17004  2010      5   27  33.2  18.2\n",
       "11       MX17004  2010      6   17  28.0  17.5\n",
       "12       MX17004  2010      6   29  30.1  18.0\n",
       "13       MX17004  2010      7    3  28.6  17.5\n",
       "14       MX17004  2010      7   14  29.9  16.5\n",
       "15       MX17004  2010      8    5  29.6  15.8\n",
       "16       MX17004  2010      8    8  29.0  17.3\n",
       "17       MX17004  2010      8   13  29.8  16.5\n",
       "18       MX17004  2010      8   23  26.4  15.0\n",
       "19       MX17004  2010      8   25  29.7  15.6\n",
       "20       MX17004  2010      8   29  28.0  15.3\n",
       "21       MX17004  2010      8   31  25.4  15.4\n",
       "22       MX17004  2010     10    5  27.0  14.0\n",
       "23       MX17004  2010     10    7  28.1  12.9\n",
       "24       MX17004  2010     10   14  29.5  13.0\n",
       "25       MX17004  2010     10   15  28.7  10.5\n",
       "26       MX17004  2010     10   28  31.2  15.0\n",
       "27       MX17004  2010     11    2  31.3  16.3\n",
       "28       MX17004  2010     11    4  27.2  12.0\n",
       "29       MX17004  2010     11    5  26.3   7.9\n",
       "30       MX17004  2010     11   26  28.1  12.1\n",
       "31       MX17004  2010     11   27  27.7  14.2\n",
       "32       MX17004  2010     12    1  29.9  13.8\n",
       "33       MX17004  2010     12    6  27.8  10.5"
      ]
     },
     "execution_count": 151,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "weather_data_tidy"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d89bf1f3-f4c7-4154-8224-979d6a4f6876",
   "metadata": {},
   "source": [
    "With next code deleted row which have date 31 february. Then create new column in date format "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 152,
   "id": "f19aec4d-988a-4932-97b8-45c5ec7876f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "weather_data_tidy = weather_data_tidy.drop(weather_data_tidy\n",
    "                       [(weather_data_tidy.day == 31) & (weather_data_tidy.month == 2)].index\n",
    "                      )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 153,
   "id": "afc26f42-a040-42b2-8e66-b38f2d26c882",
   "metadata": {},
   "outputs": [],
   "source": [
    "weather_data_tidy['date'] = pd.to_datetime(weather_data_tidy.apply(lambda x: f\"{x['year']}-{x['month']}-{x['day']}\", axis=1) )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 154,
   "id": "20105ba5-c7cf-41ee-9b7b-603d5978ebd7",
   "metadata": {},
   "outputs": [],
   "source": [
    "weather_data_tidy = weather_data_tidy.drop(columns=['year', 'month', 'day']) # delete three columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 155,
   "id": "3c519e70-4163-473f-9374-2a1f8b1e996b",
   "metadata": {},
   "outputs": [],
   "source": [
    "weather_data_tidy = weather_data_tidy[['id', 'date', 'tmin', 'tmax']] # reorder columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 156,
   "id": "e3d05cc8-59d6-4487-833e-84f91577336d",
   "metadata": {},
   "outputs": [],
   "source": [
    "weather_data_tidy = weather_data_tidy.reset_index(drop=True) # reset on index"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 158,
   "id": "0f723076-c227-4d27-8b0c-5dfa171f9e08",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>element</th>\n",
       "      <th>date</th>\n",
       "      <th>tmax</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>2010-08-05</td>\n",
       "      <td>29.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>2010-08-08</td>\n",
       "      <td>29.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>2010-08-13</td>\n",
       "      <td>29.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>2010-08-23</td>\n",
       "      <td>26.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>2010-08-25</td>\n",
       "      <td>29.7</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "element       date  tmax\n",
       "14      2010-08-05  29.6\n",
       "15      2010-08-08  29.0\n",
       "16      2010-08-13  29.8\n",
       "17      2010-08-23  26.4\n",
       "18      2010-08-25  29.7"
      ]
     },
     "execution_count": 158,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "weather_data_tidy[weather_data_tidy.date > '2010-08-01'][['date', 'tmax']].head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 160,
   "id": "76dc6c6c-db09-4ccc-8c9f-e66d5c17d4b6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>element</th>\n",
       "      <th>date</th>\n",
       "      <th>tmax</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>2010-08-05</td>\n",
       "      <td>29.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>2010-08-08</td>\n",
       "      <td>29.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>2010-08-13</td>\n",
       "      <td>29.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>2010-08-23</td>\n",
       "      <td>26.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>2010-08-25</td>\n",
       "      <td>29.7</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "element       date  tmax\n",
       "14      2010-08-05  29.6\n",
       "15      2010-08-08  29.0\n",
       "16      2010-08-13  29.8\n",
       "17      2010-08-23  26.4\n",
       "18      2010-08-25  29.7"
      ]
     },
     "execution_count": 160,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "weather_data_tidy.loc[weather_data_tidy.date > '2010-08-01', ['date', 'tmax']].head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "728edd6c-8c6c-4a28-a26e-dff69024537f",
   "metadata": {},
   "outputs": [],
   "source": [
    "billboard_data = pd.read_csv('billboard.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "8fe5be3e-5467-4832-9a96-70a2f61d4062",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>artist</th>\n",
       "      <th>track</th>\n",
       "      <th>time</th>\n",
       "      <th>date.entered</th>\n",
       "      <th>wk1</th>\n",
       "      <th>wk2</th>\n",
       "      <th>wk3</th>\n",
       "      <th>wk4</th>\n",
       "      <th>wk5</th>\n",
       "      <th>...</th>\n",
       "      <th>wk67</th>\n",
       "      <th>wk68</th>\n",
       "      <th>wk69</th>\n",
       "      <th>wk70</th>\n",
       "      <th>wk71</th>\n",
       "      <th>wk72</th>\n",
       "      <th>wk73</th>\n",
       "      <th>wk74</th>\n",
       "      <th>wk75</th>\n",
       "      <th>wk76</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2000</td>\n",
       "      <td>2 Pac</td>\n",
       "      <td>Baby Don't Cry (Keep...</td>\n",
       "      <td>4:22</td>\n",
       "      <td>2000-02-26</td>\n",
       "      <td>87</td>\n",
       "      <td>82.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>87.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2000</td>\n",
       "      <td>2Ge+her</td>\n",
       "      <td>The Hardest Part Of ...</td>\n",
       "      <td>3:15</td>\n",
       "      <td>2000-09-02</td>\n",
       "      <td>91</td>\n",
       "      <td>87.0</td>\n",
       "      <td>92.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2000</td>\n",
       "      <td>3 Doors Down</td>\n",
       "      <td>Kryptonite</td>\n",
       "      <td>3:53</td>\n",
       "      <td>2000-04-08</td>\n",
       "      <td>81</td>\n",
       "      <td>70.0</td>\n",
       "      <td>68.0</td>\n",
       "      <td>67.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2000</td>\n",
       "      <td>3 Doors Down</td>\n",
       "      <td>Loser</td>\n",
       "      <td>4:24</td>\n",
       "      <td>2000-10-21</td>\n",
       "      <td>76</td>\n",
       "      <td>76.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>69.0</td>\n",
       "      <td>67.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2000</td>\n",
       "      <td>504 Boyz</td>\n",
       "      <td>Wobble Wobble</td>\n",
       "      <td>3:35</td>\n",
       "      <td>2000-04-15</td>\n",
       "      <td>57</td>\n",
       "      <td>34.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>312</th>\n",
       "      <td>2000</td>\n",
       "      <td>Yankee Grey</td>\n",
       "      <td>Another Nine Minutes</td>\n",
       "      <td>3:10</td>\n",
       "      <td>2000-04-29</td>\n",
       "      <td>86</td>\n",
       "      <td>83.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>74.0</td>\n",
       "      <td>83.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>313</th>\n",
       "      <td>2000</td>\n",
       "      <td>Yearwood, Trisha</td>\n",
       "      <td>Real Live Woman</td>\n",
       "      <td>3:55</td>\n",
       "      <td>2000-04-01</td>\n",
       "      <td>85</td>\n",
       "      <td>83.0</td>\n",
       "      <td>83.0</td>\n",
       "      <td>82.0</td>\n",
       "      <td>81.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>314</th>\n",
       "      <td>2000</td>\n",
       "      <td>Ying Yang Twins</td>\n",
       "      <td>Whistle While You Tw...</td>\n",
       "      <td>4:19</td>\n",
       "      <td>2000-03-18</td>\n",
       "      <td>95</td>\n",
       "      <td>94.0</td>\n",
       "      <td>91.0</td>\n",
       "      <td>85.0</td>\n",
       "      <td>84.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>315</th>\n",
       "      <td>2000</td>\n",
       "      <td>Zombie Nation</td>\n",
       "      <td>Kernkraft 400</td>\n",
       "      <td>3:30</td>\n",
       "      <td>2000-09-02</td>\n",
       "      <td>99</td>\n",
       "      <td>99.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>316</th>\n",
       "      <td>2000</td>\n",
       "      <td>matchbox twenty</td>\n",
       "      <td>Bent</td>\n",
       "      <td>4:12</td>\n",
       "      <td>2000-04-29</td>\n",
       "      <td>60</td>\n",
       "      <td>37.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>317 rows × 81 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     year            artist                    track  time date.entered  wk1  \\\n",
       "0    2000             2 Pac  Baby Don't Cry (Keep...  4:22   2000-02-26   87   \n",
       "1    2000           2Ge+her  The Hardest Part Of ...  3:15   2000-09-02   91   \n",
       "2    2000      3 Doors Down               Kryptonite  3:53   2000-04-08   81   \n",
       "3    2000      3 Doors Down                    Loser  4:24   2000-10-21   76   \n",
       "4    2000          504 Boyz            Wobble Wobble  3:35   2000-04-15   57   \n",
       "..    ...               ...                      ...   ...          ...  ...   \n",
       "312  2000       Yankee Grey     Another Nine Minutes  3:10   2000-04-29   86   \n",
       "313  2000  Yearwood, Trisha          Real Live Woman  3:55   2000-04-01   85   \n",
       "314  2000   Ying Yang Twins  Whistle While You Tw...  4:19   2000-03-18   95   \n",
       "315  2000     Zombie Nation            Kernkraft 400  3:30   2000-09-02   99   \n",
       "316  2000   matchbox twenty                     Bent  4:12   2000-04-29   60   \n",
       "\n",
       "      wk2   wk3   wk4   wk5  ...  wk67  wk68  wk69  wk70  wk71  wk72  wk73  \\\n",
       "0    82.0  72.0  77.0  87.0  ...   NaN   NaN   NaN   NaN   NaN   NaN   NaN   \n",
       "1    87.0  92.0   NaN   NaN  ...   NaN   NaN   NaN   NaN   NaN   NaN   NaN   \n",
       "2    70.0  68.0  67.0  66.0  ...   NaN   NaN   NaN   NaN   NaN   NaN   NaN   \n",
       "3    76.0  72.0  69.0  67.0  ...   NaN   NaN   NaN   NaN   NaN   NaN   NaN   \n",
       "4    34.0  25.0  17.0  17.0  ...   NaN   NaN   NaN   NaN   NaN   NaN   NaN   \n",
       "..    ...   ...   ...   ...  ...   ...   ...   ...   ...   ...   ...   ...   \n",
       "312  83.0  77.0  74.0  83.0  ...   NaN   NaN   NaN   NaN   NaN   NaN   NaN   \n",
       "313  83.0  83.0  82.0  81.0  ...   NaN   NaN   NaN   NaN   NaN   NaN   NaN   \n",
       "314  94.0  91.0  85.0  84.0  ...   NaN   NaN   NaN   NaN   NaN   NaN   NaN   \n",
       "315  99.0   NaN   NaN   NaN  ...   NaN   NaN   NaN   NaN   NaN   NaN   NaN   \n",
       "316  37.0  29.0  24.0  22.0  ...   NaN   NaN   NaN   NaN   NaN   NaN   NaN   \n",
       "\n",
       "     wk74  wk75  wk76  \n",
       "0     NaN   NaN   NaN  \n",
       "1     NaN   NaN   NaN  \n",
       "2     NaN   NaN   NaN  \n",
       "3     NaN   NaN   NaN  \n",
       "4     NaN   NaN   NaN  \n",
       "..    ...   ...   ...  \n",
       "312   NaN   NaN   NaN  \n",
       "313   NaN   NaN   NaN  \n",
       "314   NaN   NaN   NaN  \n",
       "315   NaN   NaN   NaN  \n",
       "316   NaN   NaN   NaN  \n",
       "\n",
       "[317 rows x 81 columns]"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "billboard_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "19124e8d-f1df-4829-8566-4e3c49315e78",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>std</th>\n",
       "      <th>min</th>\n",
       "      <th>25%</th>\n",
       "      <th>50%</th>\n",
       "      <th>75%</th>\n",
       "      <th>max</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>wk62</th>\n",
       "      <td>2.0</td>\n",
       "      <td>44.5</td>\n",
       "      <td>3.535534</td>\n",
       "      <td>42.0</td>\n",
       "      <td>43.25</td>\n",
       "      <td>44.5</td>\n",
       "      <td>45.75</td>\n",
       "      <td>47.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wk63</th>\n",
       "      <td>2.0</td>\n",
       "      <td>47.5</td>\n",
       "      <td>3.535534</td>\n",
       "      <td>45.0</td>\n",
       "      <td>46.25</td>\n",
       "      <td>47.5</td>\n",
       "      <td>48.75</td>\n",
       "      <td>50.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wk64</th>\n",
       "      <td>2.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>50.0</td>\n",
       "      <td>50.00</td>\n",
       "      <td>50.0</td>\n",
       "      <td>50.00</td>\n",
       "      <td>50.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wk65</th>\n",
       "      <td>1.0</td>\n",
       "      <td>49.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>49.0</td>\n",
       "      <td>49.00</td>\n",
       "      <td>49.0</td>\n",
       "      <td>49.00</td>\n",
       "      <td>49.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wk66</th>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wk67</th>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wk68</th>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wk69</th>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wk70</th>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wk71</th>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wk72</th>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wk73</th>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wk74</th>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wk75</th>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>wk76</th>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      count  mean       std   min    25%   50%    75%   max\n",
       "wk62    2.0  44.5  3.535534  42.0  43.25  44.5  45.75  47.0\n",
       "wk63    2.0  47.5  3.535534  45.0  46.25  47.5  48.75  50.0\n",
       "wk64    2.0  50.0  0.000000  50.0  50.00  50.0  50.00  50.0\n",
       "wk65    1.0  49.0       NaN  49.0  49.00  49.0  49.00  49.0\n",
       "wk66    0.0   NaN       NaN   NaN    NaN   NaN    NaN   NaN\n",
       "wk67    0.0   NaN       NaN   NaN    NaN   NaN    NaN   NaN\n",
       "wk68    0.0   NaN       NaN   NaN    NaN   NaN    NaN   NaN\n",
       "wk69    0.0   NaN       NaN   NaN    NaN   NaN    NaN   NaN\n",
       "wk70    0.0   NaN       NaN   NaN    NaN   NaN    NaN   NaN\n",
       "wk71    0.0   NaN       NaN   NaN    NaN   NaN    NaN   NaN\n",
       "wk72    0.0   NaN       NaN   NaN    NaN   NaN    NaN   NaN\n",
       "wk73    0.0   NaN       NaN   NaN    NaN   NaN    NaN   NaN\n",
       "wk74    0.0   NaN       NaN   NaN    NaN   NaN    NaN   NaN\n",
       "wk75    0.0   NaN       NaN   NaN    NaN   NaN    NaN   NaN\n",
       "wk76    0.0   NaN       NaN   NaN    NaN   NaN    NaN   NaN"
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "billboard_data[billboard_data.columns[-15:]].describe().T # get last 15 columns, but with transponse (T) columns became rows"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "a791d03c-17d9-46c7-b47a-adb1f840f3ce",
   "metadata": {},
   "outputs": [],
   "source": [
    "billboard_data = billboard_data.melt(id_vars=['year',\t'artist', 'track', 'time', 'date.entered']\n",
    "                    , var_name='week'\n",
    "                    , value_name='position'\n",
    "                )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "id": "e347b147-8fe0-4ac1-8c0d-7ae6e32312db",
   "metadata": {},
   "outputs": [],
   "source": [
    "billboard_data = billboard_data.dropna()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "39f421a8-61c2-4383-a17d-b961c5b43143",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>artist</th>\n",
       "      <th>track</th>\n",
       "      <th>time</th>\n",
       "      <th>date.entered</th>\n",
       "      <th>week</th>\n",
       "      <th>position</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2000</td>\n",
       "      <td>2 Pac</td>\n",
       "      <td>Baby Don't Cry (Keep...</td>\n",
       "      <td>4:22</td>\n",
       "      <td>2000-02-26</td>\n",
       "      <td>wk1</td>\n",
       "      <td>87.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2000</td>\n",
       "      <td>2Ge+her</td>\n",
       "      <td>The Hardest Part Of ...</td>\n",
       "      <td>3:15</td>\n",
       "      <td>2000-09-02</td>\n",
       "      <td>wk1</td>\n",
       "      <td>91.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2000</td>\n",
       "      <td>3 Doors Down</td>\n",
       "      <td>Kryptonite</td>\n",
       "      <td>3:53</td>\n",
       "      <td>2000-04-08</td>\n",
       "      <td>wk1</td>\n",
       "      <td>81.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2000</td>\n",
       "      <td>3 Doors Down</td>\n",
       "      <td>Loser</td>\n",
       "      <td>4:24</td>\n",
       "      <td>2000-10-21</td>\n",
       "      <td>wk1</td>\n",
       "      <td>76.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2000</td>\n",
       "      <td>504 Boyz</td>\n",
       "      <td>Wobble Wobble</td>\n",
       "      <td>3:35</td>\n",
       "      <td>2000-04-15</td>\n",
       "      <td>wk1</td>\n",
       "      <td>57.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19716</th>\n",
       "      <td>2000</td>\n",
       "      <td>Creed</td>\n",
       "      <td>Higher</td>\n",
       "      <td>5:16</td>\n",
       "      <td>1999-09-11</td>\n",
       "      <td>wk63</td>\n",
       "      <td>50.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19833</th>\n",
       "      <td>2000</td>\n",
       "      <td>Lonestar</td>\n",
       "      <td>Amazed</td>\n",
       "      <td>4:25</td>\n",
       "      <td>1999-06-05</td>\n",
       "      <td>wk63</td>\n",
       "      <td>45.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20033</th>\n",
       "      <td>2000</td>\n",
       "      <td>Creed</td>\n",
       "      <td>Higher</td>\n",
       "      <td>5:16</td>\n",
       "      <td>1999-09-11</td>\n",
       "      <td>wk64</td>\n",
       "      <td>50.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20150</th>\n",
       "      <td>2000</td>\n",
       "      <td>Lonestar</td>\n",
       "      <td>Amazed</td>\n",
       "      <td>4:25</td>\n",
       "      <td>1999-06-05</td>\n",
       "      <td>wk64</td>\n",
       "      <td>50.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20350</th>\n",
       "      <td>2000</td>\n",
       "      <td>Creed</td>\n",
       "      <td>Higher</td>\n",
       "      <td>5:16</td>\n",
       "      <td>1999-09-11</td>\n",
       "      <td>wk65</td>\n",
       "      <td>49.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5307 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       year        artist                    track  time date.entered  week  \\\n",
       "0      2000         2 Pac  Baby Don't Cry (Keep...  4:22   2000-02-26   wk1   \n",
       "1      2000       2Ge+her  The Hardest Part Of ...  3:15   2000-09-02   wk1   \n",
       "2      2000  3 Doors Down               Kryptonite  3:53   2000-04-08   wk1   \n",
       "3      2000  3 Doors Down                    Loser  4:24   2000-10-21   wk1   \n",
       "4      2000      504 Boyz            Wobble Wobble  3:35   2000-04-15   wk1   \n",
       "...     ...           ...                      ...   ...          ...   ...   \n",
       "19716  2000         Creed                   Higher  5:16   1999-09-11  wk63   \n",
       "19833  2000      Lonestar                   Amazed  4:25   1999-06-05  wk63   \n",
       "20033  2000         Creed                   Higher  5:16   1999-09-11  wk64   \n",
       "20150  2000      Lonestar                   Amazed  4:25   1999-06-05  wk64   \n",
       "20350  2000         Creed                   Higher  5:16   1999-09-11  wk65   \n",
       "\n",
       "       position  \n",
       "0          87.0  \n",
       "1          91.0  \n",
       "2          81.0  \n",
       "3          76.0  \n",
       "4          57.0  \n",
       "...         ...  \n",
       "19716      50.0  \n",
       "19833      45.0  \n",
       "20033      50.0  \n",
       "20150      50.0  \n",
       "20350      49.0  \n",
       "\n",
       "[5307 rows x 7 columns]"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "billboard_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "id": "e07700dd-73fc-4473-8686-d70c88bf7044",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([2000], dtype=int64)"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "billboard_data.year.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "32a0c466-3da1-486e-8ba5-e217b5f2d538",
   "metadata": {},
   "outputs": [],
   "source": [
    "billboard_data.week = billboard_data.week.str.slice(2).astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "id": "09de12f7-a3eb-4d38-bd30-ef074e415b6d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "year              int64\n",
       "artist           object\n",
       "track            object\n",
       "time             object\n",
       "date.entered     object\n",
       "week              int32\n",
       "position        float64\n",
       "dtype: object"
      ]
     },
     "execution_count": 62,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "billboard_data.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "1d70268d-458c-4069-ae9d-4d959fbf8b1c",
   "metadata": {},
   "outputs": [],
   "source": [
    "billboard_data.position = billboard_data.position.astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "id": "a7c46f31-264b-43a2-a0d3-ebd4326d0327",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>artist</th>\n",
       "      <th>track</th>\n",
       "      <th>time</th>\n",
       "      <th>date.entered</th>\n",
       "      <th>week</th>\n",
       "      <th>position</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2000</td>\n",
       "      <td>2 Pac</td>\n",
       "      <td>Baby Don't Cry (Keep...</td>\n",
       "      <td>4:22</td>\n",
       "      <td>2000-02-26</td>\n",
       "      <td>1</td>\n",
       "      <td>87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2000</td>\n",
       "      <td>2Ge+her</td>\n",
       "      <td>The Hardest Part Of ...</td>\n",
       "      <td>3:15</td>\n",
       "      <td>2000-09-02</td>\n",
       "      <td>1</td>\n",
       "      <td>91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2000</td>\n",
       "      <td>3 Doors Down</td>\n",
       "      <td>Kryptonite</td>\n",
       "      <td>3:53</td>\n",
       "      <td>2000-04-08</td>\n",
       "      <td>1</td>\n",
       "      <td>81</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2000</td>\n",
       "      <td>3 Doors Down</td>\n",
       "      <td>Loser</td>\n",
       "      <td>4:24</td>\n",
       "      <td>2000-10-21</td>\n",
       "      <td>1</td>\n",
       "      <td>76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2000</td>\n",
       "      <td>504 Boyz</td>\n",
       "      <td>Wobble Wobble</td>\n",
       "      <td>3:35</td>\n",
       "      <td>2000-04-15</td>\n",
       "      <td>1</td>\n",
       "      <td>57</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19716</th>\n",
       "      <td>2000</td>\n",
       "      <td>Creed</td>\n",
       "      <td>Higher</td>\n",
       "      <td>5:16</td>\n",
       "      <td>1999-09-11</td>\n",
       "      <td>63</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19833</th>\n",
       "      <td>2000</td>\n",
       "      <td>Lonestar</td>\n",
       "      <td>Amazed</td>\n",
       "      <td>4:25</td>\n",
       "      <td>1999-06-05</td>\n",
       "      <td>63</td>\n",
       "      <td>45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20033</th>\n",
       "      <td>2000</td>\n",
       "      <td>Creed</td>\n",
       "      <td>Higher</td>\n",
       "      <td>5:16</td>\n",
       "      <td>1999-09-11</td>\n",
       "      <td>64</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20150</th>\n",
       "      <td>2000</td>\n",
       "      <td>Lonestar</td>\n",
       "      <td>Amazed</td>\n",
       "      <td>4:25</td>\n",
       "      <td>1999-06-05</td>\n",
       "      <td>64</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20350</th>\n",
       "      <td>2000</td>\n",
       "      <td>Creed</td>\n",
       "      <td>Higher</td>\n",
       "      <td>5:16</td>\n",
       "      <td>1999-09-11</td>\n",
       "      <td>65</td>\n",
       "      <td>49</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5307 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       year        artist                    track  time date.entered  week  \\\n",
       "0      2000         2 Pac  Baby Don't Cry (Keep...  4:22   2000-02-26     1   \n",
       "1      2000       2Ge+her  The Hardest Part Of ...  3:15   2000-09-02     1   \n",
       "2      2000  3 Doors Down               Kryptonite  3:53   2000-04-08     1   \n",
       "3      2000  3 Doors Down                    Loser  4:24   2000-10-21     1   \n",
       "4      2000      504 Boyz            Wobble Wobble  3:35   2000-04-15     1   \n",
       "...     ...           ...                      ...   ...          ...   ...   \n",
       "19716  2000         Creed                   Higher  5:16   1999-09-11    63   \n",
       "19833  2000      Lonestar                   Amazed  4:25   1999-06-05    63   \n",
       "20033  2000         Creed                   Higher  5:16   1999-09-11    64   \n",
       "20150  2000      Lonestar                   Amazed  4:25   1999-06-05    64   \n",
       "20350  2000         Creed                   Higher  5:16   1999-09-11    65   \n",
       "\n",
       "       position  \n",
       "0            87  \n",
       "1            91  \n",
       "2            81  \n",
       "3            76  \n",
       "4            57  \n",
       "...         ...  \n",
       "19716        50  \n",
       "19833        45  \n",
       "20033        50  \n",
       "20150        50  \n",
       "20350        49  \n",
       "\n",
       "[5307 rows x 7 columns]"
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "billboard_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "id": "3f4cf1f0-03ce-4644-ac76-be7d8bc50a7f",
   "metadata": {},
   "outputs": [],
   "source": [
    "billboard_data['date.entered'] = pd.to_datetime(billboard_data['date.entered'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "id": "07115af1-1045-4373-a530-8523a0703d73",
   "metadata": {},
   "outputs": [],
   "source": [
    "intervals = billboard_data.week.apply(lambda x: pd.Timedelta(x - 1, 'w')) # change wekks in days"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "id": "5e145fbc-8b89-4536-8314-da9f8bf19d42",
   "metadata": {},
   "outputs": [],
   "source": [
    "billboard_data['date'] = billboard_data['date.entered'] + intervals # sum on date with days"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "id": "48267dfb-57bc-44fc-a12f-832c30e2296c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>artist</th>\n",
       "      <th>track</th>\n",
       "      <th>time</th>\n",
       "      <th>date.entered</th>\n",
       "      <th>week</th>\n",
       "      <th>position</th>\n",
       "      <th>date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2000</td>\n",
       "      <td>2 Pac</td>\n",
       "      <td>Baby Don't Cry (Keep...</td>\n",
       "      <td>4:22</td>\n",
       "      <td>2000-02-26</td>\n",
       "      <td>1</td>\n",
       "      <td>87</td>\n",
       "      <td>2000-02-26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2000</td>\n",
       "      <td>2Ge+her</td>\n",
       "      <td>The Hardest Part Of ...</td>\n",
       "      <td>3:15</td>\n",
       "      <td>2000-09-02</td>\n",
       "      <td>1</td>\n",
       "      <td>91</td>\n",
       "      <td>2000-09-02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2000</td>\n",
       "      <td>3 Doors Down</td>\n",
       "      <td>Kryptonite</td>\n",
       "      <td>3:53</td>\n",
       "      <td>2000-04-08</td>\n",
       "      <td>1</td>\n",
       "      <td>81</td>\n",
       "      <td>2000-04-08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2000</td>\n",
       "      <td>3 Doors Down</td>\n",
       "      <td>Loser</td>\n",
       "      <td>4:24</td>\n",
       "      <td>2000-10-21</td>\n",
       "      <td>1</td>\n",
       "      <td>76</td>\n",
       "      <td>2000-10-21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2000</td>\n",
       "      <td>504 Boyz</td>\n",
       "      <td>Wobble Wobble</td>\n",
       "      <td>3:35</td>\n",
       "      <td>2000-04-15</td>\n",
       "      <td>1</td>\n",
       "      <td>57</td>\n",
       "      <td>2000-04-15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19716</th>\n",
       "      <td>2000</td>\n",
       "      <td>Creed</td>\n",
       "      <td>Higher</td>\n",
       "      <td>5:16</td>\n",
       "      <td>1999-09-11</td>\n",
       "      <td>63</td>\n",
       "      <td>50</td>\n",
       "      <td>2000-11-18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19833</th>\n",
       "      <td>2000</td>\n",
       "      <td>Lonestar</td>\n",
       "      <td>Amazed</td>\n",
       "      <td>4:25</td>\n",
       "      <td>1999-06-05</td>\n",
       "      <td>63</td>\n",
       "      <td>45</td>\n",
       "      <td>2000-08-12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20033</th>\n",
       "      <td>2000</td>\n",
       "      <td>Creed</td>\n",
       "      <td>Higher</td>\n",
       "      <td>5:16</td>\n",
       "      <td>1999-09-11</td>\n",
       "      <td>64</td>\n",
       "      <td>50</td>\n",
       "      <td>2000-11-25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20150</th>\n",
       "      <td>2000</td>\n",
       "      <td>Lonestar</td>\n",
       "      <td>Amazed</td>\n",
       "      <td>4:25</td>\n",
       "      <td>1999-06-05</td>\n",
       "      <td>64</td>\n",
       "      <td>50</td>\n",
       "      <td>2000-08-19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20350</th>\n",
       "      <td>2000</td>\n",
       "      <td>Creed</td>\n",
       "      <td>Higher</td>\n",
       "      <td>5:16</td>\n",
       "      <td>1999-09-11</td>\n",
       "      <td>65</td>\n",
       "      <td>49</td>\n",
       "      <td>2000-12-02</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5307 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       year        artist                    track  time date.entered  week  \\\n",
       "0      2000         2 Pac  Baby Don't Cry (Keep...  4:22   2000-02-26     1   \n",
       "1      2000       2Ge+her  The Hardest Part Of ...  3:15   2000-09-02     1   \n",
       "2      2000  3 Doors Down               Kryptonite  3:53   2000-04-08     1   \n",
       "3      2000  3 Doors Down                    Loser  4:24   2000-10-21     1   \n",
       "4      2000      504 Boyz            Wobble Wobble  3:35   2000-04-15     1   \n",
       "...     ...           ...                      ...   ...          ...   ...   \n",
       "19716  2000         Creed                   Higher  5:16   1999-09-11    63   \n",
       "19833  2000      Lonestar                   Amazed  4:25   1999-06-05    63   \n",
       "20033  2000         Creed                   Higher  5:16   1999-09-11    64   \n",
       "20150  2000      Lonestar                   Amazed  4:25   1999-06-05    64   \n",
       "20350  2000         Creed                   Higher  5:16   1999-09-11    65   \n",
       "\n",
       "       position       date  \n",
       "0            87 2000-02-26  \n",
       "1            91 2000-09-02  \n",
       "2            81 2000-04-08  \n",
       "3            76 2000-10-21  \n",
       "4            57 2000-04-15  \n",
       "...         ...        ...  \n",
       "19716        50 2000-11-18  \n",
       "19833        45 2000-08-12  \n",
       "20033        50 2000-11-25  \n",
       "20150        50 2000-08-19  \n",
       "20350        49 2000-12-02  \n",
       "\n",
       "[5307 rows x 8 columns]"
      ]
     },
     "execution_count": 68,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "billboard_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "id": "ef002eb1-3bf3-43a9-98e0-bf654a175217",
   "metadata": {},
   "outputs": [],
   "source": [
    "billboard_data = billboard_data.drop(columns=['date.entered', 'week'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "id": "f4429c8f-bfa4-4621-a8e4-c9dfa621dbbf",
   "metadata": {},
   "outputs": [],
   "source": [
    "billboard_data = billboard_data[['year', 'artist', 'track', 'time', 'date', 'position']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "id": "bfce04f6-7789-4bb9-a829-7df4023bb563",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>year</th>\n",
       "      <th>artist</th>\n",
       "      <th>track</th>\n",
       "      <th>time</th>\n",
       "      <th>date</th>\n",
       "      <th>position</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2000</td>\n",
       "      <td>2 Pac</td>\n",
       "      <td>Baby Don't Cry (Keep...</td>\n",
       "      <td>4:22</td>\n",
       "      <td>2000-02-26</td>\n",
       "      <td>87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2000</td>\n",
       "      <td>2Ge+her</td>\n",
       "      <td>The Hardest Part Of ...</td>\n",
       "      <td>3:15</td>\n",
       "      <td>2000-09-02</td>\n",
       "      <td>91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2000</td>\n",
       "      <td>3 Doors Down</td>\n",
       "      <td>Kryptonite</td>\n",
       "      <td>3:53</td>\n",
       "      <td>2000-04-08</td>\n",
       "      <td>81</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2000</td>\n",
       "      <td>3 Doors Down</td>\n",
       "      <td>Loser</td>\n",
       "      <td>4:24</td>\n",
       "      <td>2000-10-21</td>\n",
       "      <td>76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2000</td>\n",
       "      <td>504 Boyz</td>\n",
       "      <td>Wobble Wobble</td>\n",
       "      <td>3:35</td>\n",
       "      <td>2000-04-15</td>\n",
       "      <td>57</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19716</th>\n",
       "      <td>2000</td>\n",
       "      <td>Creed</td>\n",
       "      <td>Higher</td>\n",
       "      <td>5:16</td>\n",
       "      <td>2000-11-18</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19833</th>\n",
       "      <td>2000</td>\n",
       "      <td>Lonestar</td>\n",
       "      <td>Amazed</td>\n",
       "      <td>4:25</td>\n",
       "      <td>2000-08-12</td>\n",
       "      <td>45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20033</th>\n",
       "      <td>2000</td>\n",
       "      <td>Creed</td>\n",
       "      <td>Higher</td>\n",
       "      <td>5:16</td>\n",
       "      <td>2000-11-25</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20150</th>\n",
       "      <td>2000</td>\n",
       "      <td>Lonestar</td>\n",
       "      <td>Amazed</td>\n",
       "      <td>4:25</td>\n",
       "      <td>2000-08-19</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20350</th>\n",
       "      <td>2000</td>\n",
       "      <td>Creed</td>\n",
       "      <td>Higher</td>\n",
       "      <td>5:16</td>\n",
       "      <td>2000-12-02</td>\n",
       "      <td>49</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5307 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       year        artist                    track  time       date  position\n",
       "0      2000         2 Pac  Baby Don't Cry (Keep...  4:22 2000-02-26        87\n",
       "1      2000       2Ge+her  The Hardest Part Of ...  3:15 2000-09-02        91\n",
       "2      2000  3 Doors Down               Kryptonite  3:53 2000-04-08        81\n",
       "3      2000  3 Doors Down                    Loser  4:24 2000-10-21        76\n",
       "4      2000      504 Boyz            Wobble Wobble  3:35 2000-04-15        57\n",
       "...     ...           ...                      ...   ...        ...       ...\n",
       "19716  2000         Creed                   Higher  5:16 2000-11-18        50\n",
       "19833  2000      Lonestar                   Amazed  4:25 2000-08-12        45\n",
       "20033  2000         Creed                   Higher  5:16 2000-11-25        50\n",
       "20150  2000      Lonestar                   Amazed  4:25 2000-08-19        50\n",
       "20350  2000         Creed                   Higher  5:16 2000-12-02        49\n",
       "\n",
       "[5307 rows x 6 columns]"
      ]
     },
     "execution_count": 71,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "billboard_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "id": "6b7590cc-a616-4499-a758-a98ab9ad508d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "track                    artist          \n",
       "(Hot S**t) Country G...  Nelly               34\n",
       "3 Little Words           Nu Flavor            9\n",
       "911                      Jean, Wyclef        19\n",
       "A Country Boy Can Su...  Brock, Chad          3\n",
       "A Little Gasoline        Clark, Terri         6\n",
       "                                             ..\n",
       "You Won't Be Lonely ...  Cyrus, Billy Ray    13\n",
       "You'll Always Be Lov...  Brooks & Dunn       19\n",
       "You're A God             Vertical Horizon    21\n",
       "Your Everything          Urban, Keith        16\n",
       "www.memory               Jackson, Alan       15\n",
       "Name: count, Length: 317, dtype: int64"
      ]
     },
     "execution_count": 72,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "billboard_data.groupby('track').artist.value_counts() # goup by 'track' and get count of artist sing "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "id": "52b2426a-a9f1-4aea-bf6a-369198717482",
   "metadata": {},
   "outputs": [],
   "source": [
    "billboard_data = billboard_data.reset_index() # reset index without delete old index"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "id": "4951f7c4-4e21-4597-b9c5-8c84dbd6d816",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>year</th>\n",
       "      <th>artist</th>\n",
       "      <th>track</th>\n",
       "      <th>time</th>\n",
       "      <th>date</th>\n",
       "      <th>position</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>2000</td>\n",
       "      <td>2 Pac</td>\n",
       "      <td>Baby Don't Cry (Keep...</td>\n",
       "      <td>4:22</td>\n",
       "      <td>2000-02-26</td>\n",
       "      <td>87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>2000</td>\n",
       "      <td>2Ge+her</td>\n",
       "      <td>The Hardest Part Of ...</td>\n",
       "      <td>3:15</td>\n",
       "      <td>2000-09-02</td>\n",
       "      <td>91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>2000</td>\n",
       "      <td>3 Doors Down</td>\n",
       "      <td>Kryptonite</td>\n",
       "      <td>3:53</td>\n",
       "      <td>2000-04-08</td>\n",
       "      <td>81</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>2000</td>\n",
       "      <td>3 Doors Down</td>\n",
       "      <td>Loser</td>\n",
       "      <td>4:24</td>\n",
       "      <td>2000-10-21</td>\n",
       "      <td>76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>2000</td>\n",
       "      <td>504 Boyz</td>\n",
       "      <td>Wobble Wobble</td>\n",
       "      <td>3:35</td>\n",
       "      <td>2000-04-15</td>\n",
       "      <td>57</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5302</th>\n",
       "      <td>19716</td>\n",
       "      <td>2000</td>\n",
       "      <td>Creed</td>\n",
       "      <td>Higher</td>\n",
       "      <td>5:16</td>\n",
       "      <td>2000-11-18</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5303</th>\n",
       "      <td>19833</td>\n",
       "      <td>2000</td>\n",
       "      <td>Lonestar</td>\n",
       "      <td>Amazed</td>\n",
       "      <td>4:25</td>\n",
       "      <td>2000-08-12</td>\n",
       "      <td>45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5304</th>\n",
       "      <td>20033</td>\n",
       "      <td>2000</td>\n",
       "      <td>Creed</td>\n",
       "      <td>Higher</td>\n",
       "      <td>5:16</td>\n",
       "      <td>2000-11-25</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5305</th>\n",
       "      <td>20150</td>\n",
       "      <td>2000</td>\n",
       "      <td>Lonestar</td>\n",
       "      <td>Amazed</td>\n",
       "      <td>4:25</td>\n",
       "      <td>2000-08-19</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5306</th>\n",
       "      <td>20350</td>\n",
       "      <td>2000</td>\n",
       "      <td>Creed</td>\n",
       "      <td>Higher</td>\n",
       "      <td>5:16</td>\n",
       "      <td>2000-12-02</td>\n",
       "      <td>49</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5307 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      index  year        artist                    track  time       date  \\\n",
       "0         0  2000         2 Pac  Baby Don't Cry (Keep...  4:22 2000-02-26   \n",
       "1         1  2000       2Ge+her  The Hardest Part Of ...  3:15 2000-09-02   \n",
       "2         2  2000  3 Doors Down               Kryptonite  3:53 2000-04-08   \n",
       "3         3  2000  3 Doors Down                    Loser  4:24 2000-10-21   \n",
       "4         4  2000      504 Boyz            Wobble Wobble  3:35 2000-04-15   \n",
       "...     ...   ...           ...                      ...   ...        ...   \n",
       "5302  19716  2000         Creed                   Higher  5:16 2000-11-18   \n",
       "5303  19833  2000      Lonestar                   Amazed  4:25 2000-08-12   \n",
       "5304  20033  2000         Creed                   Higher  5:16 2000-11-25   \n",
       "5305  20150  2000      Lonestar                   Amazed  4:25 2000-08-19   \n",
       "5306  20350  2000         Creed                   Higher  5:16 2000-12-02   \n",
       "\n",
       "      position  \n",
       "0           87  \n",
       "1           91  \n",
       "2           81  \n",
       "3           76  \n",
       "4           57  \n",
       "...        ...  \n",
       "5302        50  \n",
       "5303        45  \n",
       "5304        50  \n",
       "5305        50  \n",
       "5306        49  \n",
       "\n",
       "[5307 rows x 7 columns]"
      ]
     },
     "execution_count": 74,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "billboard_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "id": "47d6d260-ae72-46d5-ba2b-cbab68ef23f6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['Madonna', 'Aguilera, Christina', 'Sisqo', \"Destiny's Child\",\n",
       "       'Santana', 'Carey, Mariah', 'Janet', 'Iglesias, Enrique', \"N'Sync\",\n",
       "       'matchbox twenty', 'Aaliyah', 'Savage Garden', 'Vertical Horizon',\n",
       "       'Creed', 'Lonestar'], dtype=object)"
      ]
     },
     "execution_count": 75,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "billboard_data[billboard_data.position == 1].artist.unique() # filtersing and get unique values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "id": "33c4f421-96fd-4148-9456-6f3f80923f33",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "artist\n",
       "Destiny's Child        14\n",
       "Santana                10\n",
       "Aguilera, Christina     6\n",
       "Madonna                 4\n",
       "Savage Garden           4\n",
       "Janet                   3\n",
       "Iglesias, Enrique       3\n",
       "Sisqo                   2\n",
       "N'Sync                  2\n",
       "Lonestar                2\n",
       "Carey, Mariah           1\n",
       "matchbox twenty         1\n",
       "Aaliyah                 1\n",
       "Vertical Horizon        1\n",
       "Creed                   1\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 76,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "billboard_data[billboard_data.position == 1].artist.value_counts() # filtering and get counts of evryone unique value"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "id": "7bd914d4-504c-4d4e-9aac-081e31a8dd5f",
   "metadata": {},
   "outputs": [],
   "source": [
    "cleaning_weather_data = pd.read_csv('https://raw.githubusercontent.com/synesthesiam/blog/master/posts/data/weather_year.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "id": "a66e87c2-6a49-492a-9030-cddeceeb6662",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>EDT</th>\n",
       "      <th>Max TemperatureF</th>\n",
       "      <th>Mean TemperatureF</th>\n",
       "      <th>Min TemperatureF</th>\n",
       "      <th>Max Dew PointF</th>\n",
       "      <th>MeanDew PointF</th>\n",
       "      <th>Min DewpointF</th>\n",
       "      <th>Max Humidity</th>\n",
       "      <th>Mean Humidity</th>\n",
       "      <th>Min Humidity</th>\n",
       "      <th>...</th>\n",
       "      <th>Max VisibilityMiles</th>\n",
       "      <th>Mean VisibilityMiles</th>\n",
       "      <th>Min VisibilityMiles</th>\n",
       "      <th>Max Wind SpeedMPH</th>\n",
       "      <th>Mean Wind SpeedMPH</th>\n",
       "      <th>Max Gust SpeedMPH</th>\n",
       "      <th>PrecipitationIn</th>\n",
       "      <th>CloudCover</th>\n",
       "      <th>Events</th>\n",
       "      <th>WindDirDegrees</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2012-3-10</td>\n",
       "      <td>56</td>\n",
       "      <td>40</td>\n",
       "      <td>24</td>\n",
       "      <td>24</td>\n",
       "      <td>20</td>\n",
       "      <td>16</td>\n",
       "      <td>74</td>\n",
       "      <td>50</td>\n",
       "      <td>26</td>\n",
       "      <td>...</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>13</td>\n",
       "      <td>6</td>\n",
       "      <td>17.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>138</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2012-3-11</td>\n",
       "      <td>67</td>\n",
       "      <td>49</td>\n",
       "      <td>30</td>\n",
       "      <td>43</td>\n",
       "      <td>31</td>\n",
       "      <td>24</td>\n",
       "      <td>78</td>\n",
       "      <td>53</td>\n",
       "      <td>28</td>\n",
       "      <td>...</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>22</td>\n",
       "      <td>7</td>\n",
       "      <td>32.0</td>\n",
       "      <td>T</td>\n",
       "      <td>1</td>\n",
       "      <td>Rain</td>\n",
       "      <td>163</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2012-3-12</td>\n",
       "      <td>71</td>\n",
       "      <td>62</td>\n",
       "      <td>53</td>\n",
       "      <td>59</td>\n",
       "      <td>55</td>\n",
       "      <td>43</td>\n",
       "      <td>90</td>\n",
       "      <td>76</td>\n",
       "      <td>61</td>\n",
       "      <td>...</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>6</td>\n",
       "      <td>24</td>\n",
       "      <td>14</td>\n",
       "      <td>36.0</td>\n",
       "      <td>0.03</td>\n",
       "      <td>6</td>\n",
       "      <td>Rain</td>\n",
       "      <td>190</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2012-3-13</td>\n",
       "      <td>76</td>\n",
       "      <td>63</td>\n",
       "      <td>50</td>\n",
       "      <td>57</td>\n",
       "      <td>53</td>\n",
       "      <td>47</td>\n",
       "      <td>93</td>\n",
       "      <td>66</td>\n",
       "      <td>38</td>\n",
       "      <td>...</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>4</td>\n",
       "      <td>16</td>\n",
       "      <td>5</td>\n",
       "      <td>24.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>242</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2012-3-14</td>\n",
       "      <td>80</td>\n",
       "      <td>62</td>\n",
       "      <td>44</td>\n",
       "      <td>58</td>\n",
       "      <td>52</td>\n",
       "      <td>43</td>\n",
       "      <td>93</td>\n",
       "      <td>68</td>\n",
       "      <td>42</td>\n",
       "      <td>...</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>16</td>\n",
       "      <td>6</td>\n",
       "      <td>22.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>202</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>361</th>\n",
       "      <td>2013-3-6</td>\n",
       "      <td>32</td>\n",
       "      <td>31</td>\n",
       "      <td>29</td>\n",
       "      <td>27</td>\n",
       "      <td>26</td>\n",
       "      <td>25</td>\n",
       "      <td>92</td>\n",
       "      <td>85</td>\n",
       "      <td>78</td>\n",
       "      <td>...</td>\n",
       "      <td>10</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>22</td>\n",
       "      <td>9</td>\n",
       "      <td>33.0</td>\n",
       "      <td>0.04</td>\n",
       "      <td>8</td>\n",
       "      <td>Snow</td>\n",
       "      <td>314</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>362</th>\n",
       "      <td>2013-3-7</td>\n",
       "      <td>36</td>\n",
       "      <td>32</td>\n",
       "      <td>28</td>\n",
       "      <td>27</td>\n",
       "      <td>25</td>\n",
       "      <td>22</td>\n",
       "      <td>85</td>\n",
       "      <td>71</td>\n",
       "      <td>56</td>\n",
       "      <td>...</td>\n",
       "      <td>10</td>\n",
       "      <td>9</td>\n",
       "      <td>6</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>12.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>342</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>363</th>\n",
       "      <td>2013-3-8</td>\n",
       "      <td>47</td>\n",
       "      <td>35</td>\n",
       "      <td>23</td>\n",
       "      <td>27</td>\n",
       "      <td>24</td>\n",
       "      <td>21</td>\n",
       "      <td>88</td>\n",
       "      <td>65</td>\n",
       "      <td>42</td>\n",
       "      <td>...</td>\n",
       "      <td>10</td>\n",
       "      <td>9</td>\n",
       "      <td>5</td>\n",
       "      <td>12</td>\n",
       "      <td>3</td>\n",
       "      <td>14.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>364</th>\n",
       "      <td>2013-3-9</td>\n",
       "      <td>56</td>\n",
       "      <td>45</td>\n",
       "      <td>33</td>\n",
       "      <td>32</td>\n",
       "      <td>29</td>\n",
       "      <td>23</td>\n",
       "      <td>75</td>\n",
       "      <td>57</td>\n",
       "      <td>38</td>\n",
       "      <td>...</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>16</td>\n",
       "      <td>10</td>\n",
       "      <td>24.0</td>\n",
       "      <td>T</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>141</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>365</th>\n",
       "      <td>2013-3-10</td>\n",
       "      <td>60</td>\n",
       "      <td>52</td>\n",
       "      <td>50</td>\n",
       "      <td>37</td>\n",
       "      <td>34</td>\n",
       "      <td>32</td>\n",
       "      <td>54</td>\n",
       "      <td>48</td>\n",
       "      <td>42</td>\n",
       "      <td>...</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>14</td>\n",
       "      <td>8</td>\n",
       "      <td>26.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>167</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>366 rows × 23 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           EDT  Max TemperatureF  Mean TemperatureF  Min TemperatureF  \\\n",
       "0    2012-3-10                56                 40                24   \n",
       "1    2012-3-11                67                 49                30   \n",
       "2    2012-3-12                71                 62                53   \n",
       "3    2012-3-13                76                 63                50   \n",
       "4    2012-3-14                80                 62                44   \n",
       "..         ...               ...                ...               ...   \n",
       "361   2013-3-6                32                 31                29   \n",
       "362   2013-3-7                36                 32                28   \n",
       "363   2013-3-8                47                 35                23   \n",
       "364   2013-3-9                56                 45                33   \n",
       "365  2013-3-10                60                 52                50   \n",
       "\n",
       "     Max Dew PointF  MeanDew PointF  Min DewpointF  Max Humidity  \\\n",
       "0                24              20             16            74   \n",
       "1                43              31             24            78   \n",
       "2                59              55             43            90   \n",
       "3                57              53             47            93   \n",
       "4                58              52             43            93   \n",
       "..              ...             ...            ...           ...   \n",
       "361              27              26             25            92   \n",
       "362              27              25             22            85   \n",
       "363              27              24             21            88   \n",
       "364              32              29             23            75   \n",
       "365              37              34             32            54   \n",
       "\n",
       "      Mean Humidity   Min Humidity  ...   Max VisibilityMiles  \\\n",
       "0                50             26  ...                    10   \n",
       "1                53             28  ...                    10   \n",
       "2                76             61  ...                    10   \n",
       "3                66             38  ...                    10   \n",
       "4                68             42  ...                    10   \n",
       "..              ...            ...  ...                   ...   \n",
       "361              85             78  ...                    10   \n",
       "362              71             56  ...                    10   \n",
       "363              65             42  ...                    10   \n",
       "364              57             38  ...                    10   \n",
       "365              48             42  ...                    10   \n",
       "\n",
       "      Mean VisibilityMiles   Min VisibilityMiles   Max Wind SpeedMPH  \\\n",
       "0                       10                    10                  13   \n",
       "1                       10                    10                  22   \n",
       "2                       10                     6                  24   \n",
       "3                       10                     4                  16   \n",
       "4                       10                    10                  16   \n",
       "..                     ...                   ...                 ...   \n",
       "361                      5                     1                  22   \n",
       "362                      9                     6                   8   \n",
       "363                      9                     5                  12   \n",
       "364                     10                    10                  16   \n",
       "365                     10                    10                  14   \n",
       "\n",
       "      Mean Wind SpeedMPH   Max Gust SpeedMPH  PrecipitationIn   CloudCover  \\\n",
       "0                      6                17.0             0.00            0   \n",
       "1                      7                32.0                T            1   \n",
       "2                     14                36.0             0.03            6   \n",
       "3                      5                24.0             0.00            0   \n",
       "4                      6                22.0             0.00            0   \n",
       "..                   ...                 ...              ...          ...   \n",
       "361                    9                33.0             0.04            8   \n",
       "362                    2                12.0             0.00            8   \n",
       "363                    3                14.0             0.00            1   \n",
       "364                   10                24.0                T            2   \n",
       "365                    8                26.0             0.00            1   \n",
       "\n",
       "      Events  WindDirDegrees  \n",
       "0        NaN             138  \n",
       "1       Rain             163  \n",
       "2       Rain             190  \n",
       "3        NaN             242  \n",
       "4        NaN             202  \n",
       "..       ...             ...  \n",
       "361     Snow             314  \n",
       "362      NaN             342  \n",
       "363      NaN              90  \n",
       "364      NaN             141  \n",
       "365      NaN             167  \n",
       "\n",
       "[366 rows x 23 columns]"
      ]
     },
     "execution_count": 78,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cleaning_weather_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "id": "8a6550ab-1986-4212-b377-a83ba3227587",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['EDT', 'Max TemperatureF', 'Mean TemperatureF', 'Min TemperatureF',\n",
       "       'Max Dew PointF', 'MeanDew PointF', 'Min DewpointF', 'Max Humidity',\n",
       "       ' Mean Humidity', ' Min Humidity', ' Max Sea Level PressureIn',\n",
       "       ' Mean Sea Level PressureIn', ' Min Sea Level PressureIn',\n",
       "       ' Max VisibilityMiles', ' Mean VisibilityMiles', ' Min VisibilityMiles',\n",
       "       ' Max Wind SpeedMPH', ' Mean Wind SpeedMPH', ' Max Gust SpeedMPH',\n",
       "       'PrecipitationIn', ' CloudCover', ' Events', ' WindDirDegrees'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 79,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cleaning_weather_data.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "id": "967d948b-f79d-45f2-9d63-8372cee460d3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "EDT                            object\n",
       "Max TemperatureF                int64\n",
       "Mean TemperatureF               int64\n",
       "Min TemperatureF                int64\n",
       "Max Dew PointF                  int64\n",
       "MeanDew PointF                  int64\n",
       "Min DewpointF                   int64\n",
       "Max Humidity                    int64\n",
       " Mean Humidity                  int64\n",
       " Min Humidity                   int64\n",
       " Max Sea Level PressureIn     float64\n",
       " Mean Sea Level PressureIn    float64\n",
       " Min Sea Level PressureIn     float64\n",
       " Max VisibilityMiles            int64\n",
       " Mean VisibilityMiles           int64\n",
       " Min VisibilityMiles            int64\n",
       " Max Wind SpeedMPH              int64\n",
       " Mean Wind SpeedMPH             int64\n",
       " Max Gust SpeedMPH            float64\n",
       "PrecipitationIn                object\n",
       " CloudCover                     int64\n",
       " Events                        object\n",
       " WindDirDegrees                 int64\n",
       "dtype: object"
      ]
     },
     "execution_count": 80,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cleaning_weather_data.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "id": "7d91ca40-88ae-4c4f-a276-d7e73c628b4f",
   "metadata": {},
   "outputs": [],
   "source": [
    "cleaning_weather_data.columns = [\"date\", \"max_temp\", \"mean_temp\", \"min_temp\", \"max_dew\",\n",
    "    \"mean_dew\", \"min_dew\", \"max_humidity\", \"mean_humidity\",\n",
    "    \"min_humidity\", \"max_pressure\", \"mean_pressure\",\n",
    "    \"min_pressure\", \"max_visibility\", \"mean_visibility\",\n",
    "    \"min_visibility\", \"max_wind\", \"mean_wind\", \"max_gusts\",\n",
    "    \"precipitation\", \"cloud_cover\", \"events\", \"wind_dir\"\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 82,
   "id": "b83b962a-335d-4c6d-84c3-d26e51062776",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "date                object\n",
       "max_temp             int64\n",
       "mean_temp            int64\n",
       "min_temp             int64\n",
       "max_dew              int64\n",
       "mean_dew             int64\n",
       "min_dew              int64\n",
       "max_humidity         int64\n",
       "mean_humidity        int64\n",
       "min_humidity         int64\n",
       "max_pressure       float64\n",
       "mean_pressure      float64\n",
       "min_pressure       float64\n",
       "max_visibility       int64\n",
       "mean_visibility      int64\n",
       "min_visibility       int64\n",
       "max_wind             int64\n",
       "mean_wind            int64\n",
       "max_gusts          float64\n",
       "precipitation       object\n",
       "cloud_cover          int64\n",
       "events              object\n",
       "wind_dir             int64\n",
       "dtype: object"
      ]
     },
     "execution_count": 82,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cleaning_weather_data.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "id": "4989ecc7-2abc-4aab-a5d2-ea5258b3ff8c",
   "metadata": {},
   "outputs": [],
   "source": [
    "cleaning_weather_data.date = pd.to_datetime(cleaning_weather_data.date)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 84,
   "id": "b190a9c5-de09-4502-89ad-462c99470041",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['0.00', 'T', '0.03', '0.04', '0.14', '0.86', '0.06', '0.01',\n",
       "       '0.51', '0.69', '1.45', '0.38', '0.19', '0.15', '0.49', '0.29',\n",
       "       '0.09', '0.90', '0.02', '0.07', '0.13', '0.10', '0.36', '0.27',\n",
       "       '0.16', '0.26', '0.31', '0.05', '0.32', '1.85', '0.53', '2.00',\n",
       "       '0.92', '1.10', '0.17', '1.13', '0.63', '0.50', '0.71', '0.73',\n",
       "       '1.52', '0.47', '0.39', '0.18', '0.77', '0.08', '0.33', '0.44',\n",
       "       '0.48', '0.20', '0.12', '0.82', '1.16', '1.73', '0.40', '0.99',\n",
       "       '0.30', '1.17'], dtype=object)"
      ]
     },
     "execution_count": 84,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cleaning_weather_data.precipitation.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "id": "e95221c3-8b95-492f-ae02-cc5b0943aa0d",
   "metadata": {},
   "outputs": [],
   "source": [
    "cleaning_weather_data.loc[cleaning_weather_data.precipitation == 'T', 'precipitation'] = 1e-6 # At column precipitation replace T with 1e-6 to be all data in the column consistently, same type"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "id": "c14edecb-c7f0-494a-8b0d-771a072cc2ef",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['0.00', 1e-06, '0.03', '0.04', '0.14', '0.86', '0.06', '0.01',\n",
       "       '0.51', '0.69', '1.45', '0.38', '0.19', '0.15', '0.49', '0.29',\n",
       "       '0.09', '0.90', '0.02', '0.07', '0.13', '0.10', '0.36', '0.27',\n",
       "       '0.16', '0.26', '0.31', '0.05', '0.32', '1.85', '0.53', '2.00',\n",
       "       '0.92', '1.10', '0.17', '1.13', '0.63', '0.50', '0.71', '0.73',\n",
       "       '1.52', '0.47', '0.39', '0.18', '0.77', '0.08', '0.33', '0.44',\n",
       "       '0.48', '0.20', '0.12', '0.82', '1.16', '1.73', '0.40', '0.99',\n",
       "       '0.30', '1.17'], dtype=object)"
      ]
     },
     "execution_count": 86,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cleaning_weather_data.precipitation.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "id": "62ffa875-9ca8-4621-82d9-dd189da37242",
   "metadata": {},
   "outputs": [],
   "source": [
    "cleaning_weather_data.precipitation = cleaning_weather_data.precipitation.astype(float)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "id": "55d3fa6c-adae-4aa6-9c96-bedc1918d7ae",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([nan, 'Rain', 'Rain-Thunderstorm', 'Fog-Thunderstorm', 'Fog-Rain',\n",
       "       'Thunderstorm', 'Fog-Rain-Thunderstorm', 'Fog', 'Fog-Rain-Snow',\n",
       "       'Fog-Rain-Snow-Thunderstorm', 'Fog-Snow', 'Snow', 'Rain-Snow'],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 88,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cleaning_weather_data.events.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "id": "0b9767d9-fc5a-4e3d-9fad-5b3bfb905a0f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "events\n",
       "NaN                           204\n",
       "Rain                           69\n",
       "Rain-Thunderstorm              26\n",
       "Fog                            13\n",
       "Snow                           13\n",
       "Fog-Rain                       11\n",
       "Thunderstorm                    9\n",
       "Fog-Rain-Thunderstorm           8\n",
       "Fog-Snow                        5\n",
       "Fog-Rain-Snow                   3\n",
       "Rain-Snow                       3\n",
       "Fog-Thunderstorm                1\n",
       "Fog-Rain-Snow-Thunderstorm      1\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 89,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cleaning_weather_data.events.value_counts(dropna=False) # get count on everyone unique element plus NaN"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "id": "9c904822-8251-4c8b-a434-8549a598cb76",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<Axes: >"
      ]
     },
     "execution_count": 90,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "cleaning_weather_data.max_temp.hist() # hist in pandas"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 91,
   "id": "a6d3a4df-2982-475c-a8d9-7bdac98df005",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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EjNnztzn/v157idMmBB/+ctfYv78+TFv3rxYvHhxXHXVVan+CWlktMrWrVuziMjq6uqyLMuy7du3Z4cddlj26KOP5o555ZVXsojIli5dWqgxO72dO3dmJ5xwQjZ//vzs//7v/7LrrrsuyzLrUQg33nhjdtZZZ33o/ubm5qyioiL7/ve/n9u2ffv2rKSkJHv44YdTjHhIGTt2bPb1r3+9xbZLLrkkmzBhQpZl1iOliMjmzp2bu78/z/3LL7+cRUT2wgsv5I55+umns6Kiouytt95KNntb88pHK+3YsSMiInr37h0REStXrow9e/bEyJEjc8cMGjQoBg4cGEuXLi3IjIeCmpqaGDt2bIvnPcJ6FMLvf//7GDp0aHzpS1+Kfv36xemnnx4///nPc/vXr18f9fX1LdakrKwshg0bZk3awOc///lYsGBBvPrqqxER8ac//SmWLFkSY8aMiQjrUUj789wvXbo0evXqFUOHDs0dM3LkyOjSpUssX748+cxtpeBXte1ImpubY/LkyTFixIgYPHhwRETU19dHt27d9roYXnl5edTX1xdgys7vkUceiRdffDFeeOGFvfZZj/T+9re/xaxZs2LKlClx0003xQsvvBDf/OY3o1u3bjFx4sTc8/7Bbzi2Jm1j6tSp0dDQEIMGDYquXbvG+++/H3fddVdMmDAhIsJ6FND+PPf19fXRr1+/FvuLi4ujd+/enWp9xEcr1NTUxJo1a2LJkiWFHuWQtXHjxrjuuuti/vz50b1790KPQ/wnyocOHRrf+973IiLi9NNPjzVr1sQDDzwQEydOLPB0h57f/e538dBDD8WcOXPilFNOiVWrVsXkyZOjsrLSetBueNtlP02aNCnmzZsXzz33XAwYMCC3vaKiIt57773Yvn17i+O3bNkSFRUViafs/FauXBlbt26Nz3zmM1FcXBzFxcVRV1cX999/fxQXF0d5ebn1SKx///5x8sknt9h20kknxYYNGyIics/7B3/jyJq0jW9/+9sxderUuPTSS+PUU0+Nr33ta3H99ddHbW1tRFiPQtqf576ioiK2bt3aYv+///3vePvttzvV+oiPj5FlWUyaNCnmzp0bCxcujOrq6hb7zzjjjDjssMNiwYIFuW1r166NDRs2xPDhw1OP2+mdd9558ec//zlWrVqVuw0dOjQmTJiQ+7P1SGvEiBF7/fr5q6++Gsccc0xERFRXV0dFRUWLNWloaIjly5dbkzbwzjvvRJcuLf/X3rVr12hubo4I61FI+/PcDx8+PLZv3x4rV67MHbNw4cJobm6OYcOGJZ+5zRT6E6/t3TXXXJOVlZVlixYtyjZv3py7vfPOO7ljrr766mzgwIHZwoULsxUrVmTDhw/Phg8fXsCpDy3/+9suWWY9Unv++eez4uLi7K677spee+217KGHHsoOP/zw7De/+U3umBkzZmS9evXKnnjiiWz16tXZhRdemFVXV2fvvvtuASfvnCZOnJh94hOfyObNm5etX78+e+yxx7K+fftmN9xwQ+4Y69F2du7cmb300kvZSy+9lEVEdu+992YvvfRS9ve//z3Lsv177kePHp2dfvrp2fLly7MlS5ZkJ5xwQjZ+/PhC/ZPahPj4GBGxz9vs2bNzx7z77rvZN77xjeyoo47KDj/88Oziiy/ONm/eXLihDzEfjA/rkd6TTz6ZDR48OCspKckGDRqU/exnP2uxv7m5Obvllluy8vLyrKSkJDvvvPOytWvXFmjazq2hoSG77rrrsoEDB2bdu3fPjjvuuOw73/lO1tTUlDvGerSd5557bp8/MyZOnJhl2f4999u2bcvGjx+fHXnkkVlpaWl2+eWXZzt37izAv6btFGXZ/3ztHQBAG/OZDwAgKfEBACQlPgCApMQHAJCU+AAAkhIfAEBS4gMASEp8AABJiQ8AICnxAQAkJT4AgKTEBwCQ1P8Da0c0fLS6NJgAAAAASUVORK5CYII=",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.hist(cleaning_weather_data.max_temp, bins=25)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "id": "09ea2534-ce19-4b11-9619-acea0a58f866",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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4qipqYl77rkniouLo0+fPu5HYn379o2TTjqpyb4TTzwxNm3aFBGRe90/+RNH7knLuO6662L69Olx8cUXx+DBg+Nb3/pWXHvttVFdXR0R7kch7c9rX15eHu+8806T4//+97/jvffea1f3R3zsQ5ZlMWXKlHjsscdi8eLFUVlZ2eT4qaeeGocddlgsWrQot2/9+vWxadOmGDFiROpx272zzz47/vrXv8aaNWty27Bhw2LSpEm5/3Y/0ho5cuRuP37+6quvxjHHHBMREZWVlVFeXt7kntTV1cWKFSvckxbwwQcfRIcOTf/X3rFjx2hsbIwI96OQ9ue1HzFiRGzbti1Wr16dO2fx4sXR2NgYw4cPTz5ziyn0J15bu6uuuirr1q1b9txzz2VbtmzJbR988EHunCuvvDLr379/tnjx4mzVqlXZiBEjshEjRhRw6kPL//60S5a5H6m98MILWXFxcXbHHXdkr732WvbAAw9kXbt2zX7/+9/nzpk1a1bWvXv37IknnsjWrl2bnXfeeVllZWX24YcfFnDy9mny5MnZZz7zmWz+/PnZxo0bs0cffTTr1atXdv311+fOcT9azo4dO7KXXnope+mll7KIyO66667spZdeyv7xj39kWbZ/r/3YsWOzU045JVuxYkW2dOnS7Pjjj88mTpxYqC+pRYiPfYiIPW733Xdf7pwPP/ww+853vpMdeeSRWdeuXbMLLrgg27JlS+GGPsR8Mj7cj/SefPLJbNCgQVlJSUk2cODA7Je//GWT442NjdnNN9+c9enTJyspKcnOPvvsbP369QWatn2rq6vLrrnmmqx///5Z586ds2OPPTb7/ve/nzU0NOTOcT9azrPPPrvHfzMmT56cZdn+vfbvvvtuNnHixOyII47IysrKsksvvTTbsWNHAb6allOUZf/za+8AAFqYz3wAAEmJDwAgKfEBACQlPgCApMQHAJCU+AAAkhIfAEBS4gMASEp8AABJiQ8AICnxAQAkJT4AgKT+H3wDDiqK2m6uAAAAAElFTkSuQmCC",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.hist(cleaning_weather_data.max_temp, bins=25)\n",
    "plt.hist(cleaning_weather_data[cleaning_weather_data.date.dt.month == 6].max_temp, bins=25)\n",
    "plt.hist(cleaning_weather_data[cleaning_weather_data.date.dt.month == 12].max_temp, bins=25)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "id": "cd84a7d9-c783-4944-9184-80342c5f9506",
   "metadata": {},
   "outputs": [],
   "source": [
    "cleaning_weather_data = cleaning_weather_data.set_index('date') # Determened on new index - column 'date'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "id": "15867862-4820-4a66-8506-452391d961f0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<pandas.core.resample.DatetimeIndexResampler object at 0x000002063A682BD0>"
      ]
     },
     "execution_count": 94,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cleaning_weather_data.resample('w')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d99eff78-ee39-40a0-a100-06bef6d444c4",
   "metadata": {},
   "source": [
    "resample означава да вземем няколко дати и да вземема различни данни за тях, подобно на groupby"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "id": "2a5bef80-fa69-48c9-80a1-bc2836c67437",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "date\n",
       "2012-03-11    27.000000\n",
       "2012-03-18    51.714286\n",
       "2012-03-25    54.857143\n",
       "2012-04-01    46.714286\n",
       "2012-04-08    45.571429\n",
       "2012-04-15    39.714286\n",
       "2012-04-22    41.142857\n",
       "2012-04-29    41.428571\n",
       "2012-05-06    62.285714\n",
       "2012-05-13    50.857143\n",
       "2012-05-20    52.857143\n",
       "2012-05-27    58.714286\n",
       "2012-06-03    54.142857\n",
       "2012-06-10    51.142857\n",
       "2012-06-17    59.000000\n",
       "2012-06-24    62.428571\n",
       "2012-07-01    64.857143\n",
       "2012-07-08    69.285714\n",
       "2012-07-15    65.428571\n",
       "2012-07-22    68.000000\n",
       "2012-07-29    69.000000\n",
       "2012-08-05    64.142857\n",
       "2012-08-12    58.285714\n",
       "2012-08-19    55.142857\n",
       "2012-08-26    54.857143\n",
       "2012-09-02    64.857143\n",
       "2012-09-09    62.571429\n",
       "2012-09-16    51.000000\n",
       "2012-09-23    43.857143\n",
       "2012-09-30    50.857143\n",
       "2012-10-07    45.571429\n",
       "2012-10-14    37.142857\n",
       "2012-10-21    42.857143\n",
       "2012-10-28    48.571429\n",
       "2012-11-04    32.714286\n",
       "2012-11-11    33.714286\n",
       "2012-11-18    24.285714\n",
       "2012-11-25    29.857143\n",
       "2012-12-02    32.428571\n",
       "2012-12-09    42.142857\n",
       "2012-12-16    27.000000\n",
       "2012-12-23    26.000000\n",
       "2012-12-30    25.000000\n",
       "2013-01-06    13.857143\n",
       "2013-01-13    30.428571\n",
       "2013-01-20    24.285714\n",
       "2013-01-27    13.571429\n",
       "2013-02-03    23.142857\n",
       "2013-02-10    25.571429\n",
       "2013-02-17    24.714286\n",
       "2013-02-24    21.857143\n",
       "2013-03-03    28.571429\n",
       "2013-03-10    30.142857\n",
       "Freq: W-SUN, Name: min_temp, dtype: float64"
      ]
     },
     "execution_count": 95,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cleaning_weather_data.resample('w').min_temp.mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "id": "56d11113-1d58-4370-9f78-cfb23551aaf8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "date\n",
       "2012-03-10    35.666667\n",
       "2012-03-13    50.666667\n",
       "2012-03-16    52.333333\n",
       "2012-03-19    58.000000\n",
       "2012-03-22    52.666667\n",
       "                ...    \n",
       "2013-02-24    26.333333\n",
       "2013-02-27    31.666667\n",
       "2013-03-02    21.666667\n",
       "2013-03-05    28.666667\n",
       "2013-03-08    35.333333\n",
       "Freq: 3D, Name: min_temp, Length: 122, dtype: float64"
      ]
     },
     "execution_count": 96,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cleaning_weather_data.resample(pd.Timedelta(3, 'D')).min_temp.mean() # Give average min temp. for evry 3 days"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 97,
   "id": "54e5a318-1072-4e22-9fed-c2de71acfbdf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "date\n",
       "2012-03-10    24.000000\n",
       "2012-03-11    27.000000\n",
       "2012-03-12    35.666667\n",
       "2012-03-13    44.333333\n",
       "2012-03-14    49.000000\n",
       "                ...    \n",
       "2013-03-06    25.666667\n",
       "2013-03-07    28.666667\n",
       "2013-03-08    26.666667\n",
       "2013-03-09    28.000000\n",
       "2013-03-10    35.333333\n",
       "Name: min_temp, Length: 366, dtype: float64"
      ]
     },
     "execution_count": 97,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cleaning_weather_data.rolling(pd.Timedelta(3, 'D')).min_temp.mean() # Same as metod resample"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 98,
   "id": "17bd170e-2d35-4749-bf7f-ca34689ffdbe",
   "metadata": {},
   "outputs": [],
   "source": [
    "coffe_data = pd.read_csv('data/merged_data_cleaned.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 99,
   "id": "ba7651c2-5f9b-4f5f-b2d8-f36f19b1cb40",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>Species</th>\n",
       "      <th>Owner</th>\n",
       "      <th>Country.of.Origin</th>\n",
       "      <th>Farm.Name</th>\n",
       "      <th>Lot.Number</th>\n",
       "      <th>Mill</th>\n",
       "      <th>ICO.Number</th>\n",
       "      <th>Company</th>\n",
       "      <th>Altitude</th>\n",
       "      <th>...</th>\n",
       "      <th>Color</th>\n",
       "      <th>Category.Two.Defects</th>\n",
       "      <th>Expiration</th>\n",
       "      <th>Certification.Body</th>\n",
       "      <th>Certification.Address</th>\n",
       "      <th>Certification.Contact</th>\n",
       "      <th>unit_of_measurement</th>\n",
       "      <th>altitude_low_meters</th>\n",
       "      <th>altitude_high_meters</th>\n",
       "      <th>altitude_mean_meters</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>Arabica</td>\n",
       "      <td>metad plc</td>\n",
       "      <td>Ethiopia</td>\n",
       "      <td>metad plc</td>\n",
       "      <td>NaN</td>\n",
       "      <td>metad plc</td>\n",
       "      <td>2014/2015</td>\n",
       "      <td>metad agricultural developmet plc</td>\n",
       "      <td>1950-2200</td>\n",
       "      <td>...</td>\n",
       "      <td>Green</td>\n",
       "      <td>0</td>\n",
       "      <td>April 3rd, 2016</td>\n",
       "      <td>METAD Agricultural Development plc</td>\n",
       "      <td>309fcf77415a3661ae83e027f7e5f05dad786e44</td>\n",
       "      <td>19fef5a731de2db57d16da10287413f5f99bc2dd</td>\n",
       "      <td>m</td>\n",
       "      <td>1950.0</td>\n",
       "      <td>2200.0</td>\n",
       "      <td>2075.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>Arabica</td>\n",
       "      <td>metad plc</td>\n",
       "      <td>Ethiopia</td>\n",
       "      <td>metad plc</td>\n",
       "      <td>NaN</td>\n",
       "      <td>metad plc</td>\n",
       "      <td>2014/2015</td>\n",
       "      <td>metad agricultural developmet plc</td>\n",
       "      <td>1950-2200</td>\n",
       "      <td>...</td>\n",
       "      <td>Green</td>\n",
       "      <td>1</td>\n",
       "      <td>April 3rd, 2016</td>\n",
       "      <td>METAD Agricultural Development plc</td>\n",
       "      <td>309fcf77415a3661ae83e027f7e5f05dad786e44</td>\n",
       "      <td>19fef5a731de2db57d16da10287413f5f99bc2dd</td>\n",
       "      <td>m</td>\n",
       "      <td>1950.0</td>\n",
       "      <td>2200.0</td>\n",
       "      <td>2075.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>Arabica</td>\n",
       "      <td>grounds for health admin</td>\n",
       "      <td>Guatemala</td>\n",
       "      <td>san marcos barrancas \"san cristobal cuch</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1600 - 1800 m</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>May 31st, 2011</td>\n",
       "      <td>Specialty Coffee Association</td>\n",
       "      <td>36d0d00a3724338ba7937c52a378d085f2172daa</td>\n",
       "      <td>0878a7d4b9d35ddbf0fe2ce69a2062cceb45a660</td>\n",
       "      <td>m</td>\n",
       "      <td>1600.0</td>\n",
       "      <td>1800.0</td>\n",
       "      <td>1700.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>Arabica</td>\n",
       "      <td>yidnekachew dabessa</td>\n",
       "      <td>Ethiopia</td>\n",
       "      <td>yidnekachew dabessa coffee plantation</td>\n",
       "      <td>NaN</td>\n",
       "      <td>wolensu</td>\n",
       "      <td>NaN</td>\n",
       "      <td>yidnekachew debessa coffee plantation</td>\n",
       "      <td>1800-2200</td>\n",
       "      <td>...</td>\n",
       "      <td>Green</td>\n",
       "      <td>2</td>\n",
       "      <td>March 25th, 2016</td>\n",
       "      <td>METAD Agricultural Development plc</td>\n",
       "      <td>309fcf77415a3661ae83e027f7e5f05dad786e44</td>\n",
       "      <td>19fef5a731de2db57d16da10287413f5f99bc2dd</td>\n",
       "      <td>m</td>\n",
       "      <td>1800.0</td>\n",
       "      <td>2200.0</td>\n",
       "      <td>2000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>Arabica</td>\n",
       "      <td>metad plc</td>\n",
       "      <td>Ethiopia</td>\n",
       "      <td>metad plc</td>\n",
       "      <td>NaN</td>\n",
       "      <td>metad plc</td>\n",
       "      <td>2014/2015</td>\n",
       "      <td>metad agricultural developmet plc</td>\n",
       "      <td>1950-2200</td>\n",
       "      <td>...</td>\n",
       "      <td>Green</td>\n",
       "      <td>2</td>\n",
       "      <td>April 3rd, 2016</td>\n",
       "      <td>METAD Agricultural Development plc</td>\n",
       "      <td>309fcf77415a3661ae83e027f7e5f05dad786e44</td>\n",
       "      <td>19fef5a731de2db57d16da10287413f5f99bc2dd</td>\n",
       "      <td>m</td>\n",
       "      <td>1950.0</td>\n",
       "      <td>2200.0</td>\n",
       "      <td>2075.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1334</th>\n",
       "      <td>1334</td>\n",
       "      <td>Robusta</td>\n",
       "      <td>luis robles</td>\n",
       "      <td>Ecuador</td>\n",
       "      <td>robustasa</td>\n",
       "      <td>Lavado 1</td>\n",
       "      <td>our own lab</td>\n",
       "      <td>NaN</td>\n",
       "      <td>robustasa</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>Blue-Green</td>\n",
       "      <td>1</td>\n",
       "      <td>January 18th, 2017</td>\n",
       "      <td>Specialty Coffee Association</td>\n",
       "      <td>ff7c18ad303d4b603ac3f8cff7e611ffc735e720</td>\n",
       "      <td>352d0cf7f3e9be14dad7df644ad65efc27605ae2</td>\n",
       "      <td>m</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1335</th>\n",
       "      <td>1335</td>\n",
       "      <td>Robusta</td>\n",
       "      <td>luis robles</td>\n",
       "      <td>Ecuador</td>\n",
       "      <td>robustasa</td>\n",
       "      <td>Lavado 3</td>\n",
       "      <td>own laboratory</td>\n",
       "      <td>NaN</td>\n",
       "      <td>robustasa</td>\n",
       "      <td>40</td>\n",
       "      <td>...</td>\n",
       "      <td>Blue-Green</td>\n",
       "      <td>0</td>\n",
       "      <td>January 18th, 2017</td>\n",
       "      <td>Specialty Coffee Association</td>\n",
       "      <td>ff7c18ad303d4b603ac3f8cff7e611ffc735e720</td>\n",
       "      <td>352d0cf7f3e9be14dad7df644ad65efc27605ae2</td>\n",
       "      <td>m</td>\n",
       "      <td>40.0</td>\n",
       "      <td>40.0</td>\n",
       "      <td>40.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1336</th>\n",
       "      <td>1336</td>\n",
       "      <td>Robusta</td>\n",
       "      <td>james moore</td>\n",
       "      <td>United States</td>\n",
       "      <td>fazenda cazengo</td>\n",
       "      <td>NaN</td>\n",
       "      <td>cafe cazengo</td>\n",
       "      <td>NaN</td>\n",
       "      <td>global opportunity fund</td>\n",
       "      <td>795 meters</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6</td>\n",
       "      <td>December 23rd, 2015</td>\n",
       "      <td>Specialty Coffee Association</td>\n",
       "      <td>ff7c18ad303d4b603ac3f8cff7e611ffc735e720</td>\n",
       "      <td>352d0cf7f3e9be14dad7df644ad65efc27605ae2</td>\n",
       "      <td>m</td>\n",
       "      <td>795.0</td>\n",
       "      <td>795.0</td>\n",
       "      <td>795.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1337</th>\n",
       "      <td>1337</td>\n",
       "      <td>Robusta</td>\n",
       "      <td>cafe politico</td>\n",
       "      <td>India</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14-1118-2014-0087</td>\n",
       "      <td>cafe politico</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>Green</td>\n",
       "      <td>1</td>\n",
       "      <td>August 25th, 2015</td>\n",
       "      <td>Specialty Coffee Association</td>\n",
       "      <td>ff7c18ad303d4b603ac3f8cff7e611ffc735e720</td>\n",
       "      <td>352d0cf7f3e9be14dad7df644ad65efc27605ae2</td>\n",
       "      <td>m</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1338</th>\n",
       "      <td>1338</td>\n",
       "      <td>Robusta</td>\n",
       "      <td>cafe politico</td>\n",
       "      <td>Vietnam</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>cafe politico</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9</td>\n",
       "      <td>August 25th, 2015</td>\n",
       "      <td>Specialty Coffee Association</td>\n",
       "      <td>ff7c18ad303d4b603ac3f8cff7e611ffc735e720</td>\n",
       "      <td>352d0cf7f3e9be14dad7df644ad65efc27605ae2</td>\n",
       "      <td>m</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1339 rows × 44 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unnamed: 0  Species                     Owner Country.of.Origin  \\\n",
       "0              0  Arabica                 metad plc          Ethiopia   \n",
       "1              1  Arabica                 metad plc          Ethiopia   \n",
       "2              2  Arabica  grounds for health admin         Guatemala   \n",
       "3              3  Arabica       yidnekachew dabessa          Ethiopia   \n",
       "4              4  Arabica                 metad plc          Ethiopia   \n",
       "...          ...      ...                       ...               ...   \n",
       "1334        1334  Robusta               luis robles           Ecuador   \n",
       "1335        1335  Robusta               luis robles           Ecuador   \n",
       "1336        1336  Robusta               james moore     United States   \n",
       "1337        1337  Robusta             cafe politico             India   \n",
       "1338        1338  Robusta             cafe politico           Vietnam   \n",
       "\n",
       "                                     Farm.Name Lot.Number            Mill  \\\n",
       "0                                    metad plc        NaN       metad plc   \n",
       "1                                    metad plc        NaN       metad plc   \n",
       "2     san marcos barrancas \"san cristobal cuch        NaN             NaN   \n",
       "3        yidnekachew dabessa coffee plantation        NaN         wolensu   \n",
       "4                                    metad plc        NaN       metad plc   \n",
       "...                                        ...        ...             ...   \n",
       "1334                                 robustasa   Lavado 1     our own lab   \n",
       "1335                                 robustasa   Lavado 3  own laboratory   \n",
       "1336                           fazenda cazengo        NaN    cafe cazengo   \n",
       "1337                                       NaN        NaN             NaN   \n",
       "1338                                       NaN        NaN             NaN   \n",
       "\n",
       "             ICO.Number                                Company       Altitude  \\\n",
       "0             2014/2015      metad agricultural developmet plc      1950-2200   \n",
       "1             2014/2015      metad agricultural developmet plc      1950-2200   \n",
       "2                   NaN                                    NaN  1600 - 1800 m   \n",
       "3                   NaN  yidnekachew debessa coffee plantation      1800-2200   \n",
       "4             2014/2015      metad agricultural developmet plc      1950-2200   \n",
       "...                 ...                                    ...            ...   \n",
       "1334                NaN                              robustasa            NaN   \n",
       "1335                NaN                              robustasa             40   \n",
       "1336                NaN                global opportunity fund     795 meters   \n",
       "1337  14-1118-2014-0087                          cafe politico            NaN   \n",
       "1338                NaN                          cafe politico            NaN   \n",
       "\n",
       "      ...       Color Category.Two.Defects           Expiration  \\\n",
       "0     ...       Green                    0      April 3rd, 2016   \n",
       "1     ...       Green                    1      April 3rd, 2016   \n",
       "2     ...         NaN                    0       May 31st, 2011   \n",
       "3     ...       Green                    2     March 25th, 2016   \n",
       "4     ...       Green                    2      April 3rd, 2016   \n",
       "...   ...         ...                  ...                  ...   \n",
       "1334  ...  Blue-Green                    1   January 18th, 2017   \n",
       "1335  ...  Blue-Green                    0   January 18th, 2017   \n",
       "1336  ...         NaN                    6  December 23rd, 2015   \n",
       "1337  ...       Green                    1    August 25th, 2015   \n",
       "1338  ...         NaN                    9    August 25th, 2015   \n",
       "\n",
       "                      Certification.Body  \\\n",
       "0     METAD Agricultural Development plc   \n",
       "1     METAD Agricultural Development plc   \n",
       "2           Specialty Coffee Association   \n",
       "3     METAD Agricultural Development plc   \n",
       "4     METAD Agricultural Development plc   \n",
       "...                                  ...   \n",
       "1334        Specialty Coffee Association   \n",
       "1335        Specialty Coffee Association   \n",
       "1336        Specialty Coffee Association   \n",
       "1337        Specialty Coffee Association   \n",
       "1338        Specialty Coffee Association   \n",
       "\n",
       "                         Certification.Address  \\\n",
       "0     309fcf77415a3661ae83e027f7e5f05dad786e44   \n",
       "1     309fcf77415a3661ae83e027f7e5f05dad786e44   \n",
       "2     36d0d00a3724338ba7937c52a378d085f2172daa   \n",
       "3     309fcf77415a3661ae83e027f7e5f05dad786e44   \n",
       "4     309fcf77415a3661ae83e027f7e5f05dad786e44   \n",
       "...                                        ...   \n",
       "1334  ff7c18ad303d4b603ac3f8cff7e611ffc735e720   \n",
       "1335  ff7c18ad303d4b603ac3f8cff7e611ffc735e720   \n",
       "1336  ff7c18ad303d4b603ac3f8cff7e611ffc735e720   \n",
       "1337  ff7c18ad303d4b603ac3f8cff7e611ffc735e720   \n",
       "1338  ff7c18ad303d4b603ac3f8cff7e611ffc735e720   \n",
       "\n",
       "                         Certification.Contact unit_of_measurement  \\\n",
       "0     19fef5a731de2db57d16da10287413f5f99bc2dd                   m   \n",
       "1     19fef5a731de2db57d16da10287413f5f99bc2dd                   m   \n",
       "2     0878a7d4b9d35ddbf0fe2ce69a2062cceb45a660                   m   \n",
       "3     19fef5a731de2db57d16da10287413f5f99bc2dd                   m   \n",
       "4     19fef5a731de2db57d16da10287413f5f99bc2dd                   m   \n",
       "...                                        ...                 ...   \n",
       "1334  352d0cf7f3e9be14dad7df644ad65efc27605ae2                   m   \n",
       "1335  352d0cf7f3e9be14dad7df644ad65efc27605ae2                   m   \n",
       "1336  352d0cf7f3e9be14dad7df644ad65efc27605ae2                   m   \n",
       "1337  352d0cf7f3e9be14dad7df644ad65efc27605ae2                   m   \n",
       "1338  352d0cf7f3e9be14dad7df644ad65efc27605ae2                   m   \n",
       "\n",
       "     altitude_low_meters altitude_high_meters altitude_mean_meters  \n",
       "0                 1950.0               2200.0               2075.0  \n",
       "1                 1950.0               2200.0               2075.0  \n",
       "2                 1600.0               1800.0               1700.0  \n",
       "3                 1800.0               2200.0               2000.0  \n",
       "4                 1950.0               2200.0               2075.0  \n",
       "...                  ...                  ...                  ...  \n",
       "1334                 NaN                  NaN                  NaN  \n",
       "1335                40.0                 40.0                 40.0  \n",
       "1336               795.0                795.0                795.0  \n",
       "1337                 NaN                  NaN                  NaN  \n",
       "1338                 NaN                  NaN                  NaN  \n",
       "\n",
       "[1339 rows x 44 columns]"
      ]
     },
     "execution_count": 99,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "coffe_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "id": "f0d5ba65-3c1f-4ad2-a54c-9a76f1487c35",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Unnamed: 0', 'Species', 'Owner', 'Country.of.Origin', 'Farm.Name',\n",
       "       'Lot.Number', 'Mill', 'ICO.Number', 'Company', 'Altitude', 'Region',\n",
       "       'Producer', 'Number.of.Bags', 'Bag.Weight', 'In.Country.Partner',\n",
       "       'Harvest.Year', 'Grading.Date', 'Owner.1', 'Variety',\n",
       "       'Processing.Method', 'Aroma', 'Flavor', 'Aftertaste', 'Acidity', 'Body',\n",
       "       'Balance', 'Uniformity', 'Clean.Cup', 'Sweetness', 'Cupper.Points',\n",
       "       'Total.Cup.Points', 'Moisture', 'Category.One.Defects', 'Quakers',\n",
       "       'Color', 'Category.Two.Defects', 'Expiration', 'Certification.Body',\n",
       "       'Certification.Address', 'Certification.Contact', 'unit_of_measurement',\n",
       "       'altitude_low_meters', 'altitude_high_meters', 'altitude_mean_meters'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 100,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "coffe_data.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 101,
   "id": "7098ab6f-d287-4e25-aa92-6ce6fbcb142c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Unnamed: 0                 int64\n",
       "Species                   object\n",
       "Owner                     object\n",
       "Country.of.Origin         object\n",
       "Farm.Name                 object\n",
       "Lot.Number                object\n",
       "Mill                      object\n",
       "ICO.Number                object\n",
       "Company                   object\n",
       "Altitude                  object\n",
       "Region                    object\n",
       "Producer                  object\n",
       "Number.of.Bags             int64\n",
       "Bag.Weight                object\n",
       "In.Country.Partner        object\n",
       "Harvest.Year              object\n",
       "Grading.Date              object\n",
       "Owner.1                   object\n",
       "Variety                   object\n",
       "Processing.Method         object\n",
       "Aroma                    float64\n",
       "Flavor                   float64\n",
       "Aftertaste               float64\n",
       "Acidity                  float64\n",
       "Body                     float64\n",
       "Balance                  float64\n",
       "Uniformity               float64\n",
       "Clean.Cup                float64\n",
       "Sweetness                float64\n",
       "Cupper.Points            float64\n",
       "Total.Cup.Points         float64\n",
       "Moisture                 float64\n",
       "Category.One.Defects       int64\n",
       "Quakers                  float64\n",
       "Color                     object\n",
       "Category.Two.Defects       int64\n",
       "Expiration                object\n",
       "Certification.Body        object\n",
       "Certification.Address     object\n",
       "Certification.Contact     object\n",
       "unit_of_measurement       object\n",
       "altitude_low_meters      float64\n",
       "altitude_high_meters     float64\n",
       "altitude_mean_meters     float64\n",
       "dtype: object"
      ]
     },
     "execution_count": 101,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "coffe_data.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "id": "0a127ef4-623f-4cab-8307-3906f7f96bb9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['1950-2200', '1600 - 1800 m', '1800-2200', nan, '1570-1700',\n",
       "       '1795-1850', '1855-1955', 'meters above sea level: 1.872',\n",
       "       'meters above sea level: 1.943', '2000 ft',\n",
       "       'meters above sea level: 2.080', '1200-1800m', '1450',\n",
       "       '1700-2000m', 'meters above sea level: 2.019', '1300 msnm', '1320',\n",
       "       'meters above sea level: 2.112', '1250m', '1950', '1400', '1200',\n",
       "       '1300', '1750-1800', '1800', 'meters above sea level: 1.941',\n",
       "       '1.2', '1000 m', '1754', '900-1500m', '1520m-2200m', '1400-1900m',\n",
       "       '1500-2000 m', '1400ft', '1400-1900', '1800 msnm', '1600',\n",
       "       '1800-2000', '5000', '4650', '1700 mts', '1500 meters',\n",
       "       '1300~1400 m.s.l', '1680', '1900m', '5600-5760 metros', '1400 m',\n",
       "       '1700', '1770', 'above 1600 m', 'above 1200 m', '1550 msnm',\n",
       "       '1550', '1250-1400 meter', '1400 msm', '2.560 msnm', '2136 msnm',\n",
       "       '1900', '-1', '1580', '1100m', '1400 masl', '3500-5200 feet',\n",
       "       'de 1600 a 1950 msnm', '800 m', '1620m', '1200m', '350',\n",
       "       '1450 msnm', '1200 mts', '800-1050m', '1350', '170', '1150',\n",
       "       '1750', '1750m', '2000', '4300', '1700-1850m', '1500', '5000 ft.',\n",
       "       '4000 psn', '1600 a 1900 msnm', '1750 msnm', '1450 ~ 1700 m',\n",
       "       '1300m', 'above 1100m', '2000 m', 'mmm', 'test', '900', '442 msnm',\n",
       "       '1200m to 1350m', '900-1200m', '3600-6200 ft', '4400-4700 ft',\n",
       "       '1000', '2560', '3607', '4000 psnm', '1170', '1700m', '3664',\n",
       "       '1565', '3280', 'de 900 a 1100 msnm', '1850', '1545-1668 masl',\n",
       "       '1530', \"approx. 1'500 metres a.s.l.\", '894m - 1183m',\n",
       "       '1500-1700m', '442', '968', '1480', '1800m', '5440 - 5760 metros',\n",
       "       '1550 m', '1260', '1700 msnm', '1650', '890', '934', '950公尺',\n",
       "       '2527', '1', '480-570m', '1650-1703', '1200-1400',\n",
       "       '800 meters above sea level', '1218', '1.250 m', '4921ft', '750',\n",
       "       '2800 ft', '1500-1600', '700', '1300 mts', '1600 m.s.n.m',\n",
       "       '1600 msnm', '1250', '800++', '1550-1700m', '4451 metros',\n",
       "       '1800 - 2000', '1100', '1200-1600masl', '3702',\n",
       "       'de 1.600 a 1.950 msnm', '1799', '4000', '1400m',\n",
       "       '1600 on average', '1850 msnm', '1400 mts', '940', '4600 ft.',\n",
       "       '439', '1330', '1813', '1500 msnm', '900-1200mtr', '1227',\n",
       "       '1650 msnm', '1100-1300', '4200 feet', '1000 msnm', '1880', '2100',\n",
       "       '1261', '800公尺', '1483', '175', '1600-1800msnm', '1880 msnm',\n",
       "       '1800 m.s.n.m', '1901', '16.8', '1500msnm', '1400-1900 psn',\n",
       "       \"approx.1'500 metres a.s.l.\", '1653', '1450 msnn', '5000 pies',\n",
       "       '532', '1089', '1380', '1000m', '950m', '900m', '1850 m', '905',\n",
       "       '700-800m', '1300 m', 'de 1.600 a 1.950 msn', '1300-1400m', '894',\n",
       "       '872', '1473', '1645', '1300 a 1800 metros sobre el nivel del mar',\n",
       "       '4500 pies', '900-1100', '1600 - 1950 msnm', '1500-1750 msnm',\n",
       "       '4500', '1050 - 1850 msnm', '775', '1200 masl',\n",
       "       '1600 + meters above sea level', '1059', '1300 meters',\n",
       "       '11000 metros', '5440-5760 metros', '1248', '1040m', '1040',\n",
       "       '4000psn', '1200-2000m', '1200 m', '1800 mts',\n",
       "       '1400 meter above sea level', '518', '650', '1442 m', '1.65',\n",
       "       '1400 thru 1850', '1200公尺', '1296', '1400- 1900', '1240 m', '950',\n",
       "       '1800 meters (5900', '1050', '200 m', '1200-1300m dpl',\n",
       "       '1400-1500 m', '1317', '900-1050m', '1679', '2285', 'huanuco',\n",
       "       '1560', '1750 m.s.n.m', '1396', '982', '1268', '5500 metros',\n",
       "       '1450 m', '600 m', '5500-6000 psnm', '441', '1200 a 1400', '1180m',\n",
       "       '650 m', '1338', '533', '4563', '1500-1800', '1200-1600m', '1144',\n",
       "       '1200-1400 masl', '1500 - 1700', '1.3', '944', '1300- 1400',\n",
       "       '2500m', '600m', '1400 m.s.n.m.', '600-700 m', '1050m', '1020',\n",
       "       '1300 a 1800 mtrs. a nivel del mar', '1877', '1000-1500m', '981',\n",
       "       '690', '973', '4001', '1350-1500', '1400 msnm', '700m', '1556m',\n",
       "       '1550 meters', 'de 1.600 a 1950 msnm', '900-950m',\n",
       "       '1600-1800 msnm', '774', '150 m', '750 m', '190164', '800',\n",
       "       '850 m', '4500-6000 feet', '160-200m', '4000 ft', '1200 msm',\n",
       "       '1599m', '900 m', '400-1250m', '1.25', '1050 - 1850', '110公尺',\n",
       "       '1422', '1550 mts.', '1550 meter', '763', '1130', '680',\n",
       "       '1400 msn', '5000 f', '100/2000', '1450 mals', '990-1000m', '0',\n",
       "       '695', '1100 m.o.s.l.', '5600 feet', '1456', '1500 mts', '1642',\n",
       "       '758m', '1350 snn', '1525 m', '1100 m', '200', '3500 ft', '550公尺',\n",
       "       'between 700 and 1400 meters', '688 m', '300 m', '1186', '1210',\n",
       "       '100', '3825', '1100.00 mosl', '1450 masl', '1680m',\n",
       "       '~1000 meters', '1200-1500', '1.85', '4540 metros', '50', '280',\n",
       "       '1250 m', '3800', '4000 p.s.n.m.', '6100 metros', '600公尺', '1450m',\n",
       "       '995', '3000 ft', '4287', '900 m.s.n.m.', '700 m', '808',\n",
       "       '1100 - 1275 mts', '850公尺', '250 m', '3845', '1300 to 1500 meters',\n",
       "       '1901.64', '800-1200', '500-700m', '1022', '975', '1264',\n",
       "       '3500 - 5200 feet', '700m公尺', '850', '12oo', '800m', '1600 meters',\n",
       "       '4000 p.s.n.m', '1200 meters', '750-800 m', '900-1500 masl',\n",
       "       '3500', '1000+ meters', '1280', '1140', '640m-1400m',\n",
       "       '1000 meters', '~350m', '1488', '3170', '1212', '1200-1300',\n",
       "       \"3000'\", '750m', '3140', '900-1300', '1095', '1367', '1745', '40',\n",
       "       '795 meters'], dtype=object)"
      ]
     },
     "execution_count": 102,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "coffe_data.Altitude.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 103,
   "id": "f8511732-0869-4708-9d2f-1a3765f649a6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.hist(coffe_data.Flavor, bins=20)\n",
    "plt.xlim(0, 10)\n",
    "plt.xticks(range(11))\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 104,
   "id": "681b724b-5b49-4168-bd0e-35e0e74ba869",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Certification.Address\n",
       "36d0d00a3724338ba7937c52a378d085f2172daa    293\n",
       "59e396ad6e22a1c22b248f958e1da2bd8af85272    204\n",
       "e493c36c2d076bf273064f7ac23ad562af257a25    178\n",
       "b1f20fe3a819fd6b2ee0eb8fdc3da256604f1e53    155\n",
       "3297cfa4c538e3dd03f72cc4082c54f7999e1f9d     67\n",
       "b4660a57e9f8cc613ae5b8f02bfce8634c763ab4     60\n",
       "fc45352eee499d8470cf94c9827922fb745bf815     58\n",
       "073285c0d45e2f5539012d969937e529564fa6fe     48\n",
       "8e0b118f3cf3121ab27c5387deacdb7d4d2a60b1     42\n",
       "567f200bcc17a90070cb952647bf88141ad9c80c     36\n",
       "188fe373b511e21f614564bf86aa4774270d8e04     22\n",
       "ccba45b89d859740b749878be8c6d16fbdb96c2e     22\n",
       "ff7c18ad303d4b603ac3f8cff7e611ffc735e720     18\n",
       "a176532400aebdc345cf3d870f84ed3ecab6249e     18\n",
       "726e4891cf2c9a4848768bd34b668124d12c4224     16\n",
       "309fcf77415a3661ae83e027f7e5f05dad786e44     15\n",
       "683fa6014608fc10ff681b0435b0b2dbe6df988f     12\n",
       "3d4987e3b91399dbb3938b5bdf53893b6ef45be1     11\n",
       "99fa73db21b7acd9c9ceb9dd84e409d2077d55c4     10\n",
       "e36d0270932c3b657e96b7b0278dfd85dc0fe743     10\n",
       "3b8dfdd621590b424ff64e0b76df7d6a92e1c628      8\n",
       "fc561dd3c2eee024b032933e0a97b4aede0dc206      8\n",
       "1d4c7f93129f9fb1c8a5f0ce0e36cc1cf4c2f4d7      7\n",
       "3441698871fa609a44ce947e8944ee42eb4428b9      6\n",
       "047484d5700c44f033915e632e0c6013d985cd79      6\n",
       "280c299bf8f7e7bd526e0fc5e1d209b361120d7f      2\n",
       "d3ed2a8c1db69c87daef88f425dd0e8ef3216a39      2\n",
       "528ec9cf40c1bab91ce8fae8e80c50f46627d2c6      1\n",
       "d35c195333cbf1d7c6a0eba5e11d1765030cca85      1\n",
       "78a435a6973d56b40414c7ae75a8b43e443e6e27      1\n",
       "09e3c859cac41901d54f4bd36cce80d19c9272f5      1\n",
       "3e18a5ae6f5e2aabca37e025f94e1974558bf5f0      1\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 104,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "coffe_data['Certification.Address'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "id": "e578d0ec-9e37-43d7-9422-7f14fe7c3e3a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['metad plc', 'grounds for health admin', 'yidnekachew dabessa',\n",
       "       'ji-ae ahn', 'hugo valdivia', 'ethiopia commodity exchange',\n",
       "       'diamond enterprise plc', 'mohammed lalo',\n",
       "       'cqi q coffee sample representative', 'yunnan coffee exchange',\n",
       "       'essencecoffee', 'the coffee source inc.', 'roberto licona franco',\n",
       "       'nucoffee', 'kabum trading company', 'bismarck castro',\n",
       "       'lin, che-hao krude 林哲豪', 'nora zeas', 'specialty coffee-korea',\n",
       "       'francisco a mena', 'hider abamecha', 'daniel magu',\n",
       "       'kona pacific farmers cooperative', 'itdp international',\n",
       "       'jacques pereira carneiro', 'jungle estate',\n",
       "       'great lakes coffee uganda', 'lusso lab', 'afca',\n",
       "       'juan luis alvarado romero', 'kawacom uganda ltd',\n",
       "       'exportadora de cafe condor s.a', 'gonzalo hernandez',\n",
       "       'ibrahim hussien speciality coffee producer &export',\n",
       "       'seid damtew coffee planataion', 'dane loraas',\n",
       "       'colbran coffeelands, ltd.', 'atlantic specialty coffee',\n",
       "       'assefa belay coffee producer', 'kyagalanyi ltd',\n",
       "       'rashid moledina & co. (msa) ltd.', 'ibero kenya limited',\n",
       "       'compañia colombiana agroindustrial s.a',\n",
       "       'nomura trading co., ltd.', 'carcafe ltda ci', 'steven kil',\n",
       "       'eileen koyanagi', 'kyagalanyi coffee ltd', 'racafe & cia s.c.a',\n",
       "       'troy quimby', 'el equimite, cafetal biodinámico', 'simon mahinda',\n",
       "       'young kim', 'carl walker', 'taylor winch (t) ltd',\n",
       "       'artemio zapata tejeda', 'brian speckman', 'philip schluter',\n",
       "       '松澤宏樹 koju matsuzawa', 'lydiah mwangi', 'cadexsa',\n",
       "       'consejo salvadoreño del café', 'sanjava coffee', 'rodrigo soto',\n",
       "       'fabian calderon mora', 'eric thormaehlen', 'rob tuttle',\n",
       "       'cqi taiwan icp cqi台灣合作夥伴', 'dream together',\n",
       "       'organizaciones de productores de cafe colimense',\n",
       "       'benjamin schmerler', 'taylor winch (coffee) ltd.', 'max gurdian',\n",
       "       'ecom japan limited', 'federacion nacional de cafeteros',\n",
       "       'eric wu', 'maria imelda uscanga martinez', 'alfredo bojalil',\n",
       "       'daniel friedlander', 'alexandra katona-carroll',\n",
       "       'aulia arif syahri', 'kao ming lee',\n",
       "       'maria amalia guadalupe toriello elorza', 'raúl vargas',\n",
       "       'victor hugo melchor cordova', 'tembo coffee company ltd',\n",
       "       'jesus salazar velasco', 'manuel herrera juarez', 'wayner jimenez',\n",
       "       'cooperativa el gorrion r.l', 'cafebras', 'ceca, s.a.',\n",
       "       'asefa dukamo keroma', 'selian coffee estate',\n",
       "       'olam agro colombia', 'chris finch', 'itochu corporation',\n",
       "       'owen carver', 'pt.royal pacific indah international',\n",
       "       'andres martinez leon', 'amanda powers', 'ipanema coffees',\n",
       "       'doi tung development project', 'cafes tomari sa de cv',\n",
       "       'sarawut premjit', 'almacafe', 'oscar ortega carballo',\n",
       "       'yasmin cofffee plantation plc', 'garet alban',\n",
       "       'filemon mendoza campos', 'doi chaang coffee company',\n",
       "       'kennedy macharia', 'nile highland arabica coffee farmers',\n",
       "       'german negron', 'saul m. hernandez ramirez',\n",
       "       'comercial internacional exportadora, s.a.', 'rob stephen',\n",
       "       'juan luis ortega carballo', 'ekai international company ltd.',\n",
       "       'andreas kussmaul', 'bulamburi coffee farmers association',\n",
       "       'damari absalome', 'debesa agro industry plc', nan,\n",
       "       'miguel cortes moreno', 'gabriel bernardo rivas ross',\n",
       "       'felipe isaza', 'specialty coffee association of indonesia',\n",
       "       'bugisu cooperative union', 'bourbon specialty coffees',\n",
       "       'ngila estate ltd', 'j.andrade', 'itiah coffee llc',\n",
       "       'cafe de don balbino s.c. de r.l. de c.v.',\n",
       "       'productos y servicios chilindron s.a. de c.v.',\n",
       "       'calixto guillen vazquez', 'ernesto rodriguez luna',\n",
       "       'modesto landeros flores', 'andrea bernal', 'sunvirtue co., ltd.',\n",
       "       'tutunze kahawa ltd', 'cafe politico', 'mayra yessenia torres',\n",
       "       'balam hinyula', 'nestor mendez gomez',\n",
       "       'fernando mendoza aparicio',\n",
       "       'maria luisa del carmen rojas narvaez', 'ucfa',\n",
       "       'irene alves santos', 'star cafe ltd',\n",
       "       'rosa aurora falcon fernandez', 'santiago solis ayerdi',\n",
       "       'renee a. perrine', 'zarah zamora perez', 'andrew bowman',\n",
       "       'expocaccer coop dos cafeic do cerrado ltda',\n",
       "       'nyapea coffee farmers association', 'maria guadalupe gomez anzo',\n",
       "       'royal base corporation', 'veronica lopez castillejos',\n",
       "       'samuel muhirwa', 'joshua marsceau', 'coffeebythebag.com , inc',\n",
       "       'edwin agasso', 'armando luis pohlenz martinez', 'coffee export',\n",
       "       'sergio de la vequia bernardi', 'romulo bello flores',\n",
       "       'rachel peterson', 'josé luis rojas yeo', 'nitin coffee estate',\n",
       "       'adam kline', 'montegrande',\n",
       "       'grupo cafetalero los brujos spr de rl', 'george a. fernandez',\n",
       "       'gabriel barbara', 'andry simarmata', 'brent hall',\n",
       "       'guillermo rojas saldana', 'elsy reyes', 'shah plantations',\n",
       "       'amkeni gourmet coffee group', 'enrique mitre lopez',\n",
       "       'enrique eduardo lopez aguilar', 'brian beck',\n",
       "       'gladness obed pallangyo', 'dario cesar galeana sanchez',\n",
       "       'jose daniel cobilt castro', 'alvaro quiros perez',\n",
       "       'olivia hernandez virves', 'finca las nieves',\n",
       "       'pedro santos e silva', 'michael gavina', 'klem organics',\n",
       "       'jesus carlos cardenas valdivia', 'bencafe, s. a.',\n",
       "       'langiro farm group', 'ibero coffee trading co (t) ltd',\n",
       "       'salvador caro carrion', 'cafetalera internacional cafinter, s.a.',\n",
       "       'ngorogoro convenant estate', 'julio perez hernandez', 'didas',\n",
       "       'minwook ku', 'finca estate', 'beneficio santa rosa',\n",
       "       'jorge octavio escamilla prado', 'mcomafa co ltd',\n",
       "       'juan hermilio sampieri carcamo', 'u mg mg', 'viridiana',\n",
       "       'kurt kappeli', 'christina dusing',\n",
       "       'jorge francisco martinez hachity', 'sergio landa alarcon',\n",
       "       'diego manuel woolrich ramirez', 'dae ltd company',\n",
       "       'fredy gordillo reyes', 'virginia gordillo gordillo',\n",
       "       'jose luis munoz guerrero', 'mdh', 'acacia hills ltd',\n",
       "       'exportadora atlantic, s.a.', 'genius coffee',\n",
       "       'santa laura exportadora de cafe s.l.e.c. s.a.',\n",
       "       'myriam kaplan-pasternak', 'tomas edelmann blass',\n",
       "       'maria de la paz aguilar guillen', 'angel oscar medina rodriguez',\n",
       "       'victoria', 'hector gabriel barreda nader',\n",
       "       'shangrilla estate ltd', 'immaculata john', 'kerchanshe',\n",
       "       'gregorio sebba', 'rolando lacayo', 'wali ali',\n",
       "       'obed rendon ponce', 'gerardo hernandez valderrabano',\n",
       "       'balbino ramirez flores', 'mlimani ngarashi',\n",
       "       'alejandro garcia palacios', 'grupo santab s.a de c.v.',\n",
       "       'min hlaing', 'karatu estate',\n",
       "       'eduardo luis augusto velazquez solis',\n",
       "       'luis roberto fermoso beltran', 'jose manuel vergara cortes',\n",
       "       'u soe', 'burka coffee estate', 'janny marlith torres',\n",
       "       'case noyale ltd', 'shwe yin mar coffee',\n",
       "       'israel eduardo paz garcia', 'adam ciruli ye',\n",
       "       'delfina leon shine', 'kongoni estate', 'volcafe ltda. - brasil',\n",
       "       'bob mccauley', 'u htun htun', 'gloria antonieta escobar urrutia',\n",
       "       'honor dela fuente', 'pablo enrique martinez gama',\n",
       "       'marco virgilio ramirez teliz', 'brayan cunha souza',\n",
       "       'federico pacheco perez', 'ngu shwe li',\n",
       "       'semiramis casas velazquez', 'jesus carlos cadena valdivia',\n",
       "       'asociación aldea global jinotega', 'leonides de la cruz lopez',\n",
       "       'mario jose fernandez', 'adriana torres rico quevedo',\n",
       "       'rre kunene', 'eric jesus cordoba arroyo',\n",
       "       'julio cesar robles flores', 'masamichi hiroike',\n",
       "       'juana rodriguez gutierrez',\n",
       "       'cafes finos de exportacion s de r.l.',\n",
       "       'sustainable harvest coffee', 'gonzalo de aquino flores',\n",
       "       'juan avenamar rodriguez funez', 'octavio augusto diaz trejo',\n",
       "       'damaso martinez perez',\n",
       "       'productores de especialidad emiliano zapeata, spr.',\n",
       "       'juan garcia hernandez', 'rosario miguel hernandez',\n",
       "       'francisco ruiz nunez', 'pablo cervantes morelos        ',\n",
       "       'gustavo amieva gonzalez', 'samuel eli gurel', 'mao-heng chu',\n",
       "       'gustavo abarca solis', 'stephany escamilla femat',\n",
       "       'homero antonio de anda andrade', 'william ho',\n",
       "       'guillermo eduardo bobadilla muguira', 'ana gonzales',\n",
       "       'francisco hernandez lorenzo', 'martin jimenez casiano',\n",
       "       'grupo juvenil magtayani, ac', 'myrna roxana galvez gonzalez',\n",
       "       'eugene holman pew', 'jose armando norberto borzani lemini',\n",
       "       'ricardo aaron sampieri marini', 'juan carlos garcia lopez',\n",
       "       'ankole coffee producers coop', 'nishant gurjer', 'andrew hetzel',\n",
       "       'ugacof', 'katuka development trust ltd',\n",
       "       'kasozi coffee farmers association', 'nitubaasa ltd',\n",
       "       'mannya coffee project', 'luis robles', 'james moore'],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 105,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "coffe_data.Owner.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "id": "cd507cf0-fbaf-4cbe-86c8-a35018d35ebe",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0                      METAD PLC\n",
       "1                      METAD PLC\n",
       "2       GROUNDS FOR HEALTH ADMIN\n",
       "3            YIDNEKACHEW DABESSA\n",
       "4                      METAD PLC\n",
       "                  ...           \n",
       "1334                 LUIS ROBLES\n",
       "1335                 LUIS ROBLES\n",
       "1336                 JAMES MOORE\n",
       "1337               CAFE POLITICO\n",
       "1338               CAFE POLITICO\n",
       "Name: Owner, Length: 1339, dtype: object"
      ]
     },
     "execution_count": 106,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "coffe_data.Owner.str.upper()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 107,
   "id": "dd64b0e1-1963-4711-bed9-7bc48b828a37",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0                        guji-hambela\n",
       "1                        guji-hambela\n",
       "2                                 NaN\n",
       "3                              oromia\n",
       "4                        guji-hambela\n",
       "                    ...              \n",
       "1334                 san juan, playas\n",
       "1335                 san juan, playas\n",
       "1336    kwanza norte province, angola\n",
       "1337                              NaN\n",
       "1338                              NaN\n",
       "Name: Region, Length: 1339, dtype: object"
      ]
     },
     "execution_count": 107,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "coffe_data.Region"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "id": "58ae29bb-112a-4aea-9190-d69b1ca6d20c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>std</th>\n",
       "      <th>min</th>\n",
       "      <th>25%</th>\n",
       "      <th>50%</th>\n",
       "      <th>75%</th>\n",
       "      <th>max</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <td>1339.0</td>\n",
       "      <td>669.000000</td>\n",
       "      <td>386.680316</td>\n",
       "      <td>0.0</td>\n",
       "      <td>334.50</td>\n",
       "      <td>669.00</td>\n",
       "      <td>1003.50</td>\n",
       "      <td>1338.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Number.of.Bags</th>\n",
       "      <td>1339.0</td>\n",
       "      <td>154.182972</td>\n",
       "      <td>129.987162</td>\n",
       "      <td>0.0</td>\n",
       "      <td>14.00</td>\n",
       "      <td>175.00</td>\n",
       "      <td>275.00</td>\n",
       "      <td>1062.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Aroma</th>\n",
       "      <td>1339.0</td>\n",
       "      <td>7.566706</td>\n",
       "      <td>0.377560</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7.42</td>\n",
       "      <td>7.58</td>\n",
       "      <td>7.75</td>\n",
       "      <td>8.75</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Flavor</th>\n",
       "      <td>1339.0</td>\n",
       "      <td>7.520426</td>\n",
       "      <td>0.398442</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7.33</td>\n",
       "      <td>7.58</td>\n",
       "      <td>7.75</td>\n",
       "      <td>8.83</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Aftertaste</th>\n",
       "      <td>1339.0</td>\n",
       "      <td>7.401083</td>\n",
       "      <td>0.404463</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7.25</td>\n",
       "      <td>7.42</td>\n",
       "      <td>7.58</td>\n",
       "      <td>8.67</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Acidity</th>\n",
       "      <td>1339.0</td>\n",
       "      <td>7.535706</td>\n",
       "      <td>0.379827</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7.33</td>\n",
       "      <td>7.58</td>\n",
       "      <td>7.75</td>\n",
       "      <td>8.75</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Body</th>\n",
       "      <td>1339.0</td>\n",
       "      <td>7.517498</td>\n",
       "      <td>0.370064</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7.33</td>\n",
       "      <td>7.50</td>\n",
       "      <td>7.67</td>\n",
       "      <td>8.58</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Balance</th>\n",
       "      <td>1339.0</td>\n",
       "      <td>7.518013</td>\n",
       "      <td>0.408943</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7.33</td>\n",
       "      <td>7.50</td>\n",
       "      <td>7.75</td>\n",
       "      <td>8.75</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Uniformity</th>\n",
       "      <td>1339.0</td>\n",
       "      <td>9.834877</td>\n",
       "      <td>0.554591</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10.00</td>\n",
       "      <td>10.00</td>\n",
       "      <td>10.00</td>\n",
       "      <td>10.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Clean.Cup</th>\n",
       "      <td>1339.0</td>\n",
       "      <td>9.835108</td>\n",
       "      <td>0.763946</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10.00</td>\n",
       "      <td>10.00</td>\n",
       "      <td>10.00</td>\n",
       "      <td>10.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Sweetness</th>\n",
       "      <td>1339.0</td>\n",
       "      <td>9.856692</td>\n",
       "      <td>0.616102</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10.00</td>\n",
       "      <td>10.00</td>\n",
       "      <td>10.00</td>\n",
       "      <td>10.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Cupper.Points</th>\n",
       "      <td>1339.0</td>\n",
       "      <td>7.503376</td>\n",
       "      <td>0.473464</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7.25</td>\n",
       "      <td>7.50</td>\n",
       "      <td>7.75</td>\n",
       "      <td>10.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Total.Cup.Points</th>\n",
       "      <td>1339.0</td>\n",
       "      <td>82.089851</td>\n",
       "      <td>3.500575</td>\n",
       "      <td>0.0</td>\n",
       "      <td>81.08</td>\n",
       "      <td>82.50</td>\n",
       "      <td>83.67</td>\n",
       "      <td>90.58</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Moisture</th>\n",
       "      <td>1339.0</td>\n",
       "      <td>0.088379</td>\n",
       "      <td>0.048287</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.09</td>\n",
       "      <td>0.11</td>\n",
       "      <td>0.12</td>\n",
       "      <td>0.28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Category.One.Defects</th>\n",
       "      <td>1339.0</td>\n",
       "      <td>0.479462</td>\n",
       "      <td>2.549683</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>63.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Quakers</th>\n",
       "      <td>1338.0</td>\n",
       "      <td>0.173393</td>\n",
       "      <td>0.832121</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>11.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Category.Two.Defects</th>\n",
       "      <td>1339.0</td>\n",
       "      <td>3.556385</td>\n",
       "      <td>5.312541</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2.00</td>\n",
       "      <td>4.00</td>\n",
       "      <td>55.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>altitude_low_meters</th>\n",
       "      <td>1109.0</td>\n",
       "      <td>1750.713315</td>\n",
       "      <td>8669.440545</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1100.00</td>\n",
       "      <td>1310.64</td>\n",
       "      <td>1600.00</td>\n",
       "      <td>190164.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>altitude_high_meters</th>\n",
       "      <td>1109.0</td>\n",
       "      <td>1799.347775</td>\n",
       "      <td>8668.805771</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1100.00</td>\n",
       "      <td>1350.00</td>\n",
       "      <td>1650.00</td>\n",
       "      <td>190164.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>altitude_mean_meters</th>\n",
       "      <td>1109.0</td>\n",
       "      <td>1775.030545</td>\n",
       "      <td>8668.626080</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1100.00</td>\n",
       "      <td>1310.64</td>\n",
       "      <td>1600.00</td>\n",
       "      <td>190164.00</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                       count         mean          std  min      25%      50%  \\\n",
       "Unnamed: 0            1339.0   669.000000   386.680316  0.0   334.50   669.00   \n",
       "Number.of.Bags        1339.0   154.182972   129.987162  0.0    14.00   175.00   \n",
       "Aroma                 1339.0     7.566706     0.377560  0.0     7.42     7.58   \n",
       "Flavor                1339.0     7.520426     0.398442  0.0     7.33     7.58   \n",
       "Aftertaste            1339.0     7.401083     0.404463  0.0     7.25     7.42   \n",
       "Acidity               1339.0     7.535706     0.379827  0.0     7.33     7.58   \n",
       "Body                  1339.0     7.517498     0.370064  0.0     7.33     7.50   \n",
       "Balance               1339.0     7.518013     0.408943  0.0     7.33     7.50   \n",
       "Uniformity            1339.0     9.834877     0.554591  0.0    10.00    10.00   \n",
       "Clean.Cup             1339.0     9.835108     0.763946  0.0    10.00    10.00   \n",
       "Sweetness             1339.0     9.856692     0.616102  0.0    10.00    10.00   \n",
       "Cupper.Points         1339.0     7.503376     0.473464  0.0     7.25     7.50   \n",
       "Total.Cup.Points      1339.0    82.089851     3.500575  0.0    81.08    82.50   \n",
       "Moisture              1339.0     0.088379     0.048287  0.0     0.09     0.11   \n",
       "Category.One.Defects  1339.0     0.479462     2.549683  0.0     0.00     0.00   \n",
       "Quakers               1338.0     0.173393     0.832121  0.0     0.00     0.00   \n",
       "Category.Two.Defects  1339.0     3.556385     5.312541  0.0     0.00     2.00   \n",
       "altitude_low_meters   1109.0  1750.713315  8669.440545  1.0  1100.00  1310.64   \n",
       "altitude_high_meters  1109.0  1799.347775  8668.805771  1.0  1100.00  1350.00   \n",
       "altitude_mean_meters  1109.0  1775.030545  8668.626080  1.0  1100.00  1310.64   \n",
       "\n",
       "                          75%        max  \n",
       "Unnamed: 0            1003.50    1338.00  \n",
       "Number.of.Bags         275.00    1062.00  \n",
       "Aroma                    7.75       8.75  \n",
       "Flavor                   7.75       8.83  \n",
       "Aftertaste               7.58       8.67  \n",
       "Acidity                  7.75       8.75  \n",
       "Body                     7.67       8.58  \n",
       "Balance                  7.75       8.75  \n",
       "Uniformity              10.00      10.00  \n",
       "Clean.Cup               10.00      10.00  \n",
       "Sweetness               10.00      10.00  \n",
       "Cupper.Points            7.75      10.00  \n",
       "Total.Cup.Points        83.67      90.58  \n",
       "Moisture                 0.12       0.28  \n",
       "Category.One.Defects     0.00      63.00  \n",
       "Quakers                  0.00      11.00  \n",
       "Category.Two.Defects     4.00      55.00  \n",
       "altitude_low_meters   1600.00  190164.00  \n",
       "altitude_high_meters  1650.00  190164.00  \n",
       "altitude_mean_meters  1600.00  190164.00  "
      ]
     },
     "execution_count": 108,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "coffe_data.describe().T"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 109,
   "id": "e16bed70-3d86-4045-be06-4cf73388cf1b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       8.75\n",
       "1       8.58\n",
       "2       8.42\n",
       "3       8.42\n",
       "4       8.50\n",
       "        ... \n",
       "1334    7.58\n",
       "1335    7.75\n",
       "1336    7.42\n",
       "1337    7.17\n",
       "1338    6.83\n",
       "Name: Acidity, Length: 1339, dtype: float64"
      ]
     },
     "execution_count": 109,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "coffe_data.Acidity"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 110,
   "id": "87b24855-c72e-4b1f-ad1e-6549919f8d61",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       8.75\n",
       "1       8.58\n",
       "2       8.42\n",
       "3       8.42\n",
       "4       8.50\n",
       "        ... \n",
       "1334    7.58\n",
       "1335    7.75\n",
       "1336    7.42\n",
       "1337    7.17\n",
       "1338    6.83\n",
       "Name: Acidity, Length: 1339, dtype: float64"
      ]
     },
     "execution_count": 110,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# imputation - replace with cammon value\n",
    "coffe_data.Acidity.fillna(coffe_data.Acidity.mean()) # това променя разпределението на данните"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "id": "fdf56d4f-9c41-4a9e-9c25-b4f0349b8472",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>iso2</th>\n",
       "      <th>year</th>\n",
       "      <th>m04</th>\n",
       "      <th>m514</th>\n",
       "      <th>m014</th>\n",
       "      <th>m1524</th>\n",
       "      <th>m2534</th>\n",
       "      <th>m3544</th>\n",
       "      <th>m4554</th>\n",
       "      <th>m5564</th>\n",
       "      <th>...</th>\n",
       "      <th>f04</th>\n",
       "      <th>f514</th>\n",
       "      <th>f014</th>\n",
       "      <th>f1524</th>\n",
       "      <th>f2534</th>\n",
       "      <th>f3544</th>\n",
       "      <th>f4554</th>\n",
       "      <th>f5564</th>\n",
       "      <th>f65</th>\n",
       "      <th>fu</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AD</td>\n",
       "      <td>1989</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AD</td>\n",
       "      <td>1990</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AD</td>\n",
       "      <td>1991</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AD</td>\n",
       "      <td>1992</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AD</td>\n",
       "      <td>1993</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5764</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2004</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>187.0</td>\n",
       "      <td>833.0</td>\n",
       "      <td>2908.0</td>\n",
       "      <td>2298.0</td>\n",
       "      <td>1056.0</td>\n",
       "      <td>366.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>225.0</td>\n",
       "      <td>1140.0</td>\n",
       "      <td>2858.0</td>\n",
       "      <td>1565.0</td>\n",
       "      <td>622.0</td>\n",
       "      <td>214.0</td>\n",
       "      <td>111.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5765</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2005</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>210.0</td>\n",
       "      <td>837.0</td>\n",
       "      <td>2264.0</td>\n",
       "      <td>1855.0</td>\n",
       "      <td>762.0</td>\n",
       "      <td>295.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>269.0</td>\n",
       "      <td>1136.0</td>\n",
       "      <td>2242.0</td>\n",
       "      <td>1255.0</td>\n",
       "      <td>578.0</td>\n",
       "      <td>193.0</td>\n",
       "      <td>603.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5766</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2006</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>215.0</td>\n",
       "      <td>736.0</td>\n",
       "      <td>2391.0</td>\n",
       "      <td>1939.0</td>\n",
       "      <td>896.0</td>\n",
       "      <td>348.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>237.0</td>\n",
       "      <td>1020.0</td>\n",
       "      <td>2424.0</td>\n",
       "      <td>1355.0</td>\n",
       "      <td>632.0</td>\n",
       "      <td>230.0</td>\n",
       "      <td>96.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5767</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2007</td>\n",
       "      <td>6.0</td>\n",
       "      <td>132.0</td>\n",
       "      <td>138.0</td>\n",
       "      <td>500.0</td>\n",
       "      <td>3693.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>716.0</td>\n",
       "      <td>292.0</td>\n",
       "      <td>...</td>\n",
       "      <td>7.0</td>\n",
       "      <td>178.0</td>\n",
       "      <td>185.0</td>\n",
       "      <td>739.0</td>\n",
       "      <td>3311.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>553.0</td>\n",
       "      <td>213.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5768</th>\n",
       "      <td>ZW</td>\n",
       "      <td>2008</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>127.0</td>\n",
       "      <td>614.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3316.0</td>\n",
       "      <td>704.0</td>\n",
       "      <td>263.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>145.0</td>\n",
       "      <td>840.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2890.0</td>\n",
       "      <td>467.0</td>\n",
       "      <td>174.0</td>\n",
       "      <td>105.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5769 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     iso2  year  m04   m514   m014  m1524   m2534   m3544   m4554  m5564  ...  \\\n",
       "0      AD  1989  0.0    0.0    0.0    0.0     0.0     0.0     0.0    0.0  ...   \n",
       "1      AD  1990  0.0    0.0    0.0    0.0     0.0     0.0     0.0    0.0  ...   \n",
       "2      AD  1991  0.0    0.0    0.0    0.0     0.0     0.0     0.0    0.0  ...   \n",
       "3      AD  1992  0.0    0.0    0.0    0.0     0.0     0.0     0.0    0.0  ...   \n",
       "4      AD  1993  0.0    0.0    0.0    0.0     0.0     0.0     0.0    0.0  ...   \n",
       "...   ...   ...  ...    ...    ...    ...     ...     ...     ...    ...  ...   \n",
       "5764   ZW  2004  0.0    0.0  187.0  833.0  2908.0  2298.0  1056.0  366.0  ...   \n",
       "5765   ZW  2005  0.0    0.0  210.0  837.0  2264.0  1855.0   762.0  295.0  ...   \n",
       "5766   ZW  2006  0.0    0.0  215.0  736.0  2391.0  1939.0   896.0  348.0  ...   \n",
       "5767   ZW  2007  6.0  132.0  138.0  500.0  3693.0     0.0   716.0  292.0  ...   \n",
       "5768   ZW  2008  0.0    0.0  127.0  614.0     0.0  3316.0   704.0  263.0  ...   \n",
       "\n",
       "      f04   f514   f014   f1524   f2534   f3544  f4554  f5564    f65   fu  \n",
       "0     0.0    0.0    0.0     0.0     0.0     0.0    0.0    0.0    0.0  0.0  \n",
       "1     0.0    0.0    0.0     0.0     0.0     0.0    0.0    0.0    0.0  0.0  \n",
       "2     0.0    0.0    0.0     0.0     0.0     0.0    0.0    0.0    0.0  0.0  \n",
       "3     0.0    0.0    0.0     0.0     0.0     0.0    0.0    0.0    0.0  0.0  \n",
       "4     0.0    0.0    0.0     0.0     0.0     0.0    0.0    0.0    0.0  0.0  \n",
       "...   ...    ...    ...     ...     ...     ...    ...    ...    ...  ...  \n",
       "5764  0.0    0.0  225.0  1140.0  2858.0  1565.0  622.0  214.0  111.0  0.0  \n",
       "5765  0.0    0.0  269.0  1136.0  2242.0  1255.0  578.0  193.0  603.0  0.0  \n",
       "5766  0.0    0.0  237.0  1020.0  2424.0  1355.0  632.0  230.0   96.0  0.0  \n",
       "5767  7.0  178.0  185.0   739.0  3311.0     0.0  553.0  213.0   90.0  0.0  \n",
       "5768  0.0    0.0  145.0   840.0     0.0  2890.0  467.0  174.0  105.0  0.0  \n",
       "\n",
       "[5769 rows x 22 columns]"
      ]
     },
     "execution_count": 111,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb.fillna(0) # Sentinel - replace on NaN with gove value - it is rong"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 112,
   "id": "c2ad8223-1837-4c6c-90dd-57e99fe85c89",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0         (7.75, 8.75]\n",
       "1         (7.75, 8.75]\n",
       "2         (7.75, 8.75]\n",
       "3         (7.75, 8.75]\n",
       "4         (7.75, 8.75]\n",
       "             ...      \n",
       "1334      (7.75, 8.75]\n",
       "1335    (-0.001, 7.25]\n",
       "1336    (-0.001, 7.25]\n",
       "1337    (-0.001, 7.25]\n",
       "1338    (-0.001, 7.25]\n",
       "Name: Balance, Length: 1339, dtype: category\n",
       "Categories (5, interval[float64, right]): [(-0.001, 7.25] < (7.25, 7.5] < (7.5, 7.58] < (7.58, 7.75] < (7.75, 8.75]]"
      ]
     },
     "execution_count": 112,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.qcut(coffe_data.Balance, 5) # показва всяка една стойност в кой куантил попада"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "id": "b2bbafff-177a-4c07-9635-386307605a81",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.25    7.33\n",
       "0.50    7.50\n",
       "0.75    7.75\n",
       "Name: Balance, dtype: float64"
      ]
     },
     "execution_count": 113,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "coffe_data.Balance.quantile([0.25,0.50, 0.75]) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "id": "89d6c3a8-de01-42b3-9a74-bc7e3db92c40",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       2.205652\n",
       "1       2.205652\n",
       "2       2.205652\n",
       "3       1.789946\n",
       "4       1.985573\n",
       "          ...   \n",
       "1334    0.762909\n",
       "1335   -5.546034\n",
       "1336   -0.851007\n",
       "1337   -1.266712\n",
       "1338   -1.682418\n",
       "Name: Balance, Length: 1339, dtype: float64"
      ]
     },
     "execution_count": 114,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "(coffe_data.Balance - coffe_data.Balance.mean()) / coffe_data.Balance.std() # - z-score for everyone value"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 115,
   "id": "5dd75b42-d254-440d-bf5d-d996d6bcc488",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(array([1.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,\n",
       "        2.000e+00, 7.000e+01, 1.107e+03, 1.590e+02]),\n",
       " array([-18.38399993, -16.24433896, -14.10467799, -11.96501702,\n",
       "         -9.82535605,  -7.68569508,  -5.54603411,  -3.40637314,\n",
       "         -1.26671217,   0.8729488 ,   3.01260977]),\n",
       " <BarContainer object of 10 artists>)"
      ]
     },
     "execution_count": 115,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.hist((coffe_data.Balance - coffe_data.Balance.mean()) / coffe_data.Balance.std())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 116,
   "id": "e42fdede-cfd2-450b-a9fa-776c6b0c1156",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1310    0.00\n",
       "1335    5.25\n",
       "1308    6.08\n",
       "1303    6.17\n",
       "1304    6.17\n",
       "Name: Balance, dtype: float64"
      ]
     },
     "execution_count": 116,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "coffe_data.Balance.nsmallest(5) # Give the smalest "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 117,
   "id": "944b5a3e-95bd-4983-8fc0-a18c3100e910",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'whiskers': [<matplotlib.lines.Line2D at 0x2063a0e3890>,\n",
       "  <matplotlib.lines.Line2D at 0x2063a0e19d0>],\n",
       " 'caps': [<matplotlib.lines.Line2D at 0x2063a0daf90>,\n",
       "  <matplotlib.lines.Line2D at 0x2063a0d8d10>],\n",
       " 'boxes': [<matplotlib.lines.Line2D at 0x2063a0e5fd0>],\n",
       " 'medians': [<matplotlib.lines.Line2D at 0x2063a0d2a50>],\n",
       " 'fliers': [<matplotlib.lines.Line2D at 0x2063a0d0c90>],\n",
       " 'means': []}"
      ]
     },
     "execution_count": 117,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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+wHDn7AAKtbc3Jzk7U+WvPrqq5k3b14aGxszb968vPrqq30XdPbuB4x8ToUAFfut3/qtJMnPf/7zzJkzJ88//3ySZM+ePZkzZ05+/vOf99sPGPmsWAAV27NnT5Kku7s7L7zwQhYtWpQtW7Zk0aJFeeGFF9Ld3d1vP2Dks2IBVKypqSlJUl9fn87OzqxevTqrV6/ue76uri5dXV19+wEjnxULoGItLS1J3l6xmDZtWr/npk2blp6enn77ASOfsAAq9tprryV5+ztD9u3bl5tvvjk7duzIzTffnH379vV9dXrvfsDIJyyAip111llJkve+973p7u7O7bffnnPPPTe33357uru78973vrfffsDIJyyAQWtubk5XV1fuvvvufPazn83dd9+drq4uHzOFUUhYABXbt29fkuR73/tePvGJT+SSSy7JihUrcskll+QTn/hEvve97/XbDxj5hAVQsSlTpiRJVqxYkaeffjpz585NfX195s6dm61bt+a2227rtx8w8gkLoGKtra1pamrKk08+mZ/85Cdpa2tLS0tL2tra8uMf/zibNm1Kc3NzWltbqz0qMETcxwKoWG1tbe666678yZ/8SRoaGvq2P/30030/f/vb305tbW21RgSGmBULYFD++Z//eVDPAyNLTU/vHWyGSGdnZxoaGtLR0ZH6+vqhfGmgsDfeeCMTJ07MuHHj8tprr+Wf/umf8uyzz2b69Om57rrrMnny5Lz55ps5dOhQJkyYUO1xgUF4p+/fToUAFVu6dGmS5PLLL09LS0t2797d99w//MM/5I/+6I+ybt26LF26NPfcc0+VpgSGklMhQMV27tyZJFm3bl1aWlqyadOmdHV1ZdOmTWlpacl3vvOdfvsBI58VC6Bi06dP7/tz3bp1GTPm7X+r/M7v/E7WrVuXc889t+/UCDA6DHjF4sUXX8yiRYsyefLkTJgwIS0tLfnhD394ImYDTnJXXHFFkmT37t05cuRIv+eOHDmS559/vt9+wMg3oLB4/fXXM2/evJxyyin57ne/m23btuWuu+7KpEmTTtR8wEnsf//3f5O8HRF1dXX9voSsrq6uLzZ69wNGvgGdCrn99tvT2NiYr3/9633bfBcAjF69d9RsbW3Nxo0bc8cdd+SOO+7oe753uztvwugxoBWLf//3f89FF12UP/3TP81ZZ52VCy64IPfff/+vPebw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",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.boxplot(coffe_data.Balance)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 124,
   "id": "f9b748dc-56a0-4c0b-91b8-f84f72b8d99a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['iso2', 'year', 'gender', 'age_group', 'cases'], dtype='object')"
      ]
     },
     "execution_count": 124,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb_tidy_no_missing.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 128,
   "id": "a6346661-4d06-4746-a317-b5489fb7098d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(-90.49900000000001, 30166.0]    0.997468\n",
       "(30166.0, 60332.0]               0.001828\n",
       "(60332.0, 90498.0]               0.000703\n",
       "Name: proportion, dtype: float64"
      ]
     },
     "execution_count": 128,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb_tidy_no_missing['cases'].value_counts(bins=3, normalize=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 127,
   "id": "f40cfd58-2ee4-4920-8cd2-c71628e77bc4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "35552"
      ]
     },
     "execution_count": 127,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(tb_tidy_no_missing)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "id": "afb75b07-1216-46db-bc7c-233767163e8e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>std</th>\n",
       "      <th>min</th>\n",
       "      <th>25%</th>\n",
       "      <th>50%</th>\n",
       "      <th>75%</th>\n",
       "      <th>max</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>year</th>\n",
       "      <td>5769.0</td>\n",
       "      <td>1994.229329</td>\n",
       "      <td>8.423265</td>\n",
       "      <td>1980.0</td>\n",
       "      <td>1987.0</td>\n",
       "      <td>1994.0</td>\n",
       "      <td>2002.00</td>\n",
       "      <td>2008.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m04</th>\n",
       "      <td>392.0</td>\n",
       "      <td>8.806122</td>\n",
       "      <td>46.094789</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.00</td>\n",
       "      <td>655.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m514</th>\n",
       "      <td>401.0</td>\n",
       "      <td>28.975062</td>\n",
       "      <td>127.881505</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>8.00</td>\n",
       "      <td>1519.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m014</th>\n",
       "      <td>2381.0</td>\n",
       "      <td>79.438051</td>\n",
       "      <td>280.489536</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>36.00</td>\n",
       "      <td>4648.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m1524</th>\n",
       "      <td>2407.0</td>\n",
       "      <td>922.364769</td>\n",
       "      <td>4278.638975</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>92.0</td>\n",
       "      <td>511.50</td>\n",
       "      <td>77121.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m2534</th>\n",
       "      <td>2408.0</td>\n",
       "      <td>1301.894518</td>\n",
       "      <td>5253.398971</td>\n",
       "      <td>0.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>151.5</td>\n",
       "      <td>728.00</td>\n",
       "      <td>83850.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m3544</th>\n",
       "      <td>2415.0</td>\n",
       "      <td>1205.566046</td>\n",
       "      <td>5409.064589</td>\n",
       "      <td>0.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>134.0</td>\n",
       "      <td>591.50</td>\n",
       "      <td>90498.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m4554</th>\n",
       "      <td>2421.0</td>\n",
       "      <td>983.515489</td>\n",
       "      <td>4780.782748</td>\n",
       "      <td>0.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>98.0</td>\n",
       "      <td>434.00</td>\n",
       "      <td>78815.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m5564</th>\n",
       "      <td>2414.0</td>\n",
       "      <td>696.171914</td>\n",
       "      <td>3771.934518</td>\n",
       "      <td>0.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>62.0</td>\n",
       "      <td>273.75</td>\n",
       "      <td>57492.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>m65</th>\n",
       "      <td>2408.0</td>\n",
       "      <td>609.440615</td>\n",
       "      <td>3660.224592</td>\n",
       "      <td>0.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>53.0</td>\n",
       "      <td>227.25</td>\n",
       "      <td>70376.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mu</th>\n",
       "      <td>273.0</td>\n",
       "      <td>5.710623</td>\n",
       "      <td>85.713531</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1416.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f04</th>\n",
       "      <td>393.0</td>\n",
       "      <td>6.417303</td>\n",
       "      <td>39.630100</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.00</td>\n",
       "      <td>620.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f514</th>\n",
       "      <td>404.0</td>\n",
       "      <td>39.185644</td>\n",
       "      <td>170.491532</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>13.25</td>\n",
       "      <td>2062.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f014</th>\n",
       "      <td>2378.0</td>\n",
       "      <td>106.341043</td>\n",
       "      <td>435.889885</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>50.00</td>\n",
       "      <td>8319.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f1524</th>\n",
       "      <td>2394.0</td>\n",
       "      <td>758.737260</td>\n",
       "      <td>3153.018686</td>\n",
       "      <td>0.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>68.0</td>\n",
       "      <td>427.00</td>\n",
       "      <td>51485.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f2534</th>\n",
       "      <td>2400.0</td>\n",
       "      <td>856.087500</td>\n",
       "      <td>3295.220001</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>86.0</td>\n",
       "      <td>477.50</td>\n",
       "      <td>49887.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f3544</th>\n",
       "      <td>2398.0</td>\n",
       "      <td>586.597998</td>\n",
       "      <td>2293.956123</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>309.00</td>\n",
       "      <td>33664.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f4554</th>\n",
       "      <td>2401.0</td>\n",
       "      <td>400.376510</td>\n",
       "      <td>1589.955543</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>216.00</td>\n",
       "      <td>21486.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f5564</th>\n",
       "      <td>2394.0</td>\n",
       "      <td>276.178363</td>\n",
       "      <td>1191.728829</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>144.75</td>\n",
       "      <td>18203.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>f65</th>\n",
       "      <td>2396.0</td>\n",
       "      <td>255.307596</td>\n",
       "      <td>1138.763846</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>124.00</td>\n",
       "      <td>21339.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fu</th>\n",
       "      <td>272.0</td>\n",
       "      <td>2.540441</td>\n",
       "      <td>38.261653</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>631.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        count         mean          std     min     25%     50%      75%  \\\n",
       "year   5769.0  1994.229329     8.423265  1980.0  1987.0  1994.0  2002.00   \n",
       "m04     392.0     8.806122    46.094789     0.0     0.0     0.0     2.00   \n",
       "m514    401.0    28.975062   127.881505     0.0     0.0     1.0     8.00   \n",
       "m014   2381.0    79.438051   280.489536     0.0     0.0     6.0    36.00   \n",
       "m1524  2407.0   922.364769  4278.638975     0.0    10.0    92.0   511.50   \n",
       "m2534  2408.0  1301.894518  5253.398971     0.0    15.0   151.5   728.00   \n",
       "m3544  2415.0  1205.566046  5409.064589     0.0    16.0   134.0   591.50   \n",
       "m4554  2421.0   983.515489  4780.782748     0.0    13.0    98.0   434.00   \n",
       "m5564  2414.0   696.171914  3771.934518     0.0     9.0    62.0   273.75   \n",
       "m65    2408.0   609.440615  3660.224592     0.0     8.0    53.0   227.25   \n",
       "mu      273.0     5.710623    85.713531     0.0     0.0     0.0     0.00   \n",
       "f04     393.0     6.417303    39.630100     0.0     0.0     0.0     1.00   \n",
       "f514    404.0    39.185644   170.491532     0.0     0.0     2.0    13.25   \n",
       "f014   2378.0   106.341043   435.889885     0.0     1.0     7.0    50.00   \n",
       "f1524  2394.0   758.737260  3153.018686     0.0     8.0    68.0   427.00   \n",
       "f2534  2400.0   856.087500  3295.220001     0.0    10.0    86.0   477.50   \n",
       "f3544  2398.0   586.597998  2293.956123     0.0     7.0    59.0   309.00   \n",
       "f4554  2401.0   400.376510  1589.955543     0.0     5.0    38.0   216.00   \n",
       "f5564  2394.0   276.178363  1191.728829     0.0     4.0    25.0   144.75   \n",
       "f65    2396.0   255.307596  1138.763846     0.0     5.0    29.0   124.00   \n",
       "fu      272.0     2.540441    38.261653     0.0     0.0     0.0     0.00   \n",
       "\n",
       "           max  \n",
       "year    2008.0  \n",
       "m04      655.0  \n",
       "m514    1519.0  \n",
       "m014    4648.0  \n",
       "m1524  77121.0  \n",
       "m2534  83850.0  \n",
       "m3544  90498.0  \n",
       "m4554  78815.0  \n",
       "m5564  57492.0  \n",
       "m65    70376.0  \n",
       "mu      1416.0  \n",
       "f04      620.0  \n",
       "f514    2062.0  \n",
       "f014    8319.0  \n",
       "f1524  51485.0  \n",
       "f2534  49887.0  \n",
       "f3544  33664.0  \n",
       "f4554  21486.0  \n",
       "f5564  18203.0  \n",
       "f65    21339.0  \n",
       "fu       631.0  "
      ]
     },
     "execution_count": 136,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tb.describe().T"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "44596a9c-7580-48d9-bf0e-65034f0ef73d",
   "metadata": {},
   "outputs": [],
   "source": [
    "tb.groupby()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
